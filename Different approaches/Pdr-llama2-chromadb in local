{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "lb13JbjzL7YP",
    "outputId": "6a813f56-684a-43f5-9e16-fa6b56458061",
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overwriting requirements.txt\n"
     ]
    }
   ],
   "source": [
    "%%writefile requirements.txt\n",
    "chromadb\n",
    "langchain\n",
    "langchain_community\n",
    "sentence_transformers"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Required Modules"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from tqdm.autonotebook import tqdm, trange"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "id": "jops1cdtL7YT"
   },
   "outputs": [],
   "source": [
    "import os\n",
    "import chromadb\n",
    "from langchain.vectorstores import Chroma\n",
    "from langchain.embeddings import HuggingFaceBgeEmbeddings\n",
    "from langchain.document_transformers import (\n",
    "    EmbeddingsRedundantFilter,\n",
    "    EmbeddingsClusteringFilter,\n",
    ")\n",
    "# from langchain.retrievers.document_compressors import DocumentCompressorPipeline\n",
    "# from langchain.retrievers import ContextualCompressionRetriever\n",
    "from langchain.text_splitter import RecursiveCharacterTextSplitter\n",
    "from langchain.document_loaders import PyMuPDFLoader\n",
    "from langchain.docstore.document import Document"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "A5CZ3DfiL7YU"
   },
   "source": [
    "# Embedding Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 510,
     "referenced_widgets": [
      "7752a9776f084d9985ee839f43874ac3",
      "de488f0641c74917aea2e8dbfce0e4aa",
      "00ada49c8bdf49b4a10d229d704b0c1a",
      "d3c1bd1702ef44e88ffcf11de3aefd15",
      "fe9aa770584542f987bd36eecb1def2c",
      "dcf1af9f0fa249c9a3775b6bf7f930a4",
      "227bef90fd254f128b0811521279a593",
      "d7728a29e1e14b46ae8c59b8a68b70da",
      "7d5448a16e3645a287d62171a8dab989",
      "5009c62ed6464f1ba076fe99ec46295b",
      "014cc5d179f9403d8ac36d65bc2fb140",
      "2ad0061bbeae40c893f96f85560ebb64",
      "1a68ab062b8f4f139fb76e24f08177e9",
      "f6b4cb3308ae4ebabb6ddb71230661a6",
      "254d9cae597949698ae287b8337490af",
      "bd189b9febfa4916b16d1e9c94cc67a1",
      "43e18eb4342a4405a59f754fa85d1700",
      "88db495107ba466d9b7e1cf7e83b236f",
      "c6927b468d76409fb51ef492252dbd9c",
      "6c71efcf68284737a34f26fb00df8283",
      "15afcc4331b146d4a932342d59a285ae",
      "d0c803b79bc34adb946772dd6b47b420",
      "1df4e1ad96274adf993a8b190690f519",
      "a6927040841d45b0b4702637ee70a20f",
      "a605da6fad7445e19c777fe5c218e57e",
      "8d22f6fa3ccf4ae5b2a5fb3df0bf9f21",
      "402f06c28e9945c6bcae965c1846ab05",
      "ca922dbc53ab4c0ea47f682d2b7fdc2d",
      "279b76fb09b341489ee444398ea58a61",
      "1dc3c26d6bd94a41a6a9bfa71a894208",
      "0b529fcf05284b2681fb37356e30ca6d",
      "43868c9079644f32b53047053a10f0d0",
      "ab30df7a463c43959492410bada19c05",
      "20b4b453c75546a08b1518bec2b6a577",
      "6ccbfb3b9dae4afeaa57916aba388870",
      "307b6aaaf8ae44b2a3f572c610e21e5a",
      "078722cc22cf44d586f871d279ff9588",
      "da13547cd5854c4383beb943836dd601",
      "af5febe34bf84ddbae11d2ea996d1634",
      "e73dfda02f0049a7a8f91563e1b983af",
      "a79c6fd66e2e4d7da2c5e1f565fd2440",
      "6e37ab7f2b0a4af6bbec0ad1ff01b41c",
      "f3c0e1eae7994a86bbb775cfda814e7b",
      "74e3e2549a4c44139758556082a953f1",
      "85f24e4aba3e4820bb1cb1051a834ad8",
      "758ced432af4498ca1b13e333bc3a5dc",
      "915daf3c844747bba899b41d75fb73eb",
      "9a0fe2adb4194e67ba5bc56bb654be7f",
      "5aa7999471a64086a46cdd02cc1b412d",
      "6ea54d0c06434ab5901acc225a6ecaa0",
      "542e832887c8483984e88e29e0fe7f9c",
      "9e9f92092f554d62ac2065da57271dd2",
      "e83ad391c36940a282f28a863a22095d",
      "fbd1e7d7a7704cf6ad4a19d1614be49e",
      "9fcd8d526c7043e1a401ea5451ec9833",
      "0fe71eb9e33b4cd6b5c0d377fd579b1d",
      "ec3238d053b946198098ffafc382a3ef",
      "308a8805ca9e4f10ac2893561288e832",
      "ffad32554828400babdfb2127e3709fb",
      "6c498d78247245f7a1d7cf7595f8c727",
      "7b50dbce355544bc8d63d8ecb2363a23",
      "c74917033b26445eba3bf0856c059d5a",
      "a9723c7500e64df58b690ea1d32f0bc6",
      "1c432e6eb48d4ddf99c359dee5983560",
      "fffb656ead79424ca518dd682b0dbbd2",
      "fa4c5adff2db424098b0f55c1229a042",
      "1a5ae0ef33a44397a221316e751b1a0a",
      "1fe03de424ec41e4a3da120254a9b53e",
      "56379fddb71846cdbb6b4b174e7375b9",
      "df0224f221c849278a2522b6d17f762c",
      "40d3cd2b8dd24d4a896fe504d4ed9aed",
      "788d083b277e4a4e91357cc6fac0d9fc",
      "5c7ae5e6585845bab2439b45b8b87d37",
      "153950f99f394d76b367942b9114e1cf",
      "6531f377d88a4a0ab10e6277dbd043e1",
      "9a7aaa8bd38f4d51acaab1805286fbfa",
      "4461b686785d49bf92ab1d4afdf5fd7b",
      "152e642ea173418c90e70872b6081bbf",
      "2eac3df7fada46f1a3d5ec1916b2b7f5",
      "94f03508843f4c1ca08cd1477b96c2a1",
      "00e0b269f8ba449daafd58c38937e29a",
      "861aec7a70bb4c508236add9b49d133e",
      "50192445f89d46019ef0bc61a7079b8a",
      "e7e95f79446c4f5b996c3073d1efdbda",
      "eb6cfd3facfd44209d69980d23d7a6c8",
      "2ab7767324ce42c6b1ecc1f1e83a3528",
      "f32b9c84d1d64035a7eee3c23d1bc319",
      "d4cb78badf0e4b78b6402b6dbc4701c8",
      "3e74c193557046c89a9c7b1f59156054",
      "3d9d10c1046443a5b98081d979f1c849",
      "b4d345deaaa6428ab37019f0410e800e",
      "9dc6156cfc824e7c90761856b99548dd",
      "b6421a35ea3b41e28d2ca6fbee66ad42",
      "78c685a6b8114573ba492634f5467e73",
      "ff7226f4476a4938aafabae29ce4f72a",
      "9235cf74bfb3422aace1b3c265991730",
      "c898874e6e6d4a19b78b8e848057ea07",
      "44600030d879448f857b379c944b2a14",
      "7b3cd41bbb2b4e19997a0cf18c7f4a10",
      "5574dc268509418fb3207308beaace50",
      "c7aec15d5c914821b9f4308eeb313cb6",
      "defccabb0c36441f8b826af003ae3676",
      "8f5450a0e69743eeb1efd5fe14277974",
      "89140aadeacf4cba9b81e7ebf2bba116",
      "cfa7171fe22a4029a92543e166a0f3c7",
      "66f1c54dd16541c680fce5df737ae77f",
      "d1c9ae621a6c4925bee747be22accf05",
      "77408404052745e78dd0b48471fd1ade",
      "343c06d34b7140de9d2b128b7c76259f",
      "a3858bdc02f94ac8a82b0c20e5d04222",
      "94b021e7ca234cb3a909b3eb1876daf1",
      "d9cf4006710845dc8d423670ccba8aed",
      "166f47d3ba8349be829909cdd2d355ac",
      "1367b54de3624c4498b31d853b73f6d0",
      "9bfcd51f6e7f488b8f7730c10c761b8a",
      "4f371444b4d940d49c2f34ef2f360041",
      "2006254a1772435f97babc3087d79866",
      "aa175ec534be4aa7a75d6d19c1dd4d29",
      "e825598360cb40308c737dd64f37f514",
      "dcbe5a60847041ac9683e35d0cd86cac",
      "4e07079174bc4cab9829f68eb21eebe4"
     ]
    },
    "id": "Nq-kyjxtL7YV",
    "outputId": "ebfddf15-0995-4e66-c181-0e6f77f0b38b"
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\VISHAL MAURYA\\Desktop\\Document Comparision\\pdr_venv\\Lib\\site-packages\\huggingface_hub\\file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Embedding Model Loaded in 89.81707167625427 seconds\n"
     ]
    }
   ],
   "source": [
    "import time\n",
    "s = time.time()\n",
    "model_name = \"BAAI/bge-large-en\"\n",
    "model_kwargs = {'device': 'cpu'}\n",
    "encode_kwargs = {'normalize_embeddings': False}\n",
    "hf = HuggingFaceBgeEmbeddings(\n",
    "    model_name=model_name,\n",
    "    model_kwargs=model_kwargs,\n",
    "    encode_kwargs=encode_kwargs\n",
    ")\n",
    "print(\"Embedding Model Loaded in\", time.time() - s, \"seconds\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "5DnjTWyUL7YW"
   },
   "source": [
    "## Data Pre-processing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# pdf_paths = [\"data/GB 25991-2010 Automotive Headlamps with LED Light Sources andor LED Modules (1) (2).pdf\"]\n",
    "pdf_paths = [\"Chinese Documents/GB 4785-2019 Lighting installation -EN.pdf\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "def pdf_paths_to_documents(pdf_paths):\n",
    "    documents = []\n",
    "    for path in pdf_paths:\n",
    "        loader = PyMuPDFLoader(path)\n",
    "        list_of_documents = loader.load()\n",
    "        combined_text = \"\\n\".join(document.page_content for document in list_of_documents)\n",
    "        document = Document(page_content=combined_text, metadata={\"source\": path})\n",
    "        documents.append(document)\n",
    "    return documents"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "documents = pdf_paths_to_documents(pdf_paths)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Document(page_content=\" \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n1 \\nFor Reference Purposes Only \\nICS 43.040.20 \\nT 38 \\n \\n \\nNational Standard of the People’s Republic of China \\n \\nGB 4785-2019 \\nReplace GB 4785-2007 \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\nProvisions for installation of the \\nexternal lighting and light-signalling \\ndevices for motor vehicles and their \\ntrailers \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nPublishing date: 2019-12-17    \\n \\n \\n \\n \\n Implementation date: 2020-07-01 \\n \\nPromulgated by \\nState Administration for Market Regulation \\nAnd \\nStandardization Administration of the People's Republic of China \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n2 \\nFor Reference Purposes Only \\nForeword \\nAll technical content of this Standard are mandatory. \\nThis Standard is drafted in according with the rules given in the GB/T 1.1-2009. \\nThis Standard replaces GB 4785-2007 “Prescription for installation of the external lighting and \\nlight-signalling devices for motor vehicles and their trailers”, mainly differs in the following as \\ncompared to GB 4785-2007: \\n-- \\nRemoving the geometric visibility graphs for various lamps (see Figure 1, 2, 5 to Figure 18 \\nof 2007 edition); \\n-- \\nRemoving the chapter of “Test method” (see Chapter 5 of 2007 edition); \\n-- \\nRemoving the relevant definition for “equivalent lamp” (see 3.5.1 of 2007 edition); \\n-- \\nIn considerations of development in light sources, supplementing and enhancing the light \\nsources as well as the related definitions and requirements (see 3.7); \\n-- \\nAdding the related definition and provisions for “interdependent lamp system” (see \\n3.9.26); \\n-- \\nAdding the definitions for manoeuvring lamp, corning lamp, conspicuity marking, rear-end \\ncollision alert signal (RECAS) and AFS (adaptive front lighting system) and its related \\ncontents, as well as the provisions (see 3. 9.29, 5.25, 3. 9.24, 5.20, 3. 9.15, 5.21, 3. 9.30, \\n5.26, 3. 9.25 and 5.22); \\n-- \\nDefinitions of light emitting surface, illuminating surface, apparent surface and etc differ in \\nrespects mentioned in GB 4785-2007 and adding relevant graphs (see 3.10, 3.11, 3.12 \\nand Annex B); \\n-- \\nAdding the requirement that vehicles equipped with daytime running lamps shall also be \\nequipped with automatic activation and deactivation function of dipped-beam headlamps; \\nor at least rear position lamps are opened when the daytime running lamps are opened; \\nor take appropriate measures to remind the driver that when the daytime running lamps \\nare opened, rear position lamps and other indicator lamps are not opened (see 5.2.7.6); \\n-- \\nAdding the related road test provisions and test methods for the front lighting system (see \\n5.1.9.3.3 and 5.22.9.2.4); \\n-- \\nAdding the conditions for activating lamps that are not specified in this Standard under \\nstates such as that the vehicle is stationary (see 4.31). \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n3 \\nFor Reference Purposes Only \\nThis Standard corresponds to ECE R48 “Uniform Provisions concerning the Approval of \\nVehicles with Regard to the Installation of Lighting and Light-signalling devices” (06 Series and \\nits 1st-6th supplements). \\nThe Standard was proposed and prepared by Ministry of Industry and Information Technology \\nof the People's Republic of China. \\nDrafting entities of this Standard: Shanghai Motor Vehicle Inspection and Certification & Tech \\nInnovation Center Co., Ltd., China Automotive Technology and Research Center, Changchun \\nAutomotive Test Center, Xiangyang Da An Automotive Test Center, Shanghai Koito Lamp Co., \\nLtd., Hella (Shanghai) Management Co., Ltd., SAIC Volkswagen Co., Ltd. and Pan Asia \\nTechnical Automotive Center Co., Ltd.. \\nThis Standard was mainly drafted by: Bu Weili, Zhao Bin, He Yuntang, Jiang Zhaoqing, Wu \\nHuatang, Wang Yingxin, Yang Zhiwen, Zheng Zhijun, Wu Wenfang and Zhang Shu. \\nThe previous editions replaced by this Standard are as follows: \\n-- \\nGB 4785-1984, GB 4785-1998 and GB 4785-2007. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n4 \\nFor Reference Purposes Only \\nProvisions for the installation of the external lighting and light-signalling \\ndevices for motor vehicles and their trailers  \\n1 \\nScope \\nThis Standard specifies the general requirements, special provisions and \\ninspection rules for external lighting and light-signalling devices for motor \\nvehicles and their trailers. \\nThis Standard is applicable to Categories M, N and O vehicles and trailers. \\n2 \\nNormative Reference \\nThe following documents contain provisions which, through reference in this text, \\nconstitute requirements of this Standard. For dated reference documents, only \\nthe dated edition applies to this document. However, parties to agreements \\nbased on this Standard are encouraged to investigate the possibility of applying \\nthe latest editions of the documents indicated below. For undated reference \\ndocuments, the latest edition (including all amendments) applies to this \\ndocument. \\nGB/T 3977 \\nSpecification of colors \\nGB 4094 \\nMotor vehicles -- Symbols for controls, indicators and tell-tales \\nGB 4599 \\nPhotometric characteristics of headlamps for motor vehicles \\nGB 4660 \\nMotor vehicle front fog lamps equipped with filament lamps \\nGB 5920 \\nPhotometric characteristics of front and rear position lamps \\nend-outline marker lamps and stop lamps for motor vehicles and \\ntheir trailers \\nGB 11554 \\nPhotometric characteristics of rear fog lamp for power-driven \\nvehicles and their trailers \\nGB 11564 \\nRetro reflector for motor vehicles \\nGB 12676 \\nTechnical requirements and testing methods for commercial \\nvehicle and trailer braking systems \\nGB 15235 \\nPhotometric characteristics of reversing lamps for power-driven \\nvehicles \\nGB 15766.1 Lamps for road vehicles -- Dimensional, electrical and luminous \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n5 \\nFor Reference Purposes Only \\nrequirements \\nGB 17509 \\nPhotometric characteristics of direction indicators for motor \\nvehicles and their trailers \\nGB 18099 \\nPhotometric characteristics of side-marker lamps for motor \\nvehicles and their trailers \\nGB 18408 \\nPhotometric characteristics of devices for the illumination of rear \\nregistration plates of motor vehicles and their trailers \\nGB 18409 \\nPhotometric characteristics of parking lamps for power-driven \\nvehicles \\nGB 21259 \\nHeadlamps equipped with gas-discharge light sources for motor \\nvehicle \\nGB/T 21260 Headlamp cleaner \\nGB 21670 \\nTechnical requirements and testing methods for passenger car \\nbraking systems \\nGB 23254 \\nRetro-reflective markings for trucks and trailers \\nGB 23255 \\nPhotometric characteristics of daytime running lamps for motor \\nvehicles \\nGB 25990 \\nRear-marking plates for vehicles and their trailers \\nGB 25991 \\nAutomotive headlamps with LED light sources and/or LED \\nmodules \\nGB/T 30036-2013 Adaptive front-lighting system for motor vehicles \\nGB/T 30511 Photometric characteristics of cornering lamps for motor vehicle \\nECE R37 \\nUniform provisions concerning the approval of filament lamps for \\nuse in approved lamp units on power-driven vehicles and of their \\ntrailers \\n3 \\nTerms and Definitions \\nThe following terms and definitions apply throughout this Standard. \\n3.1 \\nType test \\nThe type test performed to a vehicle type with regard to the quantity and means \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n6 \\nFor Reference Purposes Only \\nof installation of the external lighting and light-signalling devices. \\n3.2 \\nVehicle type with regard to the installation of lighting and light-signalling \\ndevices \\n \\nThe vehicles which do not differ in the following contents are deemed to fall \\nwithin one vehicle type. \\n-- \\nThe external shape and the dimensions of the vehicle; \\n-- \\nThe number and positioning of the devices mounted; \\n-- \\nHeadlamp levelling device; \\n-- \\nThe suspension system. \\n \\nThe following situations are also considered to fall within one vehicle type: \\nVehicles which differ as to above mentioned, but not in such a way as to entail a \\nchange in the kind, number, positioning and geometric visibility of the lamps \\ninstalled on vehicle, and the inclination of the dipped-beam, and whether \\noptional lamps are fitted or not. \\n3.3 \\nTransverse plane \\nA vertical plane orthogonal to the median longitudinal plane of the vehicle. \\n3.4 \\nUnladen vehicle \\nA vehicle without driver, crew, passengers and load, but with a full supply of fuel, \\nspare wheel and the tools normally carried. \\n3.5 \\nLaden vehicle \\nA vehicle loaded to its technically permissible maximum mass, as stated by the \\nmanufacturer. The loading mass is distributed between the axles. \\nNote: all states of loading are shown in Annex A. \\n3.6 \\nLighting and light-signalling device \\nThe element, an assembly of elements or installation element used to perform \\none or more functions. \\n3.6.1 \\nLighting function \\nIlluminate the road and objects in the direction of vehicle movement. \\n3.6.2 \\nLight-signalling function \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n7 \\nFor Reference Purposes Only \\nEmit or reflect light signals to other road users, so as to indicate the presence or \\nthe change of movement of the vehicle. \\n3.7 \\nLight source \\n“Light source” means one or more elements for visible radiation, which may be \\nassembled with one or more envelopes and with a base for mechanical and \\nelectrical connection. \\n3.7.1 \\nReplaceable light source \\nA light source which may be inserted in and removed from the holder of its \\ndevice without tool. \\n3.7.2 \\nNon-replaceable light source \\nA light source fixed in the light source module or lighting unit, which can only be \\nreplaced by replacement of the light source module or lighting unit. \\n3.7.3 \\nLight source module \\nAn optical part of a device which is specific to that device. It contains one or \\nmore non-replaceable light sources and it may optionally contain holder(s) in \\ncompliance with the requirements for replaceable light sources. \\n3.7.4 \\nFilament light source (filament lamp) \\nA light source where the filaments produce light and heat. \\n3.7.5 \\nGas-discharge light source \\nA light source where the light is produced via arc discharge. \\n3.7.6 \\nLight-emitting diode (LED) \\nA solid state light source made out of semiconductor materials. \\n3.7.7 \\nLED module \\nA light source module containing as light sources only LEDs. However it may \\noptionally contain holder(s) in compliance with the requirements for replaceable \\nlight sources. \\n3.7.8 \\nObjective luminous flux \\nThe value of the luminous flux of a light source, not including any tolerances. \\nNote 1: the light source standards, e.g., GB 15766.1, ECE R37, ECE R99 and \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n8 \\nFor Reference Purposes Only \\nECE R128.  \\nNote 2: For an LED module (does not meet the requirements of ECE R128), the \\nvalue of the objective luminous flux is indicated in the technical specification for \\nthe LED module. \\n3.8 \\nElectronic light source control gear \\nOne or more components between supply and light source to control voltage \\nand/or electrical current of the light source. \\n3.8.1 \\nBallast \\nAn electronic light source control gear between supply and light source (allowed \\nto be with the light source or applied lamp) to stabilize the electrical current of a \\ngas-discharge light source. \\n3.8.2 \\nIgnitor \\nAn electronic light source control gear to start the arc of a gas-discharge light \\nsource. \\n3.8.3 \\nVariable intensity control \\nA device which automatically controls light-signalling devices producing variable \\nluminous intensities so that it emits luminous intensities featuring stable \\nidentification.  \\nNote:The variable intensity control is part of the lamp, or part of the vehicle, or \\nsplit between the said lamp and the vehicle. \\n3.9 \\nLamp \\nA device designed to illuminate the road or to emit a light signal to other road \\nusers.  \\nNote: Rear registration plate lamps and retro-reflectors are likewise to be \\nregarded as lamps. \\n3.9.1 \\nIndependent lamps \\nIn the direction of the reference axis, devices having separate apparent surfaces, \\nseparate light sources and separate lamp bodies. \\nNote: apparent surface in this definition is replaced by light emitting surface for \\nthe rear registration plate and the direction-indicators of Categories 5 and 6. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n9 \\nFor Reference Purposes Only \\n3.9.2 \\nGrouped lamps \\nIn the direction of the reference axis, devices having separate apparent surfaces  \\nand separate light sources, but a common lamp body. \\nNote: apparent surface in this definition is replaced by light emitting surface for \\nthe rear registration plate and the direction-indicators of Categories 5 and 6. \\n3.9.3 \\nCombined lamps \\nIn the direction of the reference axis, devices having separate apparent surfaces, \\nbut a common light source and a common lamp body. \\nNote: apparent surface in this definition is replaced by light emitting surface for \\nthe rear registration plate and the direction-indicators of Categories 5 and 6. \\n3.9.4 \\nReciprocally incorporated lamps \\nIn the direction of the reference axis, devices having separate light sources or a \\nsingle light source operating under different conditions (for example, optical, \\nmechanical, electrical differences), totally or partially common apparent surfaces  \\nand a common lamp body. \\nNote: apparent surface in this definition is replaced by light emitting surface for \\nthe rear registration plate and the direction-indicators of Categories 5 and 6. \\n3.9.5 \\nSingle-function lamp \\nMeans the related part of a device which performs a single lighting or \\nlight-signalling function. \\n3.9.6 \\nConcealable lamp \\nA lamp capable of being partly or completely hidden when not in use, which may \\nbe achieved by means of a movable cover, by displacement of the lamp or by \\nany other suitable means. \\n3.9.7 \\nDriving-beam (main-beam) headlamp \\nThe lamp used to illuminate the road over a long distance ahead of the vehicle. \\n3.9.8 \\nPassing-beam (dipped-beam) headlamp \\nThe lamp used to illuminate the road ahead of the vehicle without causing \\nundue dazzle or discomfort to oncoming drivers and other road-users. \\n3.9.8.1 \\nPrincipal passing-beam (principal dipped-beam) \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n10 \\nFor Reference Purposes Only \\nThe dipped-beam produced without the contribution of infrared (IR) emitter \\nand/or additional light sources for bend lighting. \\n3.9.9 \\nDirection-indicator lamp \\nThe lamp used to indicate to other road-users that the driver intends to change \\ndirection to the right or to the left.  \\nNote:Direction-indicator lamp also can be used as part of the vehicle warning \\nsystem. \\n3.9.10 \\nStop lamp \\nA lamp used to indicate to other road users to the rear of the vehicle that the \\nmovement of the vehicle is intentionally retarded. \\n3.9.11 \\nRear-registration plate illuminating device \\nThe device used to illuminate the space area reserved for the rear registration \\nplate; such a device may consist of several optical components. \\n3.9.12 \\nFront position lamp \\nThe lamp used to indicate the presence and the width of the vehicle when \\nviewed from the front. \\n3.9.13 \\nRear position lamp \\nThe lamp used to indicate the presence and the width of the vehicle when \\nviewed from the rear. \\n3.9.14 \\nRetro-reflector \\nA device used to indicate the presence of a vehicle by the reflection of light \\nemanating from an external light source, the observer being situated near the \\nsource. \\n3.9.15 \\nConspicuity marking \\nThe assembly of reflective materials installed or adhered onto the surface of \\nvehicle body for enhancing the identifiability of the vehicle, which device could \\nincrease the conspicuity of a vehicle, when viewed from the side or rear of the \\nvehicle (or in the case of trailers, additionally from the front). \\n3.9.16 \\nHazard warning signal \\nThe simultaneous operation of all of a vehicle’s direction-indicator lamps to \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n11 \\nFor Reference Purposes Only \\nshow that the vehicle temporarily constitutes a special danger to other \\nroad-users. \\n3.9.17 \\nFront fog lamp \\nA lamp used to improve the illumination of the forward direction road of vehicle \\nin case of fog or similar low-visibility circumstances. \\n3.9.18 \\nRear fog lamp \\nA lamp used to make the vehicle more easily visible from the rear in fog or \\nsimilar low-visibility circumstances. \\n3.9.19 \\nReversing lamp \\nThe lamp used to illuminate the road to the rear of the vehicle and to warn other \\nroad-users that the vehicle is reversing or about to reverse. \\n3.9.20 \\nParking lamp \\nA lamp which is switched on as vehicle at parking status, used to draw attention \\nto the presence of a stationary vehicle in a certain area. \\n3.9.21 \\nEnd-outline marker lamp \\nA lamp fitted as close as possible the extreme outer edge and to the top of the \\nvehicle and intended to indicate clearly the vehicle’s overall width.  \\nNote:This lamp is intended, for certain vehicles and trailers, to complement the \\nvehicle’s front and rear position lamps by drawing particular attention to its bulk. \\n3.9.22 \\nSide marker lamp \\nA lamp used to indicate the presence of the vehicle when viewed from the side. \\n3.9.23 \\nDaytime running lamp \\nA lamp facing in a forward direction used to make the vehicle more easily visible \\nwhen driving during daytime. \\n3.9.24 \\nCornering lamp \\nA lamp used to provide supplementary illumination of that part of the road which \\nis located near the forward corner of the vehicle at the side towards which the \\nvehicle is going to turn. \\n3.9.25 \\nAdaptive front lighting system (AFS) \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n12 \\nFor Reference Purposes Only \\nA front lighting device providing beams with different characteristics, which could \\nautomatically become adapted to the varying conditions of the dipped-beam \\nheadlamp and main-beam headlamp (if applicable). \\n3.9.25.1 \\nLighting unit \\nMeans the light emitting component used to provide or contribute to one or more \\nAFS lighting function (s) or as a part of it. \\n3.9.25.2 \\nInstallation unit \\nAn indivisible housing (lamp body) which contains one or more lighting unit(s). \\n3.9.25.3 \\nLighting mode or mode \\nMeans a state of a front lighting function provided by the AFS, as specified by \\nthe manufacturer and intended for adaptation to specific vehicle and ambient \\nconditions. \\n3.9.25.4 \\nSystem control \\nPart(s) of the AFS receiving the AFS control signals and controlling the \\noperation of the lighting units automatically. \\n3.9.25.5 \\nAFS control signal \\nAFS control signal (V, E, W and T) that is input to the system, or any additional \\ncontrol signal that is input to the system, or the control signal that is output to the \\nvehicle from the system. \\n3.9.25.6 \\nNeutral state \\nThe state of the AFS when a mode of the class C dipped-beam (basic \\ndipped-beam) or of the main-beam is produced, and no AFS control signal \\nexists in the system. \\n3.9.25.7 \\nAdaptive main-beam \\nMeans the main-beam of AFS, according to oncoming vehicle or forward vehicle \\nto adjust the beam mode to improve the visibility of the driver inside the far \\nrange, and that shall not cause discomfort, glare or distraction of attention to \\ndriver or other road users. \\n3.9.26 \\nInterdependent lamp system  \\nY-lamp system \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n13 \\nFor Reference Purposes Only \\nMeans an assembly of two or three interdependent lamps providing the same \\nfunction. \\n3.9.26.1 \\nInterdependent lamp  \\nY-lamp \\nMeans the partial device of interdependent lamp system, interdependent lamps \\nfeature simultaneously turning-on, separate apparent surface along reference \\naxis and separate lamp body, can also have a separate light source. \\n3.9.27 \\nEmergency stop signal \\nA warning signal to indicate to other road users to the rear of the vehicle that the \\nvehicle is applying the high-deceleration emergency braking retardation. \\n3.9.28 \\nMarker lamp for draw-bar-trailer \\nA marker lamp installed at the front of draw-bar-trailer which is a lamp, white \\nwhen viewed from the front and red viewed from the rear, used to help other \\nsignaling lamps in indicating the presence of the vehicle. \\n3.9.29 \\nManoeuvring lamp \\nA lamp used to provide supplementary illumination to the side of the vehicle to \\nassist during slow maneuvers. \\n3.9.30 \\nRear-end collision alert signal (RECAS) \\nAn automatic signal emitted by a forward vehicle to a backward vehicle. In order \\nto warn the backward vehicle to take urgent action to avoid collision. \\n3.9.31 \\nLamps marked “D” \\nCan be used alone, or two-lamp assembly is used as “single lamp”, type test of \\nindependent lamp is performed respectively. \\n3.10 \\nLight emitting surface \\nAll or part of external surface of transparent materials, the surface hall be \\nindicated by the manufacturer of the device on the drawing according to the \\nfollowing conditions: \\na) \\nIn the case where the outer lens is textured, the light emitting surface shall \\nbe all or part of the exterior surface of the outer lens; \\nb) \\nIn the case where the outer lens is non-textured, the outer lens can be \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n14 \\nFor Reference Purposes Only \\ndisregarded and the light emitting surface shall be as declared on the \\ndrawing; \\nNote 1: example of light emitting surface is shown in Annex B, B3.1 and B3.4 \\nNote 2: example of condition b) is shown in B.3.5. \\n3.10.1 \\nTextured outer lens or textured outer lens area \\nMeans all or part of an outer lens, designed to influence the propagation of light \\nfrom the light source(s), such that the light rays are significantly diverted from \\ntheir original direction. \\n3.11 \\nIlluminating surface  \\nNote: example of illuminating surface is shown in Annex B. \\n3.11.1 \\nIlluminating surface of a lighting device \\nMeans the orthogonal projection of the full aperture of the reflector, or in the \\ncase of headlamps with an ellipsoidal reflector of the “projection lens”, on a \\ntransverse plane of perpendicular to reference axis. If the lighting device has no \\nreflector, the definition of 3.11.2 shall be applied. If the light emitting surface of \\nthe lamp extends over part only of the full aperture of the reflector, then the \\nprojection of that part only is taken into account. \\nIn the case of a dipped-beam headlamp, the illuminating surface is limited by the \\napparent trace of the cut-off on to the lens. If the reflector and lens are \\nadjustable relative to one another, the mean adjustment shall be used. \\nIn the case of AFS being installed: Where a lighting function is produced by two \\nor more simultaneously operated lighting units on a given side of the vehicle, the \\nindividual illuminating surfaces, taken together, constitute the illuminating \\nsurface to be considered (for example, in the Figure 3, the individual illuminating \\nsurfaces of the lighting units 8, 9 and 11, regarded together and taking into \\naccount their respective location, constitute the illuminating surface to be \\nconsidered for the right hand side of the vehicle). \\nNote: lamps with illuminating surface of a lighting device include: Main-beam headlamp, \\ndipped-beam headlamp, front fog lamp, reversing lamp, cornering lamp and AFS. \\n3.11.2 \\nIlluminating surface of a light-signalling device other than a retro-reflector  \\nThe orthogonal projection of the lamp in a plane perpendicular to its axis of \\nreference and in contact with the exterior light emitting surface of the lamp, this \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n15 \\nFor Reference Purposes Only \\nprojection being bounded by the edges of screens situated in this plane, each \\nallowing only 98% of the total luminous intensity of the light to persist in the \\ndirection of the axis of reference. \\nNote: lamps with illuminating surface of a light-signalling deice other than a retro-reflector include:  \\nDirection-indicator lamp, stop lamp, rear-registration plate illuminating device, front position lamp, \\nrear position lamp, hazard warning signal, rear fog lamp, parking lamp, end-outline marker lamp,  \\n3.11.3 \\nIlluminating surface of a retro-reflector \\nThe orthogonal projection of a retro-reflector in a plane perpendicular to its axis \\nof reference and delimited by planes contiguous to the declared outermost parts \\nof the retro-reflectors' optical system and parallel to that axis. When determining \\nthe lower, upper and lateral edges of the device, only horizontal and vertical \\nplanes shall be considered. \\n3.12 \\nApparent surface \\nMeans at the request of manufacturer, either the vertical projection of the \\nboundary of illuminating surface projected on the exterior surface of the lens on \\na plane, or vertical projection of light emitting surface on a plane, the plane is \\nperpendicular to the direction of observation and contact with the most exterior \\npoint of the lens. \\nNote 1: For light-signalling device producing variable luminous intensities by \\nvariable luminous intensities control gear in accordance with the requirements \\nas specified in 3.8.3 under all cases permitted by the variable luminous \\nintensities control gear, its apparent surface can be variable. \\nNote 2: The examples of apparent surface can be found in Annex B. \\n3.13 \\nAxis of reference (reference axis) \\nThe characteristic axis of the lamp determined by the manufacturer for use as \\nthe direction of reference (H=0º, V=0º) for angles of field for photometric \\nmeasurements and for installing the lamp. \\n3.14 \\nCentre of reference \\nMeans the intersection of the axis of reference with the exterior light emitting \\nsurface. It is specified by the lamp manufacturer. \\n3.15 \\nAngles of geometric visibility \\nMeans the angles which determine the field of the minimum solid angle in which \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n16 \\nFor Reference Purposes Only \\nthe apparent surface of the lamp must be visible. That field of the solid angle is \\ndetermined by the segments of the sphere of which the center coincides with the \\ncenter of reference of the lamp and the equator is parallel with the ground. \\nThese segments are determined in relation to the axis of reference. The \\nhorizontal angles β correspond to the longitude and the vertical angles α to the \\nlatitude. \\n3.16 \\nExtreme outer edge \\nThe plane is parallel to the median longitudinal plane of the vehicle and touching \\nits lateral outer edge. The following projections shall be disregarded: \\n-- \\nTyres near their point of contact with the ground, and of connections for \\ntyre-pressure gauges; \\n-- \\nAny anti-skid devices mounted on the tyres; \\n-- \\nRear-view mirrors (devices for indirect vision); \\n-- \\nSide direction-indicator lamps, end-outline marker lamps, front and rear \\nposition lamps, parking lamps, retro-reflectors and side-marker lamps; \\n-- \\nCustoms seals affixed to the vehicle, and of devices for securing and \\nprotecting such seals. \\n3.17 \\nOverall dimensions \\n3.17.1 \\nOverall width \\nMeans the distance between the two vertical planes defined in 3.15 above. \\n3.17.2 \\nOverall length \\nMeans the distance between the two vertical planes perpendicular to the median \\nlongitudinal plane of the vehicle and touching its front and rear outer edge, \\ndisregarding the projection: \\n-- \\nRear-view mirrors (devices for indirect vision); \\n-- \\nEnd-outline marker lamps; \\n-- \\nCoupling devices of motor vehicles. \\nNote: For trailers in the “overall length” and in any measurement in length the \\ndrawbar shall be included (except when specifically excluded). \\n3.18 \\nSingle and multiple lamps \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n17 \\nFor Reference Purposes Only \\n3.18.1 \\nA single lamp \\na) \\nMeans a device or part of a device having one lighting or light-signalling \\nfunction, one or more light source(s) and one apparent surface in the \\ndirection of the reference axis (which can be a continuous surface or \\ncomposed of two or more distinct parts); or \\nb) \\nAssembly consisting of two lamps marked “D”; or \\nc) \\nAssembly consisting of two independent retro-reflectors (approved \\nseparately in type test); or \\nd) \\nInterdependent lamp system consisting of two or three interdependent \\nlamps. \\n3.18.2 \\nTwo lamps (an even number of lamps) \\nMeans the device in which two lamps use one same light emitting surface in the \\nshape of a band (strip) and light emitting surface is symmetrical in relation to the \\nlongitudinal symmetrical plane of the vehicle. \\n3.19 \\nDistance between two lamps \\nThe shortest distance between the two apparent surfaces in the direction of the \\nreference axis. Where the distance between the lamps clearly meets the \\nrequirements of this Standard, the exact edges of apparent surfaces need not \\nbe determined. \\n3.20 \\nOperating tell-tale \\nAn indicator light or beeper (or any equivalent signal) indicating that a device \\nhas been switched on and is operating correctly or not. \\n3.21 \\nClosed-circuit tell-tale \\nAn indicator light (or any equivalent signal) indicating that a device has been \\nswitched on, but not indicating whether it is operating correctly or not. \\n3.22 \\nOptional lamp \\nA lamp in compliance with the requirements of this Standard, the installation of \\nwhich is left to the discretion of the manufacturer. \\n3.23 \\nGround \\nThe surface on which the vehicle stands which shall be horizontal. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n18 \\nFor Reference Purposes Only \\n3.24 \\nMovable components \\nMovable components of the vehicle mean those body panels or other vehicle \\nparts the position(s) of which can be changed by tilting, rotating or sliding \\nwithout the use of tools. They do not include tiltable driver cabs of goods \\nvehicles. \\n3.25 \\nNormal position of use of a movable component \\nMeans the movable component is loacated at the usable position specified by \\nthe vehicle manufacturer. \\n3.26 \\nNormal condition of use of a vehicle \\n \\nFor a motor vehicle, means that the vehicle is ready to move with its propulsion \\nengine running and its movable components in the normal position of use of a \\nmovable component(3.25). \\n \\nFor a trailer, means that the trailer is connected to a drawing motor vehicle in the \\nconditions as above mentioned and its movable components are in the normal \\nposition of use of a movable component(3.25). \\n3.27 \\nPark condition of a vehicle \\n \\nFor a motor vehicle, means that the vehicle is at standstill and its propulsion \\nengine is not running and its movable components in the normal position of use \\nof a movable component (3.25). \\n \\nFor a trailer, means that the trailer is connected to a drawing motor vehicle in the \\ncondition as above mentioned and its movable components are in the normal \\nposition of use of a movable component(3.25). \\n3.28 \\nBend lighting \\nA lighting function to provide enhanced illumination in bends. \\n3.29 \\nPair \\nMeans a pair of lamps of the same function respectively installed on the left- and \\nright-hand sides of the vehicle. \\n3.29.1 \\nMatched pair \\nMeans a pair of lamps of the same function installed respectively on the left and \\nright sides of the vehicle, which complies with the photometric requirements as a \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n19 \\nFor Reference Purposes Only \\nwhole. \\n3.30 \\nH plane \\nHorizontal plane passing through reference axis of lamp. \\n3.31 \\nSequential activation \\nAll light sources of lamp are controlled by electronic system and are switched on \\nas per preset sequence. \\n \\n4 \\nGeneral Requirements \\n4.1 \\nThe lighting and light-signalling devices shall ensure that under normal \\nconditions as defined in 3.26 and notwithstanding any vibrations, they still meet \\nrequirements prescribed by this Standard on all devices and complete vehicle. It \\nshall not be possible for the lamps to be inadvertently maladjusted due to \\nimproper operation. In particular, the lamp shall be free from looseness and \\nmisadjustment. \\n4.2 \\nThe dipped-beam headlamps, main-beam headlamps, and front fog lamps shall \\nbe so installed that correct adjustment of their orientation can easily be carried \\nout. \\n4.3 \\nFor all light-signalling devices (including those mounted on the side panels of \\nvehicle), the reference axis of the lamp when fitted to the vehicle shall be \\nparallel to the bearing plane of the vehicle on the road; in addition it shall be \\nperpendicular to the median longitudinal plane of the vehicle in the case of side \\nretro-reflectors and of side-marker lamps and parallel to that plane in the case of \\nall other signaling devices. In each direction a tolerance of ±3º shall be allowed. \\nIn addition, any specific instructions as regards fitting laid down by the \\nmanufacturer shall be complied with. \\n4.4 \\nIn the absence of specific instructions, the height and orientation of the lamps \\nshall be verified with the vehicle unladen and placed on a flat, horizontal surface, \\nin the condition defined in 3. 26, in the case where an AFS is installed, with the \\nsystem in its neutral state. \\n4.5 \\nInstallation requirements of paired lamps shall meet below requirements. \\na) Be fitted to the vehicle symmetrically in relation to the median longitudinal \\nplane (this estimate to be based on the exterior geometrical form of the lamp \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n20 \\nFor Reference Purposes Only \\nand not on the edge of its illuminating surface referred to in 3.11). \\nb) Be symmetrical to one another in relation to the median longitudinal plane, \\nthis requirement is not valid with regard to the interior structure of the lamp. \\nc) Satisfy the same colorimetric and photometric requirements. This shall not \\napply to a matched pair of Class F3 front fog lamps. \\n4.6 \\nOn vehicles whose external shape is asymmetrical the requirements of 4.5 shall \\nbe satisfied so far as is possible. \\n4.7 \\nA single lamp and grouped, combined and reciprocally incorporated lamps \\nshould meet below requirements: \\na) Lamps may be grouped, combined or reciprocally incorporated with one \\nanother provided that all requirements regarding color, position, orientation, \\ngeometric visibility, electrical connections and other requirements, if any, are \\nfulfilled. \\n1) The photometric and colorimetric requirements of a lamp shall be fulfilled \\nwhen all other functions with which this lamp is grouped, combined or \\nreciprocally incorporated are switched OFF. However, when a front or rear \\nposition lamp is reciprocally incorporated with one or more other function(s) \\nwhich can be activated together with them, the requirements regarding color of \\neach of these other functions shall be fulfilled when the reciprocally incorporated \\nfunction(s) and the front or rear position lamps are switched ON. \\n2) Stop lamps and direction-indicator lamps are not permitted to be reciprocally \\nincorporated. \\n3) Where stop lamps and direction-indicator lamps are grouped, it should \\nensures that the borderlines of adjacent areas of different color formed by the \\nprojections of apparent surface perpendicular to reference axis. The horizontal \\nand vertical straight line shall not intersect the above-mentioned boundary for \\nexceed two times. Their apparent surfaces in the direction of the reference axis, \\nbased upon the areas bounded by the outline of their light emitting surfaces, do \\nnot overlap. \\nb) A single lamp should meet below requirements: \\n1) For single lamp stated in 3.18.1 a), if the apparent surface consists of several \\nseparate parts in the reference axis direction jointly, the following requirements \\nshall be met: Total area of the projection of all parts in the reference axis \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n21 \\nFor Reference Purposes Only \\ndirection shall be not less than 60% of area of the smallest quadrilateral \\ncircumscribing projection of the function boundary in the reference axis direction; \\nor the distance between two adjacent/tangential parts shall not exceed 75mm \\n(measurement direction of distance is perpendicular to reference axis) in the \\nreference axis direction. Such requirement is not applicable to main-beam \\nheadlamp, dipped-beam headlamp, front fog lamp and retro-reflector. \\n2) For two lamps marked “D” or two independent retro-reflectors stated in 3.18.1 \\nb) or c), the following requirements shall be met: Total area of apparent surface \\nof two lamps or retro-reflectors in the reference axis direction shall be not less \\nthan 60% of area of the smallest quadrilateral circumscribing project ion of the \\nfunction boundary in the reference axis direction; or the distance between two \\nadjacent apparent surfaces shall not exceed 75mm in the reference axis \\ndirection (measurement direction of distance is perpendicular to reference axis).  \\nA part of lamp in the shape of a band (strip) can be deemed as lamp marked “D”. \\n3) For a single lamp stated in 3.18.1 d), requirements of 4.7.b.1 shall be met: \\nOne same lamp body or outer lens containing two or more than two lamps (or \\napparent surface) is not deemed as interdependent lamp system. A part of lamp \\nin the shape of a band (strip) can be deemed as a part of interdependent lamp \\nsystem. All light sources of interdependent lamp system should be turned on \\nand off simutaneously. \\nc) Two lamps or even number of lamps in the shape of a band (strip) shall be \\nplaced symmetrically in relation to the longitudinal symmetry plane of the vehicle, \\nshall be not less than 0.8m long and shall extend on both sides to not more than \\n0.4m from the extreme outer edge of the vehicle; number of light sources shall \\nbe not less than two, and light sources shall be positioned as close to two ends \\nas possible; the light emitting surface may be constituted by several juxtaposed \\nilluminating elements, at this point, the projections of light emitting surfaces of \\nthese illuminating elements on a transverse plane shall meet requirements of \\n4.7.b.1. \\n4.8 \\nThe maximum height above the ground shall be measured from the highest \\npoint and the minimum height from the lowest point of the apparent surface in \\nthe direction of the reference axis. (In case installation position obviously meets \\nrequirements of this Standard, it is unnecessary to determine accurate edge of \\nany surface.) Except for below situation: \\na) Where ground clearance may reduce requirement on geometric visibility, it is \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n22 \\nFor Reference Purposes Only \\nnecessary to measure ground clearance by taking H plane of lamp as reference. \\nb) In the case of dipped-beam headlamp and front fog lamp, the minimum \\nground clearance shall be measured from the lowest point of the effective \\naperture of the optical system (e.g. reflector, lens, projection lens). \\nc) Crosswise installation position, for overall width: Determine as per apparent \\nsurface edge furthest from longitudinal symmetry plane of vehicle along \\nreference axis direction. For spacing between lamps, determine as per inner \\nedges of apparent surface along reference axis direction. \\n4.9 \\nIn the absence of specific instructions, the photometric characteristics (e.g., \\nintensity, color, apparent surface, etc.) of a lamp shall not be artificially varied \\nduring the period of activation of the lamp. \\na)Direction-indicator lamps, the vehicle-hazard warning signal, side-marker \\nlamps complying with 5.18.7 below, and the emergency stop signal may be \\nflashing lamps. \\nb)The photometric characteristics of any lamp may vary: \\n-- \\nIn relation to the ambient light; \\n-- \\nAs a consequence of the activation of other lamps; or \\n-- \\nWhen the lamps is being used to provide another lighting function. \\nProvided that any variation in the photometric characteristics above is in \\ncompliance with the related technical provisions for the lamp concerned. \\nc)Under the precondition that photometric characteristics of direct ion-indicator \\nlamp of Categories 1, 1a, 1b, 2a or 2b are in compliance with stipulations of GB \\n17509, it is allowed to adopt the flashing mode of sequential activation. Where \\ndirection-indicator lamps of Categories 2a and 2b implement emergency braking \\nsignal as per 5.23.1, it is not allowed to adopt the flashing mode. \\n4.10 \\nFor various lamps in 3.9, no red light shall be visible from the front and no white \\nlight shall be visible from the rear (except the lighting devices fitted for the \\ninterior lighting of the vehicle). In case of doubt, the test shall be carried out in \\naccordance with the methods described below: \\na) Invisibility of red light towards the front of a vehicle: There shall be no direct \\nvisibility of the apparent surface of a red lamp if viewed by an observer moving \\nwithin the transverse plane of Zone 1 as specified in Annex C, kept 25m from \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n23 \\nFor Reference Purposes Only \\nthe front of the vehicle (except red rearmost side-marker lamp), see Figure C.1. \\nb) Invisibility of white light towards the rear: There must be no direct visibility of a \\napparent surface of a white lamp if viewed by an observer moving within Zone 2 \\nin a transverse plane situated 25m behind the vehicle as shown in Annex D \\n(with the exception of reversing lamp and conspicuity marking on the side of the \\nvehicle) , see Figure C.1. \\nc)In the two transverse planes mentioned above, the zones 1 and 2 explored by \\nthe eye of the observer  \\n1)In height, by two horizontal planes 1m and 2.2m respectively above the \\nground. \\n2)In width, by two vertical planes which, forming to the front and to the rear \\nrespectively an angle of 15º outwards from the vehicle's median \\nlongitudinal plane, pass through the point or points of contact of vertical \\nplanes parallel to the vehicle's median longitudinal plane delimiting the \\nvehicle's overall width; if there are several points of contact, the foremost \\nshall correspond to the forward plane and the rearmost to the rearward \\nplane. \\n4.11 \\nThe electrical connections shall be such that the front and rear position lamps, \\nthe end-outline marker lamps (if they exist), the side-marker lamps (if they exist), \\nthe rear registration plate lamp, and the marker lamps for draw-bar-trailer can \\nonly be switched ON and OFF simultaneously. Except for below situation: \\n \\n \\na)When front and rear position lamps are switched ON, as well as side-marker \\nlamps when combined or reciprocally incorporated with said lamps, as parking \\nlamps; or \\nb) When side-marker lamps flash in conjunction with direction indicators; or \\nc) When light-signalling system operates according to 5.2.7.6.b; \\nd) When passing-beam headlamp and/or driving-beam headlamp and/or front \\nfog lamp replace front position lamp according to stipulations of 4.12; \\n \\n \\ne) When the position lamp switch is off, and ignition/flameout control device of \\nthe engine (propulsion system) in a state that the engine (propulsion system) \\ncan work, the front position lamp and/or rear position lamp allows automatically \\nopen, until engine (propulsion system) stops working or close according to the \\nrequirements of this Standard. Excluding 5.9.7 and 5.10.7 situation. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n24 \\nFor Reference Purposes Only \\n4.12 \\nThe electrical connections shall be such that the main-beam and dipped-beam \\nheadlamps and the front fog lamps cannot be switched on unless the lamps \\nreferred to in 4.11 are also switched on. This requirement shall not apply, \\nhowever, when main-beam or dipped-beam headlamps are used to perform the \\nwarning signal function (i.e., the intermittent lighting up of the main-beam \\nheadlamp or the dipped-beam headlamp, or the alternate intermittent lighting up \\nof the main-beam and dipped-beam headlamps). The dipped-beam headlamps \\nand/or the main-beam headlamps and/or the front fog lamps may substitute the \\nfunction of the front position lamps when below conditions are met. \\na) The electrical connections must be such that if any lamp of above lamps fails, \\nfront position lamps automatically turn on; and \\nb) The substituting lamp/function meets, for the front position lamp, the following \\nconditions (proof shall be given in the test report of the corresponding lamps): \\n-- \\nThe geometric visibility prescribed for the front position lamps in 5.9.5; and \\n-- \\nThe minimum photometric limits according to the range of geometric \\nvisibility. \\n4.13 \\nTell-tale: Where a closed-circuit tell-tale is prescribed by this Standard, it may be \\nreplaced by an “operating” tell-tale. \\n4.14 \\nConcealable lamps should meet below requirements: \\na) The concealment of lamps shall be prohibited, with the exception of the \\nmain-beam headlamps, the dipped-beam headlamps and the front fog lamps, \\nwhich may be concealed when they are not in use. \\nb) In the event of any failure affecting the operation of the concealment device(s) \\nthe lamps shall remain in the position of use, if already in use, or shall be \\ncapable of being moved into the position of use without the aid of tools. \\nc) It shall be possible to move the lamps into the position of use and to switch \\nthem on (or not switch them on) by means of a single control. However, in the \\ncase of grouped main-beam and dipped-beam headlamps, the control referred \\nto above is required only to activate the dipped-beam headlamps. \\nd) It shall not be possible deliberately, from the driver's seat, to stop the \\nmovement of switched-on lamps before they reach the position of use. If there is \\na danger of dazzling other road users by the movement of the lamps, they may \\nlight up only when they have reached their position of use. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n25 \\nFor Reference Purposes Only \\ne) When the concealment device has a temperature of -30ºC to +50ºC the \\nheadlamps shall be capable of reaching the position of use within 3s of initial \\noperation of the control. \\n4.15 \\nColor of the light adopts 1931 XYZ color system in GB/T 3977, shown in Table \\n1~4 (measurement of the chromaticity coordinates of the lamps is not part of the \\ntype test this Standard). Requirements for colors of the light emitted by lamps is \\nshown in Table 5: \\nTable 1 Color of light emitted by lamp \\nColor \\nBoundaries of chromaticity areas \\nIntersection points of boundary \\nWhite \\nW12 (green boundary): y=0.150+0.640x \\nW23 yellowish green boundary y=0.440 \\nW34 yellow boundary x=0.500 \\nW45 reddish purple boundary y=0.382 \\nW56 purple boundary y=0.050+0.750x \\nW61 blue boundary x=0.310 \\nx     y \\nW1 \\n0.310 0.348 \\nW2 \\n0.453 0.440 \\nW3 \\n0.500 0.440 \\nW4 \\n0.500 0.382 \\nW5 \\n0.443 0.382 \\nW6 \\n0.310 0.283 \\nSelective \\nyellow \\nSY12 green boundary y=1.290x-0.100 \\nSY23 spectral locus \\nSY34 red boundary y=0.138+0.580x \\nSY45 yellowish white boundary y=0.440 \\nSY51 white boundary y=0.940-x \\nx    y \\nSY1 \\n0.454 0.486 \\nSY2 \\n0.480 0.519 \\nSY3 \\n0.545 0.454 \\nSY4 \\n0.521 0.440 \\nSY5 \\n0.500 0.440 \\nAmber \\nA12 green boundary y=x-0.120 \\nA23 spectral locus \\nA34 red boundary y=0.390 \\nA41 white boundary y=0.790-0.670x \\nx     y \\nA1 \\n0.545 0.425 \\nA2 \\n0.560 0.440 \\nA3 \\n0.609 0.390 \\nA4 \\n0.597 0.390 \\nRed \\nR12 yellow boundary y=0.335 \\nR23 spectral locus \\nR34 the purple line (its linear extension across the purple range of colors \\nbetween the red and the blue extremities of the spectral locus). \\nR41 purple boundary y=0.980-x \\nx     y \\nR1 \\n0.645 0.335 \\nR2 \\n0.665 0.335 \\nR3 \\n0.735 0.265 \\nR4 \\n0.721 0.259 \\nTable 2 Nighttime color of the retro-reflected light \\nColor \\nBoundaries of chromaticity areas \\nIntersect ion points of boundary \\nWhite \\nW12 blue boundary y=0.843-1.182x \\nW23 violet boundary y=0.489x+0.146 \\nW34 yellow boundary y=0.968-1.010x \\nW41 green boundary y=1.442x-0.136 \\nx     y \\nW1 \\n0.373 0.402 \\nW2 \\n0.417 0.350 \\nW3 \\n0.548 0.414 \\nW4 \\n0.450 0.513 \\nYellow \\nY12 green boundary y=x-0.040 \\nY23 spectral locus \\nY34 red boundary y=0.200x+0.268 \\nY41 white boundary y=0.970-x \\nx     y \\nY1 \\n0.505 0.465 \\nY2 \\n0.520 0.480 \\nY3 \\n0.610 0.390 \\nY4 \\n0.585 0.385 \\nAmber \\nA12 green boundary y=1.417x-0.347 \\nA23 spectral locus \\nA34 red boundary y=0.390 \\nA41 white boundary y=0.790-0.670x \\nx     y \\nA1 \\n0.545 0.425 \\nA2 \\n0.557 0.442 \\nA3 \\n0.609 0.390 \\nA4 \\n0.597 0.390 \\nRed \\nR12 yellow boundary y=0.335 \\nR23 spectral locus \\nR34 purple line \\nR41 purple boundary y=0.978-x \\nx    y \\nR1 \\n0.643 0.335 \\nR2 \\n0.665 0.335 \\nR3 \\n0.735 0.265 \\nR4 \\n0.720 0.258 \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n26 \\nFor Reference Purposes Only \\nTable 3 Daytime color of the light reflected from a device \\nColor \\nBoundaries of chromaticity areas \\nIntersection points of boundary \\nWhite \\nW12 violet boundary y=x-0.030 \\nW23 yellow boundary y=0.740-x \\nW34 green boundary y=x+0,050 \\nW41 blue boundary y=0.570-x \\nx     y \\nW1 0.300 0.270 \\nW2 0.385 0.355 \\nW3 0.345 0.395 \\nW4 0.260 0.310 \\nYellow \\nY12 red boundary y=0.534x+0.163 \\nY23 white boundary y=0.910-x \\nY34 green boundary y=1.342x-0.090 \\nY41 spectral locus \\nx     y \\nY1 0.545 0.454 \\nY2 0.487 0.423 \\nY3 0.427 0.483 \\nY4 0.465 0.534 \\nRed \\nR12 red boundary y=0.346-0.053x \\nR23 purple boundary y=0.910-x \\nR34 yellow boundary y=0.350 \\nR41 spectral locus \\nx     y \\nR1 0.690 0.310 \\nR2 0.595 0.315 \\nR3 0.560 0.350 \\nR4 0.650 0.350 \\nTable 4 Daytime color of the fluorescent device \\nColor \\nBoundaries of chromaticity areas \\nIntersection points of boundary \\nRed \\nFR12 red boundary y=0.346-0.053x \\nFR23 purple boundary y=0.910-x \\nFR34 yellow boundary y=0.315+0.047x \\nFR41 spectral locus \\nx     y \\nFR1 0.690 0.310 \\nFR2 0.595 0.315 \\nFR3 0.569 0.341 \\nFR4 0.655 0.345 \\nTable 5 Light colors \\nDescription of lamp \\nLight color \\nMain-beam headlamp \\nWhite \\nDipped-beam headlamp \\nWhite \\nFront fog lamp \\nWhite or selective yellow \\nReversing lamp \\nWhite \\nDirection-indicator lamp \\nAmber \\nHazard warning signal \\nAmber \\nStop lamp \\nRed \\nEmergency stop signal \\nAmber or red \\nRear registration plate lamp \\nWhite \\nFront position lamp \\nWhite \\nRear position lamp \\nRed \\nRear fog lamp \\nRed \\nParking lamp \\nWhite in front, red at the rear, amber if reciprocally incorporated in the side \\ndirection-indicator lamps or in the side-marker lamps \\nSide-marker lamp \\nAmber; however the rearmost side-marker lamp can be red if it is grouped or combined or \\nreciprocally incorporated with the rear position lamp, the rear end-outline marker lamp, the \\nrear fog lamp, the stop lamp or is grouped or has part of the light emitting surface in \\ncommon with the rear retro-reflector \\nEnd-outline marker lamp \\nWhite in front, red at the rear \\nDaytime running lamp \\nWhite \\nRear retro-reflector, non-triangular \\nRed \\nRear retro-reflector, triangular \\nRed \\nFront retro-reflector, non-triangular \\n(i.e., white or colorless \\nretro-reflector) \\nIdentical to incident light \\nSide retro-reflector, non-triangular \\nAmber; however, it may be red when grouped or has part of the light emitting surface in \\ncommon with the rear position lamp, the rear end outline marker lamp, the rear fog lamp, \\nthe stop-lamp, the red rearmost side-marker lamp or the rear retro-reflector, non-triangular \\nCornering lamp \\nWhite \\nConspicuity marking \\nRetro-reflective markings: Red and white \\nRear-marking plates: Red and yellow \\nAdaptive front-lighting systems \\n(AFS) \\nWhite \\nMarker lamp for draw-bar-trailer \\nWhite to the front, and red to the rear \\nManoeuvring lamp \\nWhite \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n27 \\nFor Reference Purposes Only \\nRear-end collision alert signal \\nAmber \\n4.16 \\nThe number of lamps mounted on the vehicle shall comply with the appropriate \\nrequirements in the individual specifications of Chapter 5. \\n4.17 \\nIlluminating surface of a light-signalling device other than a retro-reflector is \\ndetermined as below method: \\na) When determining the lower, upper and lateral limits of illuminating surface, \\nthe screens shall remain parallel or vertical, and calculate distance from extreme \\nouter edge of vehicle and ground clearance based on this. \\nFor other applications of the illuminating surface, e.g. distance between two \\nlamps or functions, the shape of the periphery of this illuminating surface shall \\nbe used. The screens shall remain parallel, and any orientation is allowed to be \\nused. \\nIn the case of a light-signalling device whose illuminating surface encloses \\neither totally or partially the illuminating surface of another function or encloses a \\nnon-lighted surface, the illuminating surface may be considered to be the light \\nemitting surface itself (see Annex B, B3.2, B3.3, B3.5 and B3.6). \\nb) For all applications of the illuminating surfaces, the screens shall remain \\nparallel or vertical, when determining the lower, upper and lateral limits of \\nilluminating surface. \\n4.18 \\nFor rear position lamps, rear direction-indicators and rear retro-reflectors, \\ntriangular as well as non-triangular installed on movable components should \\nmeet below requirements: \\na) At all fixed positions of the movable components, the lamps on the movable \\ncomponents meet all the position, geometric visibility, colorimetric and \\nphotometric requirements for those lamps; or when the movable component is in \\nany fixed open position, the present additional lamps are activated automatically, \\nlamps on replacement movable component shall meet installation position, \\ngeometric visibility, and photometric requirements. \\nb) In the case of lamp comprising two lamps marked “D”, only one of the lamps \\nneeds to meet the position, geometric visibility and photometric requirements for \\nthose lamps at all fixed positions of the movable components (i.e., deemed \\ncompliance with 4.18.a); or when the movable component is in any fixed open \\nposition, the present additional lamps are activated automatically, lamps on \\nreplacement movable component shall meet installation position, geometric \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n28 \\nFor Reference Purposes Only \\nvisibility, and photometric requirements. \\nc) In the case of interdependent lamp system either of the following conditions \\nshall apply: \\n-- \\nWhere the entire interdependent lamp system is fitted on movable \\ncomponent: It is necessary to meet stipulations of 4.18.a. Where the \\nmovable component is moved to open position, additional lamps that \\nfeature automatic activation, lamps on replacement movable component \\nshall meet installation position, geometric visibility, colorimetric and \\nphotometric requirements. Or \\n-- \\nWhere only part of interdependent lamp system (except direction-indicator \\nlamp) is fitted on movable component: manufacturer shall ensure, when the \\nmovable component is in any fixed position, interdependent lamp exists in \\nthe system, and meets all the installation position, outward geometric \\nvisibility, colorimetric and photometric requirements of the function. Where \\ninterdependent lamp still meets relevant photometric limits requirements \\nwhen the movable component is on any fixed position, it is deemed as \\ncompliance with requirements on inward geometric visibility. \\n-- \\nFor direction-indicator lamp, there shall be interdependent lamps meeting \\nrequirements on installation position, geometric visibility, chrominance and \\nphotometry where movable component is at any fixed position. Or, where \\nmovable component is moved to open position, additional lamps that \\nfeature automatic activation, and direction-indicator lamp on replacement \\nmovable component shall meet installation position, geometric visibility, \\ncolorimetric and photometric requirements. \\nd) When meeting the requirements of 4.18.b) and 4.18.c), the movable \\ncomponents are not in the “normal position of use”, and the corresponding \\nfunctional lamps on the movable component are allowed to close. \\n4.19 \\nWhen the movable components are in a position other than a “normal position of \\nuse”, the devices installed on them shall not cause undue discomfort to road \\nusers. \\n4.20 \\nWhen a lamp is installed on a movable component and the movable component \\nis in the “normal position(s) of use”, the lamp shall always return to the position(s) \\nspecified by the manufacturer in accordance with this Standard. In the case of \\ndipped-beam headlamps and front fog lamps, this requirement shall be \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n29 \\nFor Reference Purposes Only \\nconsidered satisfied if, when the movable components are moved and returned \\nto the normal position 10 times, no value of the angular inclination of these \\nlamps, relative to its support measured each time, differs by more than 0.15% \\nfrom the average of the 10 measured values. If the result exceeds the limit value, \\npermissible range specified in 5.2.6.1.1 shall be adjusted when vehicle needs to \\nbe inspected as per Annex D, subtract the exceeding amount in order to reduce \\nthe permissible range of the inclinations. \\n4.21 \\nWhen observed in the direction of the reference axis, the apparent surface of \\nfront and rear position lamps, front and rear direction-indicator lamps, and \\nfrontal and rear retro-reflectors shall not be hidden more than 50% by any \\nmovable component (with or without a light-signalling device installed on it), in \\nany fixed position. If the above conditions can not be met, the below \\nrequirements shall be met. \\na) The present additional lamps satisfying all the position, geometric visibility, \\ncolorimetric and photometric requirements for the above indicated lamps shall \\nbe automatically activated when the apparent surface in the direction of the \\nreference axis of these lamps is more than 50% hidden by the movable \\ncomponent; or \\nb) In the lamp test information, it shall be explained as below: More than 50% of \\nthe apparent surface in the direction of the reference axis can be hidden by the \\nmovable components; and a notice in the vehicle shall inform the user that in \\ncertain position(s) of the movable components other road users shall be warned \\nof the presence of the vehicle on the road; for example by means of a warning \\ntriangle or other devices according to national requirements for use on the road. \\nThis requirement does not apply to retro-reflectors. \\n4.22 \\nWith the exception of retro-reflectors, all lamps (incl. the already type-approved \\nlamps) may be deemed not to be present when it cannot be made to operate by \\nthe sole installation of a light source and/or a fuse. \\n4.23 \\nLamps (except non-replaceable light source mentioned in 3.7.2) using \\nreplaceable filament light source in accordance with the provisions of GB \\n15766.1 and regulation ECE R37 shall be fitted in a vehicle in such a way that \\nthe light source can be replaced without the need for special tools other than \\nthose tools provided with the vehicle, and the vehicle manufacturer shall provide \\nwith the vehicle a detailed description of the procedure for replacement. \\nFor light source module, if its holder is identical with replaceable light source \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n30 \\nFor Reference Purposes Only \\nholder in GB 15766.1 and regulation ECE R37, this stipulation shall be met too. \\n4.24 \\nRear position lamp, in the event of a temporary failure, may be replaced by a \\nlamp similar in color, main intensity and position, while the replacement device \\nshall remain operational in its original function. During this period, an operating \\ntell-tale on the dashboard (see 3.20) shall indicate occurrence of a temporary \\nreplacement and need for repair. \\n4.25 \\nWhere an AFS is fitted, it shall be considered equivalent to a pair of \\ndipped-beam headlamps and a pair of main-beam headlamps (if configured). \\n4.26 \\nRear direction-indicator lamps, rear position lamps, stop lamps (except stop \\nlamps of Category S4) and rear fog lamps with variable luminous intensity \\ncontrol are allowed, which respond simultaneously to at least one of the \\nfollowing external influences: ambient lighting, fog, snowfall, rain, spray, dust \\nclouds, contamination of the light emitting surface, provided that their prescribed \\nintensity relationship is maintained throughout variation transitions. No sharp \\nvariation of intensity shall be observed during transition. Stop lamps of Category \\nS4 shall produce variable luminous intensity independent of the other lamps. \\nAllow manual operation function, it shall be possible for the driver to set the \\nluminous intensities of the lamps above to their steady luminous intensity state, \\nyou can also return them to their automatic variable category. \\n4.27 \\nFor vehicles of Categories M and N, the applicant shall demonstrate to the test \\nagency that, when the electrical system of the vehicle is in a stable voltage \\noperating condition, the electric power supply conditions for the main-beam \\nheadlamps, dipped-beam headlamps, stop lamps, front position lamps, and rear \\nposition lamps comply with below provisions. \\na) Under the condition that the terminal voltage of power supply device meets \\ntype test description of above functions (There are special provisions for voltage \\nif the application of a special power supply/electronic light source control gear, \\nor under a secondary operating mode). The voltage shall not exceed the scope \\nof voltage specified in type approval test description document. \\nb) In all cases of electric power supply conditions not covered by 4.27.a), the \\nstable voltage at the terminals of the device or function shall not exceed 6.75V \\n(6V system), 13.5V (12V system) or 28.0V (24V system) by more than 5%. \\nDevice itself may feature terminal maximum voltage control function. \\nc) The provisions of 4.27.a and 4.27.b shall not apply to devices which include \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n31 \\nFor Reference Purposes Only \\nan electronic light source control gear or a variable intensity control being part of \\nthe device. \\nd) In the type test documents, information shall be furnished to prove the \\nmethods and results for verifying the compliance. \\n4.28 \\nGeneral provisions relating to geometric visibility \\na) There shall be no obstacle within the angles of geometric visibility to the \\npropagation of light emitted from any apparent surface when observed from afar. \\nHowever, no account is taken of these obstacles within the angles of geometric \\nvisibility, if they were already presented when the lamp was type-approved. \\nb) If measurements are taken near to the lamp, the direction of observation shall \\nbe shifted parallel to achieve the same accuracy. \\nc) If, when the lamp is installed, apparent surface is partly hidden by any further \\nparts of the vehicle, proof shall be furnished that the part of the lamp not hidden \\nby obstacles still conforms to the photometric values prescribed for the type test \\nof the device. \\nd) For lamps less than 750mm above the ground (see measurement method as \\nper 4.8.a), downward geometric visibility may be reduced to 5º. The relevant \\nphotometric measurement scope may be reduced to 5º too. \\ne) In the case of an interdependent lamp system, the geometric visibility shall be \\nmeasured when all its interdependent lamps are operated together. \\n4.29 \\nFor the goods vehicles, special vehicles and trailers with GVW not less than \\n4,500kg, the light emitting surface of all the rear position lamps, rear \\ndirection-indicator lamps and stop lamps shall be not less than the area of a \\ncircle 80mm in diameter; if other than circular, the light emitting surface shall be \\nin such shape that a circle 40mm in diameter could be accommodated. \\n4.30 \\nA LED module does not need to be replaceable. \\n4.31 \\nThe external lighting and light-signalling devices that are not defined by this \\nStandard can be activated if the vehicle is stationary and one or more of the \\nfollowing conditions are satisfied, but validity of external lighting and \\nlight-signalling devices defined in this Standard shall not be prejudiced: \\n-- \\nThe engine (propulsion system) is stopped; \\n-- \\nA driver or passenger door is opened; \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n32 \\nFor Reference Purposes Only \\n-- \\nA boot door is opened. \\n5 \\nIndividual Specifications \\n5.1 \\nMain-beam headlamp (except Class A in GB 4599, GB 21259 and GB \\n25991) \\n5.1.1 \\nPresence:  \\nMandatory on motor vehicles, and prohibited on trailers. \\n5.1.2 \\nNumber:  \\nTwo or four. For vehicles of the Category N3, two extra main-beam headlamps \\nmay be installed. Where a vehicle is fitted with four concealable headlamps, the \\ninstallation of two additional headlamps is only permitted to have the function of \\nemitting intermittent light-signalling in daylight (see 4.12). \\n5.1.3 \\nArrangement:  \\nNo special requirements. \\n5.1.4 \\nPosition \\n5.1.4.1 \\nIn width: No special requirements. \\n5.1.4.2 \\nIn height: No special requirements. \\n5.1.4.3 \\nIn length: Installed at the front of the vehicle, such that the light emitted does not \\ncause discomfort to the driver either directly or indirectly through rear-view \\nmirrors (devices for indirect vision) or other reflecting surfaces of the vehicle. \\n5.1.5 \\nGeometric visibility: The visibility of the illuminating surface (including the \\nvisibility in areas which do not appear to be illuminated in the direction of \\nobservation considered) shall be ensured within a divergent space defined by \\ngenerating lines based on the perimeter of the illuminating surface and forming \\nan angle of not less than 5º with the axis of reference of the headlamp. The \\norigin of the angles of geometric visibility is the perimeter of the projection of the \\nilluminating surface on a transverse plane tangent to the foremost part of the \\nlens of the headlamp. \\n5.1.6 \\nOrientation: Towards the front. Not more than one main-beam headlamp on \\neach side of the vehicle may swivel to produce bend lighting. \\n5.1.7 \\nElectrical connections \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n33 \\nFor Reference Purposes Only \\n5.1.7.1 \\nExcept being switched ON in the intermitted manner for giving warning signal, \\nthe main-beam headlamps may not be activated unless when the master light \\nswitch is in headlamps “ON” position or in “AUTO” (automatic) position and the \\nconditions for automatic activation of dipped-beam exist. In the latter case, the \\nmain-beam headlamps shall be switched off automatically when the conditions \\nfor automatic activation of dipped-beam ceased to exist. \\n5.1.7.2 \\nThe control of the main-beam headlamps may be automatic, the control signals \\nbeing produced by a sensor system which is capable of detecting and reacting \\nto each of the following inputs: \\n-- \\nAmbient lighting conditions; \\n-- \\nThe light emitted by the front lighting devices and front light-signalling \\ndevices of oncoming vehicles; \\n-- \\nThe light emitted by the rear light-signalling devices of forward vehicles. \\nAdditional sensor functions to improve performance are allowed. \\n “vehicles” in this stipulate means vehicles of Categories L, M, N and O, such \\nvehicles being equipped with retro-reflectors, with lighting and light-signalling \\ndevices, which are switched ON. \\n5.1.7.3 \\nIt shall always be possible to switch the main-beam headlamps ON or OFF \\nmanually and to manually switch OFF the automatic control function of the \\nmain-beam headlamps. Furthermore, manual operation mode to switch off \\nmain-beam headlamp and main-beam headlamp automatic control function \\nshall be simple and direct, and secondary operation is not allowed. \\n5.1.7.4 \\nThe main-beam headlamps shall be switched on either simultaneously or in \\npairs. In case the extra two main-beam headlamps are installed as per 5.1.2, not \\nmore than two pairs may be simultaneously lit for vehicles of the Category N3. \\nFor changing over from the dipped to the main-beam, at least one pair of \\nmain-beam headlamps shall be switched on. For changing over from the \\nmain-beam to the dipped-beam, all main-beam headlamps shall be switched off \\nsimultaneously. \\n5.1.7.5 \\nThe dipped-beams may remain switched on at the same time as the \\nmain-beams. \\n5.1.7.6 \\nWhere four concealable headlamps are fitted, their raised position shall prevent \\nthe simultaneous operation of any additional headlamps fitted, if these are \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n34 \\nFor Reference Purposes Only \\nintended to provide intermittent light signals in daylight. \\n5.1.8 \\nTell-tale: Circuit-closed tell-tale mandatory. If the control of the main-beam \\nheadlamps is automatic as described in 5.1.7.1 above, an indication shall be \\nprovided to the driver that the automatic control of the main-beam function is \\nactivated. This information shall remain displayed as long as the automatic \\noperation is activated. \\n5.1.9 \\nOther requirements \\n5.1.9.1 \\nLimit of the maximum intensity  \\nThe aggregate maximum intensity of the main-beam headlamps which can be \\nswitched on simultaneously shall not exceed 430,000cd. \\n5.1.9.2 \\nThis aggregate maximum intensity of main-beam headlamps may be obtained \\nby the methods below. \\n5.1.9.2.1 \\nAdding together the maximum intensity of each headlamp respectively \\nmeasured under the charging state of the complete vehicle power supply \\nsystem; or \\n5.1.9.2.2 \\nShall be obtained through calculation of main-beam Emax value in type test \\nreport. \\n5.1.9.3 \\nFor the main-beam headlamps capable of automatic activation and deactivation \\n5.1.9.3.1 \\nThe requirements of automatic control function of the main-beam headlamps \\ndescribed in 5.1.7.1 above \\n5.1.9.3.1.1 \\nLight ray emitted by other vehicle that can be detected by sensor (as described \\nin 5.1.7.1), and the minimum scope boundary is determined by the following \\nangle. \\n- Horizontal angles: 15 to the left and 15 to the right. \\n- Vertical angles: See Table 6. \\nTable 6 Minimum scope boundary of vertical direction of sensor \\nUpward angle \\n5º \\nMounting height of the sensor (center of sensor aperture above the \\nground) \\nLess than 2m \\n1.5m to 2.5m \\nMore than \\n2.0m \\nDownward angle \\n2º \\n2º to 5º \\n5º \\nThese angles are measured from the center of the sensor aperture relative to a \\nhorizontal straight line through its center and parallel to the longitudinal median \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n35 \\nFor Reference Purposes Only \\nplane of the vehicle. \\n5.1.9.3.1.2 \\nThe sensor system shall be able to detect on a straight level road: \\n-- \\nOncoming power-driven at least within distance of 400m; \\n-- \\nForward power-driven or vehicle with trailer at least within distance of \\n100m. \\nWhen inspected as per above requirements, oncoming and forward \\npower-driven vehicle or vehicle featuring trailer shall switch on position lamp \\nand dipped-beam headlamp (if applicable). \\n5.1.9.3.2 \\nThe transition from main-beam to dipped-beam and vice versa according to the \\nconditions indicated in 5.1.7.1  \\nMay be performed automatically and shall not cause discomfort, distraction or \\nglare. \\n5.1.9.3.3 \\nThe method of proving the overall performance of the automatic control device \\n5.1.9.3.3.1 \\nTest may be performed by the means of simulation or other means put forward \\nby manufacturer, which, however, shall be accepted by the test agency. \\n5.1.9.3.3.2 \\nA test drive according to E1 in Annex E. The performance of the automatic \\ncontrol device shall be checked against the manufacturer’s description (required \\nto furnish documentary evidences). Any obvious malfunctioning shall be \\ncontested (e.g., flicker). \\n5.1.9.3.4 \\nThe main-beam headlamps having an automated control shall be switched ON \\nautomatically only when: \\nNo vehicles, as mentioned in 5.1.7.2 above, are detected within the fields and \\ndistances according to 5.1.9.3.1.1 and 5.1.9.3.1.2; and the detected ambient \\nlighting levels are as prescribed in 5.1.9.3.5. \\n5.1.9.3.5 \\nIn the case where main-beam headlamps are switched ON automatically, they \\nshall be switched OFF automatically when oncoming or forward vehicles, as \\ndefined in 5.1.7.2 above, are detected within the fields and distances according \\nto 5.1.9.3.1.1 and 5.1.9.3.1.2. \\nMain-beam headlamps shall be switched OFF automatically when the \\nluminance produced by ambient lighting conditions exceeds 7,000lx. \\nCompliance with this requirement shall be demonstrated by the manufacturer, \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n36 \\nFor Reference Purposes Only \\nusing simulation or other means of verification accepted by the test agency. If \\nnecessary the luminance shall be measured on a horizontal surface, with a \\ncosine corrected sensor on the same height as the mounting position of the \\nsensor on the vehicle. This may be demonstrated by the manufacturer by \\nsufficient documentation or by other means accepted by the test agency. \\n5.2 \\nDipped-beam headlamp (except Class A in GB 4599, GB 21259 and GB \\n25991) \\n5.2.1 \\nPresence:  \\nMandatory on motor vehicles, and prohibited on trailers. \\n5.2.2 \\nNumber:  \\nTwo. \\n5.2.3 \\nArrangement:  \\nNo special requirements. \\n5.2.4 \\nPosition \\n5.2.4.1 \\nIn width: That edge of the apparent surface in the direction of the reference axis \\nwhich is farthest from the vehicle's median longitudinal plane shall be not more \\nthan 400mm from the extreme outer edge of the vehicle. \\nThe inner edges of the apparent surfaces in the direction of the reference axes \\nshall be not less than 600mm apart. This does not apply, however, for Category \\nM1 and N1 vehicles; for all other Categories of motor vehicles this distance may \\nbe reduced to 400mm where the overall width of the vehicle is less than \\n1,300mm. \\n5.2.4.2 \\nIn height: Not less than 500mm and not more than 1,200mm above the ground. \\nFor Category N3G (off-road) vehicles, the maximum height may be increased to \\n1,500mm. \\n5.2.4.3 \\nIn length: At the front of the vehicle. This requirement shall be deemed to be \\nsatisfied if the light emitted does not cause discomfort to the driver either directly \\nor indirectly through the rear-view mirrors (devices for indirect vision) or other \\nreflecting surfaces of the vehicle. \\n5.2.5 \\nGeometric visibility: Defined by angles α and β as specified in 3.15: \\nα: 15º upwards and 10º downwards; \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n37 \\nFor Reference Purposes Only \\nβ: 45º outwards and 10º inwards. \\nThe presence of partitions or other items of equipment near the headlamp shall \\nnot give rise to secondary effects causing discomfort to other road users. \\n5.2.6 \\nOrientation: Towards the front. \\n5.2.6.1 \\nVertical orientation \\n5.2.6.1.1 \\nThe initial downward inclination of the cut-off of the dipped-beam to be set in the \\nunladen vehicle state with one person in the driver's seat shall be specified \\nwithin an accuracy of 0.1% by the manufacturer and indicated in a clearly legible \\nand indelible manner on each vehicle close to either headlamp or the \\nmanufacturer's plate by the prescribed symbol (see Annex F). Such symbol shall \\nbe clear and durable. \\nThe value of downward inclination shall be determined in accordance with \\n5.2.6.1.2. \\n5.2.6.1.2 \\nThe determination of value of downward inclination, depending on the mounting \\nheight h (expressed in m) of the lower edge of the apparent surface in the \\ndirection of the reference axis of the dipped-beam headlamp, measured on the \\nunladen vehicles, the vertical inclination of the cutoff of the dipped-beam shall, \\nunder all the static conditions of Annex A, remain between the following limits \\nand the initial aiming shall have the following values: \\nh<0.8 \\n \\nLimits: -0.5% to -2.5% \\nInitial aiming: -1.0% to -1.5% \\n0.8≤h≤1.0 \\nLimits: -0.5% to -2.5% \\nInitial aiming: -1.0% to -1.5% \\nOr, as per the instructions of the manufacturer: \\nLimits: -1.0% to -3.0% \\nInitial aiming: -1.5% to -2.0% \\nThe application for the vehicle type-approval shall, in this case, contain \\ninformation as to which of the two alternatives is to be used. \\nh>1.0 \\n \\nLimits: -1.0% to -3.0% \\nInitial aiming: -1.5% to -2.0% \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n38 \\nFor Reference Purposes Only \\nThe above requirements for limits and the initial aiming values are shown in \\nFigure 1. \\nFor Category N3G (off-road) vehicles where the headlamps exceed a height of \\n1,200mm: \\nLimits: -1.5% to -3.5% \\nInitial aiming: -2.0% to -2.5% \\n \\nFigure 1 Determination of dip value of dipped-beam lamp \\n5.2.6.2 \\nHeadlamp levelling device requirements \\n5.2.6.2.1 \\nFor an automatic headlamp levelling device, then the requirements of 5.2.6.1.1 \\nand 5.2.6.1.2 shall be satisfied. \\n5.2.6.2.2 \\nFor a manual headlamp levelling device, shall have a stop position at which the \\nlamps can be returned to the initial inclination defined in 5.2.6.1.1 by means of \\nthe usual adjusting screws or similar means, the adjustment (either continuously \\nor discontinuously) is permitted. \\nThese manual headlamp levelling devices shall be operable from the driver's \\nseat. \\nContinually adjustable devices shall have marks indicating the loading \\nconditions that require adjustment of the dipped-beam. \\nThe number of positions on devices which are not continuously adjustable shall \\nbe such as to ensure compliance with the range of values prescribed in \\n5.2.6.1.2 in all the loading conditions defined in Annex A. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n39 \\nFor Reference Purposes Only \\nFor these devices, the loading conditions of Annex A that require adjustment of \\nthe dipped-beam shall be clearly marked near the control of the device (see \\nAnnex G). \\n5.2.6.2.3 \\nIn the event of a failure of devices described in 5.2.6.2.1 and 5.2.6.2.2, the \\ndipped-beam shall not assume a position in which the dip is less than it was at \\nthe time when the failure of the device occurred. \\n5.2.6.2.4 \\nWhere vehicle structure can ensure that requirements of 5.2.6.1.1 to 5.2.6.1.2 \\nare met under the full-load condition defined in Annex A, it is not required to \\ninstall leveling device, but its headlamp shall feature cutoff line height \\nadjustment device. \\n5.2.6.3 \\nMeasuring procedure \\n5.2.6.3.1 \\nAfter adjustment of the initial inclination, the vertical inclination of the \\ndipped-beam, expressed in per cent, shall be measured in static conditions \\nunder all the loading conditions defined in Annex A. \\n5.2.6.3.2 \\nThe measurement of the vertical inclination of dipped-beam shall be carried out \\nin accordance with the test procedure set out in Annex D. \\n5.2.6.4 \\nHorizontal orientation:  \\nThe horizontal orientation of one or both dipped-beam headlamps can be varied \\nto produce bend lighting, provided that if the whole beam or the kink of the \\nelbow of the cutoff is moved, the kink of the elbow of the cutoff shall not intersect \\nthe line of the trajectory of the center of gravity of the vehicle at distances from \\nthe front of the vehicle which are larger than 100 times distance of the mounting \\nheight of the respective dipped-beam headlamps. \\n5.2.6.5 \\nInstallation direction \\n \\nForward. \\n5.2.7 \\nElectrical connections \\n5.2.7.1 \\nWhen switching dipped-beam shall switch off all main-beam headlamps \\nsimultaneously. \\n5.2.7.2 \\nThe dipped-beam may remain switched on at the same time as the \\nmain-beams. \\n5.2.7.3 \\nIn the case of dipped-beam headlamps using gas-discharge source, shall \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n40 \\nFor Reference Purposes Only \\nremain switched on during the main-beam operation. \\n5.2.7.4 \\nOne additional light source or one or more LED module(s), located inside the \\ndipped-beam headlamps or in a lamp (except the main-beam headlamp) \\ngrouped or reciprocally incorporated with the respective dipped-beam \\nheadlamps, can be activated to produce bend lighting, provided that the \\nhorizontal radius of curvature of the trajectory of the center of gravity of the \\nvehicle is 500m or less. This can be demonstrated by the manufacturer by \\ncalculation or by other means accepted by the test agency. \\n5.2.7.5 \\nDipped-beam headlamps may be switched ON or OFF automatically. However, \\nit shall be always possible to switch these dipped-beam headlamps ON and \\nOFF manually. \\n5.2.7.6 \\nIf daytime running lamps are present and operate according to 5.19 \\na)The dipped-beam headlamps shall be switched ON and OFF automatically \\nrelative to the ambient light conditions (e.g. switch ON during night-time driving \\nconditions, tunnels, etc.) according to the requirements of Annex H; and/or \\nb)Daytime running lamps operate in conjunction with the lamps listed in 4.11 \\nwhere, as a minimum requirement, at least the rear position lamps shall be \\nactivated; and/or \\n \\n \\nc)Inform the driver that the headlamps, front and rear position lamps and if so \\nequipped end outline marker lamps and side marker lamps are not illuminated. \\n1) Two distinctly different levels of instrument panel illumination intensity \\nare provided during night and day, indicating to the driver that the \\ndipped-beam headlamps shall be switched ON; or \\n2) When headlamp is activated, switch on nonluminous indicators of \\nmarking required in GB 4094; or \\n3) A tell-tale visual, auditory or both, shall be activated only in reduced \\nambient lighting conditions as defined in Annex H to inform the driver that \\nthe dipped-beam headlamps shall be switched ON. Once the tell-tale is \\nactivated, it shall only be extinguished when the dipped-beam headlamps \\nhave been switched on or the device which starts and/or stops the engine \\n(propulsion system) is set in a position which makes it impossible for the \\nengine (propulsion system) to operate. \\n5.2.7.7 \\nWithout prejudice to 5.2.7.6.a, the dipped-beam headlamps may switch ON and \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n41 \\nFor Reference Purposes Only \\nOFF automatically relative to other factors such as time or ambient conditions \\n(e.g. time of the day, vehicle location, rain, fog, etc.). \\n5.2.8 \\nTell-tale \\n5.2.8.1 \\nOptional. \\n5.2.8.2 \\nA tell-tale whether flashing or not shall be mandatory for the circumstances \\nbelow: \\n-- \\nIn the case where the whole beam or the kink of the elbow of the cut-off is \\nmoved to produce bend lighting; or \\n-- \\nOne or more LED modules are used to produce the principal dipped-beam \\n(unless electrical connection ensures that all modules are Off in case of \\nmalfunction of any LED). \\nIt shall be activated: \\n-- \\nIn the event of a malfunction of the displacement of the kink of the elbow of \\nthe cut-off; or \\n-- \\nIn case of a failure of any one of the LED module producing principal \\ndipped-beam (unless electrical connection ensures that all modules are Off \\nin case of malfunction of any LED). \\nIt shall remain activated while the failure is present. It may be cancelled \\ntemporarily, but shall be repeated whenever the device, which starts and stops \\nthe engine, is switched on and off. \\n5.2.9 \\nOther requirements \\nThe requirements of 4.5.b of this Standard shall not apply to dipped-beam \\nheadlamps. \\nUnilateral dipped-beam headlamps with a light source or LED module(s) \\nproducing the principal dipped-beam and having a total luminous flux which \\nexceeds 2,000 lm, shall be installed with a headlamp cleaner in compliance with \\nGB 21260. \\nWith respect to downward inclination, the device specified in 5.2.6.2.2 above \\nshall not apply to the circumstances below: \\n- \\nObjective luminous flux of the light sources or light source modules of the \\nunilateral principal dipped-beam exceeds 2,000lm. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n42 \\nFor Reference Purposes Only \\nThe above-mentioned “objective luminous flux” is subject to test voltage. \\nFor filament bulb allowing usage of multiple test voltages, the above-mentioned \\n“objective luminous flux” producing principal dipped-beam is subject to product \\ntest voltage used for type test of light sources. \\nOnly the dipped-beam lamps in compliance with GB 4599 or GB 21259 or GB \\n25991 may be used for realizing the bend lighting. \\nFor a left turn, if bend lighting is produced by a horizontal movement of the \\nwhole beam or the kink of the elbow of the cut-off, it shall be activated only if the \\nvehicle is in forward motion. \\n5.3 \\nFront fog lamp (GB 4660) \\n5.3.1 \\nPresence:  \\nOptional on motor vehicles. Prohibited on trailers. \\n5.3.2 \\nNumber:  \\nTwo. \\n5.3.3 \\nArrangement:  \\nNo special requirements. \\n5.3.4 \\nInstallation position \\n5.3.4.1 \\nIn width: That point on the apparent surface in the direction of the reference axis \\nwhich is farthest from the vehicle's median longitudinal plane shall not be more \\nthan 400mm from the extreme outer edge of the vehicle. \\n5.3.4.2 \\nIn height: \\nMinimum value: Not less than 250mm above the ground. \\nMaximum value: For Category M1 and N1 vehicles: not more than 800mm above \\nthe ground; for all other Categories except N3G (off-road) vehicles: not more \\nthan 1,200mm above the ground, for Category N3G vehicles: not more than \\n1,500mm above the ground. \\nIn the direction of the reference axis, the entire apparent surface of the front fog \\nlamp shall fall below the highest point on the apparent surface of the \\ndipped-beam headlamp. \\n5.3.4.3 \\nIn length: At the front of the vehicle. It is required that the light emitted does not \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n43 \\nFor Reference Purposes Only \\ncause discomfort to the driver either directly or indirectly through the rear-view \\nmirrors (devices for indirect vision) or other reflecting surfaces of the vehicle. \\n5.3.5 \\nGeometric visibility: Defined by angles α and β as specified in 3.15, angle α: 5º \\nupwards and downwards, angle β: 45º outwards and 10º inwards. \\nThe presence of lamp portion of front fog lamp or other equipment near front fog \\nlamp shall not give rise to reflection of front fog lamp light ray causing discomfort \\nto other road users. \\n5.3.6 \\nOrientation: Towards the front. \\n5.3.6.1 \\nVertical orientation \\n5.3.6.1.1 \\nIn the case of class “B” front fog lamps, the vertical inclination of the cut-off to be \\nset in the unladen vehicle state with one person in the driver's seat shall be \\n-1.5% or lower. \\n5.3.6.1.2 \\nIn the case of class “F3” front fog lamps \\na)Where the total objective luminous flux of the unilateral light source is not \\nmore than 2,000lm: The vertical inclination of the cut-off to be set in the unladen \\nvehicle state with one person in the driver’s seat shall be -1.0% or lower. \\nb)Where the total objective luminous flux of the light source exceeds 2,000lm: \\n1)Depending on the mounting height (h) of the lower edge of the apparent \\nsurface in the direction of the reference axis of the front fog lamp, \\nmeasured on the unladen vehicles, the vertical inclination of the cut-off \\nshall under all the static conditions of Annex A remain between the \\nfollowing values: \\nh≤0.8 \\n \\nLimits: -1.0% to -3.0% \\nInitial aiming: -1.5% to -2.0% \\nh>0.8 \\n \\nLimits: -1.5% to -3.5% \\nInitial aiming: -2.0% to -2.5% \\n2)The initial downward inclination of the cutoff to be set in the unladen \\nvehicle state with one person in the driver's seat shall be specified within an \\naccuracy of not more than 0.1% by the manufacturer and indicated in a \\nclearly legible and indelible manner on the front fog lamp or the \\nmanufacturer's plate or in combination with the indication referred to in \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n44 \\nFor Reference Purposes Only \\n5.2.6.1.1 by the symbol shown in Annex E. The value of this indicated \\ndownward inclination shall be defined in accordance with 5.3.6.1.2.b.1. \\n5.3.6.2 \\nFront fog lamp levelling device \\n5.3.6.2.1 \\nWhere a levelling device is fitted for a front fog lamp, independent or grouped \\nwith other front lighting device and light signalling device. Under all the loading \\nconditions of Annex A, vertical inclination of front fog lamp shall remain in the \\nscope prescribed in 5.3.6.1.2.b.1. \\n5.3.6.2.2 \\nIn the case where the front fog lamp of Category “F3” is part of the dipped-beam \\nheadlamp or is part of an AFS system, the requirements of 5.2.6 shall be applied \\nduring the use of the front fog beam as part of the dipped-beam. The vertical \\ninclination limits defined in 5.2.6 may be applied also when this front fog lamp is \\nused as such. \\n5.3.6.2.3 \\nThe levelling device may also be used to automatically adapt the inclination of \\nthe front fog beam in relation to the prevailing ambient conditions, provided that \\nthe limits for the vertical inclination specified in 5.3.6.1.2.b.1 are not exceeded. \\n5.3.6.2.4 \\nIn the case of a failure of the levelling device, the front fog beam shall not \\nassume a position in which the cut off is less inclined than it was at the time \\nwhen the failure of the device occurred. \\n5.3.6.2.5 \\nIf the vehicle structure can ensure that under all loading conditions specified in \\nAnnex A, can meet the requirements of 5.3.6.1.2.b.1, allowing not install leveling \\ndevices, but its front fog lamps shall have the devices to adjust the height of the \\ncutoff line. \\n5.3.6.3 \\nInstallation direction \\n \\nForward. \\n5.3.7 \\nElectrical connections: It shall be possible to switch the front fog lamps ON and \\nOFF independently of the main-beam headlamps, the dipped-beam headlamps \\nor any combination of main- and dipped-beam headlamps, unless: \\na)The front fog lamps are used as part of another lighting function in AFS; \\nhowever, activation of the front fog lamps shall have the priority over other \\nfunctions of the front fog lamps in AFS; or \\nb)According to GB 4660 requirements, front fog lamp and its reciprocally \\nincorporated other lamps cannot light up simultaneously. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n45 \\nFor Reference Purposes Only \\n5.3.8 \\nTell-tale: Circuit-closed tell-tale shall be mandatory. An independent non-flashing \\nwarning light. \\n5.3.9 \\nOther requirements: In the case where the alignment and the luminous \\nintensities of the class “F3” front fog beam may be automatically adapted in \\nrelation to the prevailing ambient conditions, any variations of the luminous \\nintensities or alignment shall be performed automatically and in such a way that \\nno discomfort, neither for the driver nor to other road users, is caused. \\n5.4 \\nReversing lamp (GB 15235) \\n5.4.1 \\nPresence:  \\nMandatory on motor vehicles and on trailers of Categories O2, O3 and O4. \\nOptional on trailers of Category O1. \\n5.4.2 \\nNumber \\n5.4.2.1 \\nOne device mandatory and a second device optional on motor vehicles of \\nCategory M1 and on all other vehicles with a length not exceeding 6,000mm. \\n5.4.2.2 \\nTwo devices mandatory and two devices optional on all vehicles with a length \\nexceeding 6,000mm, except vehicles of Category M1. \\n5.4.3 \\nArrangement:  \\nNo special requirements. \\n5.4.4 \\nInstallation position \\n5.4.4.1 \\nIn width: No special requirements. \\n5.4.4.2 \\nIn height: Not less than 250mm and not more than 1,200mm above the ground. \\n5.4.4.3 \\nIn length: At the rear of the vehicle. However, two optional reversing lamps \\nmentioned in 5.4.2.2 shall be allowed to fit on the side of the vehicle, and shall \\nbe in conformity with the requirements of 5.4.5.2 and 5.4.6. \\n5.4.5 \\nGeometric visibility \\n5.4.5.1 \\nFor reversing lamp fitted on the rear of vehicle, defined by angles α and β, as \\nspecified in 3.15. \\nAngle α: 15º upwards and 5º downwards. \\nAngle β: 45º to right and to left (if there is only one reversing lamp), 45º outwards \\nand 30º inwards (if there are two reversing lamps). \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n46 \\nFor Reference Purposes Only \\n5.4.5.2 \\nFor optional reversing lamp installed on lateral side of vehicle as per 5.4.2.2, \\nwhere the angle between reference axis and longitudinal symmetry plane of \\nvehicle is not more than 15º, it is deemed that requirements on geometric \\nvisibility are met. Two optional reversing lamps are allowed to irradiate directly \\ndownwards in vertical direction. \\n5.4.6 \\nOrientation:  \\nRearwards. Moreover, for optional reversing lamps mentioned in 5.4.2.2, if fitted \\non the side of the vehicle, shall comply with the above 5.4.5.2 requirements. \\n5.4.7 \\nElectrical connections \\n5.4.7.1 \\nThe reversing lamp can light up only if the reverse gear is engaged or drivetrain \\nis under reversing condition, and if the device which controls the starting and \\nstopping of the engine (propulsion system) is in such a position that operation of \\nthe engine (propulsion system) is possible. Otherwise, it shall not light up. \\n5.4.7.2 \\nMoreover, the electrical connections of the two optional devices mentioned in \\n5.4.2.2 shall be such that these devices cannot illuminate unless the lamps \\nreferred to in 4.11 are switched on. \\nProvided that the following conditions are met, where forward traveling speed of \\nvehicle is less than 10km/h, reversing lamp installed on lateral side of vehicle \\ncan be used as manoeuvring lamp: \\n-- \\nShall be equipped with independent switche for manual opening and \\nclosing; \\n-- \\nAs manoeuvring lamp function, it is possible to continue keeping state of \\nON after release of reversing gear; \\n-- \\nRegardless of the posit ion (on or off) of independent switch, where forward \\ntraveling speed of vehicle is more than 10km/h, lamp shall automatically \\nswitch off, and under the circumstance, lamp shall keep state of OFF until \\nswitch-on when the requirement on switch-on is met again. \\n5.4.8 \\nTell-tale:  \\nOptional. \\n5.4.9 \\nOther requirements:  \\nNone. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n47 \\nFor Reference Purposes Only \\n5.5 \\nDirection-indicator lamp (GB 17509) \\n5.5.1 \\nPresence: Shall be mandatory. See Figure 2 a). \\nCategory of direction-indicator lamps fall into Categories (1, 1a, 1b, 2a, 2b, 5 \\nand 6) the assembly of which on one vehicle constitutes an arrangement (“A” \\nand “B”). \\nArrangement “A” shall apply to all motor vehicles. Arrangement “B” shall apply to \\ntrailers only. \\n \\nArrangement A \\nCategories 5, 6 \\nCategories 2a, 2b \\nCategories 1, 1a, 1b \\n \\n \\nArrangement B \\nCategories 2a, 2b \\n \\na) Arrangement \\n \\nFront direction indicator \\nRear direction indicator \\nAmber rearmost side marker \\nSide direction indicator \\nForemost side marker \\n \\nb) For Categories M1 and N1 vehicles, direction-indicator lamp shall be arranged as per the \\nrequirements of manufacturer \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n48 \\nFor Reference Purposes Only \\nDescription: \\nArrangement A in Figure 2a): The value of 5º given for rear dead angle of geometric visibility of the \\nside direction-indicator lamps is an upper limit, d≤1.80m (for Categories M1 and N1 vehicles, \\nd≤2.50m). For direction-indicator lamp of Categories 1, 1a, 1b, 2a and 2b of which ground clearance \\nis not more than 750mm (see measurement method as per 4.8.1), the angle of inner geometric \\nvisibility below H plane can be reduced from 45º to 20º. \\nFiugre 2 b): The value of 5º given for rear dead angle of geometric visibility of the side \\ndirection-indicator lamps is an upper limit, d≤2.50m. \\nFigure 2 Arrangement of direction-indicator lamp \\n5.5.2 \\nNumber: According to the arrangement. \\n5.5.3 \\nArrangement: See Figure 2 a). \\n5.5.3.1 \\nArrangement A \\nTwo front direction-indicator lamps of the following categories: \\n-- \\nCategories 1 or 1a or 1b: If, in the direction of the reference axis, the \\ndistance between the edge of the apparent surface of this lamp and that of \\nthe apparent surface of the adjacent dipped-beam headlamp or the front \\nfog lamp is at least 40mm; \\n-- \\nCategories 1a or 1b: If the distance above is more than 20mm and less \\nthan 40mm; \\n-- \\nCategory 1b: If the distance above is not more than 20mm. \\nTwo rear direction-indicator lamps (Categories 2a or 2b): Two optional rear \\ndirection-indicator lamps (Categories 2a or 2b) on all vehicles in Categories M2, \\nM3, N2 and N3. \\nTwo side direction-indicator lamps of the Categories 5 or 6 (minimum \\nrequirements): \\n-- \\nCategory 5 for all Category M1 vehicles; and for Categories N1, M2 and M3 \\nvehicles not exceeding 6 meters in length; \\n-- \\nCategory 6 for all Categories N2 and N3 vehicles; and for Categories N1, M2 \\nand M3 vehicles exceeding 6 meters in length; \\n-- \\nIt is permitted to replace Category 5 side direction-indicator lamps by \\nCategory 6 side direction-indicator lamps in all instances. \\nWhere \\ndirection-indicator \\nlamps \\ncombining \\nthe \\nfunctions \\nof \\nfront \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n49 \\nFor Reference Purposes Only \\ndirection-indicator lamps (Categories 1, 1a, 1b) and side direction-indicator \\nlamps (Categories 5 or 6) are fitted, two additional side direction-indicator lamps \\n(Categories 5 or 6) may be fitted to meet the visibility requirements of 5.5.5. \\n5.5.3.2 \\nArrangement B: Two rear direction-indicator lamps (Categories 2a or 2b) \\nTwo optional rear direction-indicator lamps (Categories 2a or 2b) on all vehicles \\nin Categories O2, O3 and O4. \\nA maximum of three optional Category 5 or one optional Category 6 device per \\nside on vehicles of Category O2 exceeding 9m in length. \\nWhere an AFS is fitted, the distance to be considered for the choice of the \\nCategory is the distance between the front direction-indicator lamp and the \\nclosest lighting unit performing a dipped-beam mode. \\n5.5.3.3 \\nIn addition, the following vehicles, if there are three or more side-marker lamps \\nfor motor vehicles, when these lamps flash in conjunction with direction \\nindicators on the same side at the same time, above requirement does not \\napply. \\n-- \\nOne optional Category 5 additional lamp on vehicles in Categories M2, M3, \\nN2 and N3 exceeding 6m and not exceeding 9m in length; \\n-- \\nThree mandatory Category 5 additional lamps per side on vehicles in \\nCategories M2, M3, N2 and N3 exceeding 9m, and arranged as evenly as \\npossible on each side; \\n-- \\nThree mandatory Category 5 additional lamps per side on vehicles in \\nCategories O3 and O4, and arranged as evenly as possible on each side. \\n5.5.4 \\nInstallation position \\n5.5.4.1 \\nIn width: The edge of the apparent surface in the direction of the reference axis \\nfarthest from the median longitudinal plane of the vehicle shall not be more than \\n400mm from the extreme outer edge of the vehicle. This condition shall not \\napply to the optional rear direction-indicator lamps. \\nThe distance between the inner edges of the two apparent surfaces in the \\ndirection of the reference axes shall not be less than 600mm. \\nThis distance may be reduced to 400mm where the overall width of the vehicle \\nis less than 1,300mm. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n50 \\nFor Reference Purposes Only \\n5.5.4.2 \\nHeight above the ground \\n5.5.4.2.1 \\nThe height, above the ground, of the light emitting surface of the side \\ndirection-indicator lamps of Categories 5 or 6 shall not be less than 350mm for \\nvehicles of Categories M1 and N1, and not less than 500mm for all other \\nCategories of vehicles, both measured from the lowest point; and shall be not \\nmore than 1,500mm when measured from the highest point. \\n5.5.4.2.2 \\nThe height of the direction-indicator lamps of Categories 1, 1a, 1b, 2a and 2b, \\nmeasured in accordance with 4.8, shall not be less than 350mm and more than \\n1,500mm. \\n5.5.4.2.3 \\nIf the structure of the vehicle does not permit the aforesaid upper limits to be \\nrespected, and if the optional rear direction-indicator lamps are not installed, \\nthey may be increased to not more than 2,300mm for side direction-indicator \\nlamps of Categories 5 and 6, and to not more than 2,100mm for the \\ndirection-indicator lamps of Categories 1, 1a, 1b, 2a and 2b. \\n5.5.4.2.4 \\nIf optional rear lamps are installed, they shall be placed at a height, as large as \\npossible, compatible with the requirements for the position in width (5.5.4.1), the \\nsymmetry of the lamps and the shape of the bodywork; however, the vertical \\ndistance from the mandatory lamps shall be not less than 600mm. \\n5.5.4.3 \\nIn length: See Figure 2 a). \\nThe distance between the light emitting surface of the side direction-indicator \\nlamp (Categories 5 and 6) and the transverse plane which marks the forward \\nboundary of the vehicle's overall length, shall not more than 1,800mm. However, \\nfor Categories M1 and N1 vehicles, this distance can be increased to 2,500mm. \\nFor other categories of vehicles, if the structure of the vehicle type makes it \\nimpossible to comply with the minimum angles of geometric visibility, this \\ndistance can also be increased to 2,500mm. \\nOptional Category 5 side direction indicator lamps, shall be fitted, spaced evenly, \\nalong the length of the vehicle. \\nOptional Category 6 side direction indicator lamp shall be fitted in the area \\nbetween the first and last quartiles of the length of a trailer. \\n5.5.5 \\nGeometric visibility \\n5.5.5.1 \\nFor horizontal angles: See Layout A and Layout B in Figures 2 a). \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n51 \\nFor Reference Purposes Only \\nVertical angles: 15º above and below the horizontal for direction-indicator lamps \\nof Categories 1, 1a, 1b, 2a, 2b and 5. \\nThe vertical angle below the horizontal may be reduced from 15º to 5º if the \\nlamps are less than 750mm ground clearance (see measurement method as per \\n4.8.a). \\nThe vertical angle above the horizontal may be reduced from 15º to 5º if the \\noptional lamps are not less than 2,100mm ground clearance (see measurement \\nmethod as per 4.8.a). \\nFor direction-indicator lamps of Category 6: 30º above and 5º below the \\nhorizontal. \\n5.5.5.2 \\nOr, at the request of the manufacturer, for Categories M1 and N1 vehicles: The \\ngeometric visibility for the front and rear direction indicator lamps, as well as \\nside-marker lamps \\n-- \\nHorizontal angles: See Figure 2 b). For direction-indicator lamp of \\nCategories 1, 1a, 1b, 2a and 2b of which ground clearance is not more than \\n750mm (see measurement method as per 4.8.a), the angle of inner \\ngeometric visibility below H plane can be reduced from 45º to 20º. \\n-- \\nVertical angles: 15º above and below the horizontal. The downward angle \\nof geometric visibility may be reduced from 15º to 5º if the lamps are less \\nthan 750mm ground clearance (see measurement method as per 4.8.1). \\n-- \\nTo be considered visible, in addition to the Category 5 and Category 6 side \\ndirection-indicator lamps, other lamps shall provide an unobstructed view of \\nthe apparent surface of at least 12.5cm2 (except the illuminating surface \\narea of any retro-reflector that does not transmit light). This requirement \\ndoes not apply to the lamps in compliance with the provisions of 4.29. \\n5.5.6 \\nOrientation: According to the specifications for installation by the manufacturer. \\n5.5.7 \\nElectrical connections \\nDirection-indicator lamps shall switch on independently of the other lamps. All \\ndirection-indicator lamps on one side of a vehicle shall be simultaneously \\nswitched on and off by means of one control and shall flash in phase. \\nOn M1 and N1 vehicles less than 6m in length, with an arrangement complying \\nwith 5.5.5.2 above, the amber side-marker lamps (when mounted) shall flash at \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n52 \\nFor Reference Purposes Only \\nthe same frequency as that of the direction-indicator lamps. \\n5.5.8 \\nTell-tale \\nOperating tell-tale mandatory for direction-indicator lamps of Categories 1, 1a, \\n1b, 2a and 2b. It can be indicator light (visual) or sounder (auditory), or both. If it \\nis an indicator light, it shall be flashing, and, at least in the event of the \\nmalfunction of any of these direction-indicator lamps, shall be either \\nextinguished or remain alight without flashing or show a marked change of \\nfrequency. If it is a sounder, it shall be clearly audible and shall show a marked \\nchange of frequency, at least in the event of the malfunction. \\nMalfunction alarm conditions of tell-tale shall be in compliance with stipulations \\nof GB 17509. \\nIf a motor vehicle is equipped to draw a trailer, it shall be fitted with a special \\nvisual operational tell-tale for the direction-indicator lamps on the trailer unless \\nthe tell-tale of the drawing vehicle allows the failure of any one of the \\ndirection-indicator lamps on the vehicle combination thus formed to be detected. \\nFor the optional direction-indicator lamps on motor vehicles and trailers, \\noperating tell-tale shall not be mandatory. \\n5.5.9 \\nOther requirements \\nThe flashing frequency shall be (90±30) times/min. \\nOperation of the light-signal control shall be followed within not more than 1s by \\nthe emission of light and within not more than 1s and 1.5s its first extinction. \\nIf a motor vehicle is equipped to draw a trailer, the control of the \\ndirection-indicator lamps on the drawing vehicle shall also operate the indicator \\nlamps of the trailer. \\nIn the event of failure (other than short-circuit) of one direction-indicator lamp, \\nthe others may continue to operate, but the flashing frequency may be different \\nfrom that prescribed above. \\n5.6 \\nHazard warning signal \\n5.6.1 \\nPresence:  \\nMandatory. The hazard warning signal shall be given by simultaneous operation \\nof the direction-indicator lamps in accordance with the requirements of 5.5 \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n53 \\nFor Reference Purposes Only \\nabove. \\n5.6.2 \\nNumber: \\nAs specified in 5.5.2. \\n5.6.3 \\nArrangement:  \\nAs specified in 5.5.3. \\n5.6.4 \\nInstallation position \\n5.6.4.1 \\nIn width: As specified in 5.5.4.1. \\n5.6.4.2 \\nIn height: As specified in 5.5.4.2. \\n5.6.4.3 \\nIn length: As specified in 5.5.4.3. \\n5.6.5 \\nGeometric visibility:  \\nAs specified in 5.5.5. \\n5.6.6 \\nOrientation:  \\nAs specified in 5.5.6. \\n5.6.7 \\nElectrical connections \\n5.6.7.1 \\nThe hazard warning signal shall be operated by means of a separate manual \\ncontrol enabling all the direction-indicator lamps to flash in phase. \\n5.6.7.2 \\nThe hazard warning signal can be activated automatically in the event of a \\nvehicle being involved in a collision or after the close of the emergency stop \\nsignal, as specified in 5.23 below. In such cases, it can be turned “off” manually. \\nIn addition, the hazard warning signal can be activated automatically to indicate \\nthe possible danger to other road users. At this point, the signal shall be kept \\nopen until it is manually or automatically closed. \\n5.6.7.3 \\nOn M1 and N1 vehicles less than 6m in length, with an arrangement complying \\nwith 5.5.5.2 above, the amber side-marker lamps, when mounted, shall also \\nflash at the same frequency (in phase) with the direction-indicator lamps. \\n5.6.8 \\nTell-tale: Shall be configured with flashing closed-circuit tell-tale. \\n5.6.9 \\nOther requirements: As specified in 5.5.9, if a motor vehicle is equipped to draw \\na trailer the hazard warning signal control shall also be capable of bringing the \\ndirection-indicator lamps on the trailer into action. The hazard warning signal \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n54 \\nFor Reference Purposes Only \\nshall be able to function even if the device which starts or stops the engine is in \\na position which makes it impossible to start the engine. \\n5.7 \\nStop lamp (GB 5920) \\n5.7.1 \\nPresence \\nStop lamps of Categories S1 or S2: mandatory on all Categories of vehicles. \\nStop lamps of Categories S3 or S4: mandatory on Categories M1 and N1 of \\nvehicles (except for chassis-cabs and those Category N1 vehicles with open \\ncargo space) and Multi-purpose goods vehicle Note; optional on other categories \\nof vehicles. \\nNote: Multi-purpose goods vehicle means goods vehicle which features cab-behind-engine body \\nand cab structure, the rated number of passengers less than or equal to 5 (including driver), cab \\nheight less than or equal to 2,100mm，\\nheight of upper end of goods box board from ground less than \\nor equal to 1,500mm and the maximum total design mass less than or equal to 3,500kg. \\n5.7.2 \\nNumber: Two S1 or S2 Category stop lamps and one S3 or S4 Category stop \\nlamp on all categories of vehicles. \\n5.7.2.1 \\nExcept in the case where a Category S3 or S4 stop lamp is installed, two \\noptional Category S1 or S2 stop lamps may be installed on vehicles in \\nCategories M2, M3, N2, N3, O2, O3 and O4. \\n5.7.2.2 \\nWhen the median longitudinal plane of the vehicle is not located on a fixed body \\npanel but separates one or two movable parts of the vehicle (e.g. doors), and \\nlacks sufficient space to install a single stop lamp of the Categories S3 or S4 on \\nthe median longitudinal plane above such movable parts, then two stop lamps of \\nthe Categories S3 or S4 type “D” may be installed; or \\nOne stop lamp of the Categories S3 or S4 may be installed offset to the left or to \\nthe right of the median longitudinal plane, or \\nAn interdependent lamp system of Categories S3 or S4 may be installed. \\n5.7.3 \\nArrangement: No special requirements. \\n5.7.4 \\nInstallation position \\n5.7.4.1 \\nIn width \\nFor Categories M1 and N1 vehicles: For Categories S1 or S2 stop lamps that \\npoint on the apparent surface in the direction of the reference axis which is \\nfarthest from the vehicle's median longitudinal plane shall not be more than \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n55 \\nFor Reference Purposes Only \\n400mm from the extreme outer edge of the vehicle; for the distance in between \\nthe inner edges of the apparent surfaces in the direction of the reference axes, \\nthere is no special requirement. \\nFor all other Categories of vehicles: \\n-- \\nFor Categories S1 or S2 stop lamps the distance in between the inner \\nedges of the apparent surfaces in the direction of the reference axes shall \\nbe not less than 600mm. This distance may be reduced to 400mm if the \\noverall width of the vehicle is less than 1,300mm; \\n-- \\nFor Categories S3 or S4 stop lamps: The center of reference shall be \\nsituated on the median longitudinal plane of the vehicle. However, in the \\ncase where the two stop lamps of the Categories S3 or S4 are installed, \\naccording to 5.7.2, they shall be positioned as close as possible to the \\nmedian longitudinal plane, one on each side of this plane; \\n-- \\nIn the case where one Categories S3 or S4 stop lamp offset from the \\nmedian longitudinal plane is permitted according to 5.7.2, this offset shall \\nnot exceed 150mm from the median longitudinal plane to the center of \\nreference of the lamp. \\n5.7.4.2 \\nIn height \\n5.7.4.2.1 \\nFor Categories S1 or S2 stop lamps \\nThe height above the ground shall be neither less than 350mm nor more than \\n1,500mm. It may be increased to 2,100mm if the shape of the bodywork makes \\nit impossible to keep within 1,500mm and if the optional lamps are not installed. \\nIf the optional lamps are installed, they shall be positioned at a height \\ncompatible with the requirements of the width and the symmetry of the lamps, \\nand at a vertical distance as large as the shape of the bodywork makes it \\npossible, but not less than 600mm above the mandatory lamps. \\n5.7.4.2.2 \\nFor Categories S3 or S4 stop lamps \\nThe horizontal plane tangential to the lower edge of the apparent surface shall: \\neither not be more than 150mm below the horizontal plane tangential to the \\nlower edge of the exposed surface of the glass of the rear window, or not be less \\nthan 850mm above the ground. \\nHowever, the horizontal plane tangential to the lower edge of the apparent \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n56 \\nFor Reference Purposes Only \\nsurface of a Categories S3 or S4 stop lamp shall be above the horizontal plane \\ntangential to the upper edge of the apparent surface of Categories S1 or S2 stop \\nlamps. \\n5.7.4.3 \\nIn length \\nFor Categories S1 or S2 stop lamps: At the rear of the vehicle; \\nFor Categories S3 or S4 stop lamps: At the rear of the vehicle. \\n5.7.5 \\nGeometric visibility \\n5.7.5.1 \\nHorizontal angles \\nFor Categories S1 or S2 stop lamps: 45º to the left and to the right of the \\nlongitudinal axis of the vehicle. \\nHowever, if stop lamps of Categories S1 and S2 are not more than 750mm \\nground clearance (see measurement method as per 4.8.a), the angle of inner \\ngeometric visibility below H plane can be reduced from 45º to 20º. \\nFor Categories S3 or S4 stop lamps: 10º to the left and to the right of the \\nlongitudinal axis of the vehicle. \\n5.7.5.2 \\nVertical angles \\nFor Categories S1 or S2 stop lamps: 15º above and below the horizontal \\nexcept for the following cases: \\n-- \\nThe vertical angle below the horizontal may be reduced from 15º to 5º if the \\nlamps are less than 750mm ground clearance (see measurement method \\nas per 4.8.a); \\n-- \\nThe vertical angle above the horizontal may be reduced from 15º to 5º if the \\noptional lamps are not less than 2,100mm ground clearance (see \\nmeasurement method as per 4.8.a). \\nFor Categories S3 or S4 stop lamps: 10º above and 5º below the horizontal. \\n5.7.6 \\nOrientation:  \\nTowards the rear of the vehicle. \\n5.7.7 \\nElectrical connections \\n5.7.7.1 \\nAll stop lamps shall light up simultaneously when the service braking equipment \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n57 \\nFor Reference Purposes Only \\nin compliance with GB 12676 or GB 21670 is used. \\n5.7.7.2 \\nThe stop lamps need not function if the device which starts and/or stops the \\nengine (propulsion system) is set in a position which makes it impossible for the \\nengine (propulsion system) to operate. \\n5.7.8 \\nTell-tale:  \\nOptional. Where fitted, this tell-tale shall be an operating tell-tale consisting of a \\nnon-flashing warning light which comes on in the event of the malfunctioning of \\nthe stop lamps. \\n5.7.9 \\nOther requirements \\n5.7.9.1 \\nThe Categories S3 or S4 stop lamp may not be reciprocally incorporated with \\nany other lamp. \\n5.7.9.2 \\nThe Categories S3 or S4 stop lamp may be installed outside or inside the \\nvehicle. \\n \\nIn the case where it is installed inside the vehicle, the light emitted shall not \\ncause discomfort to the driver through the rear-view mirrors (devices for indirect \\nvision) or other surfaces of the vehicle (i.e. rear window). \\n5.8 \\nRear registration plate lamp (GB 18408) \\n5.8.1 \\nPresence: Mandatory. \\n5.8.2 \\nNumber: Depending upon the requirements for illuminating the registration \\nplate. \\n5.8.3 \\nArrangement: Depending upon the requirements for illuminating the registration \\nplate. \\n5.8.4 \\nInstallation position: In width, in height and in length, depending upon the \\nrequirements for illuminating the registration plate. \\n5.8.5 \\nGeometric visibility: Depending upon the requirements for illuminating the \\nregistration plate. \\n5.8.6 \\nOrientation: Depending upon the requirements for illuminating the registration \\nplate. \\n5.8.7 \\nElectrical connections:  \\nIn accordance with 4.11. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n58 \\nFor Reference Purposes Only \\n5.8.8 \\nTell-tale:  \\nOptional. If it exists, its function shall be carried out by the tell-tale required for \\nthe front and rear position lamps. \\n5.8.9 \\nOther requirements:  \\nWhen the rear registration plate lamp is combined with the rear position lamp, \\nreciprocally incorporated in the stop lamp or in the rear fog lamp, the \\nphotometric characteristics of the rear registration plate lamp can be modified \\nduring the illumination of the stop lamp or the rear fog lamp. \\n5.9 \\nFront position lamp (GB 5920) \\n5.9.1 \\nPresence: Mandatory on all motor vehicles and on trailers over 1,600mm wide. \\nOptional on trailers which are not more than 1,600mm wide. \\n5.9.2 \\nNumber: Two. \\n5.9.3 \\nArrangement: No special requirements. \\n5.9.4 \\nInstallation position \\n5.9.4.1 \\nThat point on the apparent surface in the direction of the reference axis which is \\nfarthest from the vehicle's median longitudinal plane shall not be more than \\n400mm from the extreme outer edge of the vehicle. \\nIn the case of a trailer, the distance above shall be not more than 150mm. \\nThe distance between the inner edges of the two apparent surfaces in the \\ndirection of the reference axes: for Categories M1 and N1 vehicles: No special \\nrequirement; for all other categories of vehicles: Not less than 600mm. This \\ndistance may be reduced to 400mm where the overall width of the vehicle is less \\nthan 1,300mm. \\n5.9.4.2 \\nIn height: Ground clearance shall be not less than 250mm, not more than \\n1,500mm. It may be increased to 2,100mm for Categories O1 and O2 vehicles, \\nor if for any other Categories of vehicles, the shape of the bodywork makes it \\nimpossible to keep within 1,500mm. \\n5.9.4.3 \\nIn length: No special requirements. \\n5.9.4.4 \\nWhere the front position lamp and another lamp are reciprocally incorporated, \\nthe apparent surface in the direction of the reference axis of the other lamp may \\nbe used to verify compliance with the positioning requirements of paragraphs \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n59 \\nFor Reference Purposes Only \\n5.9.4.1 to 5.9.4.3. \\n5.9.5 \\nGeometric visibility \\n5.9.5.1 \\nHorizontal angles: 45º inwards and 80º outwards. \\nHowever, for lamps are not more than 750mm ground clearance (see \\nmeasurement method as per 4.8.a), the angle of inner geometric visibility below \\nH plane can be reduced from 45º to 20º. \\nIn the case of trailers, the angle inwards may be reduced to 5º. \\nVertical angles: 15º above and below the horizontal. The vertical angle below \\nthe horizontal may be reduced from 15º to 5º in the case of lamps less than \\n750mm ground clearance (see measurement method as per 4.8.a). \\n5.9.5.2 \\nFor Categories M1 and N1 vehicles, as an alternative to 5.9.5.1 above, as per the \\ninstructions of the manufacturer, and only if a front side-marker lamp is installed \\non the vehicle: \\n-- \\nHorizontal angles: 45º outwards to 45º inwards. However, for lamps are not \\nmore than 750mm ground clearance (see measurement method as per \\n4.8.a), the angle of inner geometric visibility below H plane can be reduced \\nfrom 45º to 20º. \\n-- \\nVertical angles: 15º above and below the horizontal. However, the vertical \\nangle below the horizontal may be reduced from 15º to 5º in the case of \\nlamps less than 750mm ground clearance (see measurement method as \\nper 4.8.a). \\nTo be considered visible, the lamp shall provide an unobstructed view of the \\napparent surface of at least 12.5cm2 (except the illuminating surface area of any \\nretro-reflector that does not transmit light). \\n5.9.6 \\nOrientation: Towards the front. \\n5.9.7 \\nElectrical connections: In accordance with 4.11. If a front position lamp is \\nreciprocally incorporated with a direction-indicator, the front position lamp on the \\nrelevant side of the vehicle or the reciprocally incorporated part of it can remain \\nswitched off during the entire period (both ON and OFF cycle) of activation of \\nthe direction-indicator lamp. \\n5.9.8 \\nTell-tale: Circuit-closed tell-tale mandatory. This tell-tale shall be non-flashing \\nand shall not be required if the instrument panel lighting can only be turned on \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n60 \\nFor Reference Purposes Only \\nsimultaneously with the front position lamps. This requirement does not apply \\nwhen light-signalling system operates according to 5.2.7.6.b. \\nSubject to the 4.11.e, can optional a separate circuit-closed tell-tale, and shall \\navoid confusion with the tell-tale of the front position lamps. \\n5.9.9 \\nOther requirements \\n5.9.9.1 \\nIf one or more infrared radiation generator(s) is (are) installed inside the front \\nposition lamp, it (they) is (are) allowed to be activated only when the headlamp \\non the same side of the vehicle is switched on and the vehicle is in forward \\nmotion. In the event that the front position lamp or the headlamp on the same \\nside fails, the infrared radiation generator(s) shall be automatically switched off. \\n5.9.9.2 \\nIn case an AFS providing a bending mode is installed, the front position lamp \\nmay be swiveled together with a lighting unit to which it is reciprocally \\nincorporated. \\n5.10 \\nRear position lamp (GB 5920) \\n5.10.1 \\nPresence: Shall be equipped with rear position lamp. \\n5.10.2 \\nNumber: Two. \\n5.10.2.1 \\nExcept the case where end-outline marker lamps are installed, two optional \\nposition lamps may be installed on all vehicles in Categories M2, M3, N2, N3, O2, \\nO3 and O4. \\n5.10.3 \\nArrangement: No special requirements. \\n5.10.4 \\nInstallation position \\n5.10.4.1 \\nIn width: That point on the apparent surface in the direction of the reference axis \\nwhich is farthest from the vehicle's median longitudinal plane shall not be more \\nthan 400mm from the extreme outer edge of the vehicle. This condition shall not \\napply to the optional rear lamps. \\nThe distance between the inner edges of the two apparent surfaces in the \\ndirection of the reference axes shall: \\n-- \\nFor Categories M1 and N1 vehicles: Have no special requirement; \\n-- \\nFor all other Categories of vehicles: Be not less than 600mm. This distance \\nmay be reduced to 400mm where the overall width of the vehicle is less \\nthan 1,300mm. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n61 \\nFor Reference Purposes Only \\n5.10.4.2 \\nIn height: Above the ground, not less than 350mm nor more than 1,500mm. If \\nthe optional lampls are not installed and the shape of the bodywork makes it \\nimpossible to keep within 1,500mm, it could be no more than 2100mm. If the \\noptional lamps are installed, they shall be placed at a height compatible with the \\napplicable requirements of 5.10.4.1, the symmetry of the lamps, and at a vertical \\ndistance as large as the shape of the bodywork makes it possible, but not less \\nthan 600mm above the mandatory lamps. \\n5.10.4.3 \\nIn length: The rear of the vehicle. \\n5.10.5 \\nGeometric visibility \\n5.10.5.1 \\nHorizontal angles: 45º inwards and 80º outwards. \\nHowever, for lamps are not more than 750mm ground clearance (see \\nmeasurement method as per 4.8.a), the angle of inner geometric visibility below \\nH plane can be reduced from 45º to 20º. \\nVertical \\nangles: \\n15º \\nabove \\nand \\nbelow \\nthe \\nhorizontal \\nexcept for the following cases: \\n-- \\nThe vertical angle below the horizontal may be reduced from 15º to 5º if the \\nlamps are less than 750mm ground clearance (see measurement method \\nas per 4.8.a); \\n-- \\nThe vertical angle above the horizontal may be reduced from 15º to 5º if the \\noptional lamps are not less than 2,100mm ground clearance (see \\nmeasurement method as per 4.8.a). \\n5.10.5.2 \\nFor Categories M1 and N1 vehicles, as an alternative to 5.10.5.1 above, as per \\nthe instructions of the manufacturer, and only if a rear side-marker lamp is \\ninstalled on the vehicle: \\n-- \\nHorizontal angle: 45º inwards and 45º outwards. However, for lamps are \\nnot more than 750mm ground clearance (see measurement method as per \\n4.8.a), the angle of inner geometric visibility below H plane can be reduced \\nfrom 45º to 20º. \\n-- \\nVertical angles: 15º above and below the horizontal. However, the vertical \\nangle below the horizontal may be reduced from 15º to 5º in the case of \\nlamps less than 750mm ground clearance (see measurement method as \\nper 4.8.a). \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n62 \\nFor Reference Purposes Only \\nTo be considered visible, the lamp shall provide an unobstructed view of the \\napparent surface of at least 12.5cm2 (except the illuminating surface area of any \\nretro-reflector that does not transmit light). This condition shall not apply to the \\nlamps in accordance with the provisions of 4.29. \\n5.10.6 \\nOrientation: Towards the rear of the vehicle. \\n5.10.7 \\nElectrical connections: In accordance with 4.11. However, if a rear position lamp \\nis reciprocally incorporated with a direction-indicator, the rear position lamp on \\nthe relevant side of the vehicle or the reciprocally incorporated part of it can \\nremain switched OFF during the entire period (both ON and OFF cycle) of \\nactivation of the direction-indicator lamp. \\n5.10.8 \\nTell-tale: Circuit-closed tell-tale mandatory. It shall be performed by the tell-tale \\nof the front position lamps. \\nThis requirement does not apply when light-signalling system operates \\naccording to 5.2.7.6.b. \\nSubject to the 4.11.1.e, can optional a separate circuit-closed tell-tale, and shall \\navoid confusion with the tell-tale of the rear position lamps. \\n5.10.9 \\nOther requirements: None. \\n5.11 \\nRear fog lamp (GB 11554) \\n5.11.1 \\nPresence: Shall be equipped. \\n5.11.2 \\nNumber: One or two. \\n5.11.3 \\nArrangement: No special requirements. \\n5.11.4 \\nInstallation position \\n5.11.4.1 \\nIn width: If there is only one rear fog-lamp, it shall be on the left side relative to \\nthe forward motion of the vehicle, or its center of reference shall be situated on \\nthe median longitudinal plane of the vehicle. \\n5.11.4.2 \\nIn height: Not less than 250mm not more than 1,000mm above the ground. For \\nrear fog lamps grouped with any rear lamp or for Category N3G (off-road) \\nvehicles, the maximum height may be increased to 1,200mm. \\n5.11.4.3 \\nIn length: At the rear of the vehicle. \\n5.11.5 \\nGeometric visibility: Defined by angles α and β as specified in 3.15. Angle α: 5º \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n63 \\nFor Reference Purposes Only \\nupwards and 5º downwards; angle β: 25º to right and to left. \\n5.11.6 \\nOrientation: Towards the rear of the vehicle. \\n5.11.7 \\nElectrical connections \\n5.11.7.1 \\nThe rear fog-lamp(s) cannot be switched on unless the main-beams, \\ndipped-beams or front fog-lamps are lit. \\n5.11.7.2 \\nThe rear fog-lamp(s) can be switched off independently of any other lamp. \\n5.11.7.3 \\nEither of the following applies: \\n-- \\nThe rear fog lamp(s) may continue to operate until the position lamps are \\nswitched off, and the rear fog lamp(s) shall then remain off until deliberately \\nswitched on again. \\n-- \\nAt least an audible warning device, additional to the mandatory tell-tale \\n(5.11.8), shall be fitted, which shall give warning signals, if the ignition is \\nswitched off or the ignition key is withdrawn and the driver's door is opened, \\nwhether the lamps in 5.11.7.1 are on or off, whilst the rear fog lamp switch \\nis in the “on” position. \\n5.11.7.4 \\nExcept as provided in 5.11.7.1, 5.11.7.3 and 5.11.7.5 above, the operation of the \\nrear fog lamp(s) shall not be affected by switching on or off any other lamps. \\n5.11.7.5 \\nThe rear fog lamp of a traction motor vehicle can be automatically switched off \\nwhile a trailer is connected and the rear fog lamp of the trailer is activated. \\n5.11.8 \\nTell-tale: Circuit-closed tell-tale shall be mandatory. Such tell-tale is an \\nindependent non-flashing warning light. \\n5.11.9 \\nOther requirements: In the case of simultaneously lit, the distance between the \\nrear fog lamp and each stop lamp shall be more than 100mm. \\n5.12 \\nParking lamp (GB 18409) \\n5.12.1 \\nPresence: On motor vehicles not more than 6m in length and not more than 2m \\nin width, optional. On all other vehicles, prohibited. \\n5.12.2 \\nNumber: According to the arrangement. \\n5.12.3 \\nArrangement: Either two lamps at the front and two lamps at the rear, or one \\nlamp on each side. \\n5.12.4 \\nInstallation position \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n64 \\nFor Reference Purposes Only \\n5.12.4.1 \\nIn width: That point on the apparent surface in the direction of the reference axis \\nwhich is farthest from the vehicle's median longitudinal plane shall not be more \\nthan 400mm from the extreme outer edge of the vehicle. \\nIf there are two lamps, they shall be on the sides of the vehicle. \\n5.12.4.2 \\nIn height: For Categories M1 and N1 vehicles: No special requirement. \\nFor all other Categories of vehicles: Above the ground, not less than 350mm not \\nmore than 1,500mm. It might be no more than 2,100mm if the shape of the \\nbodywork makes it impossible to keep within 1,500mm. \\n5.12.4.3 \\nIn length: No special requirements. \\n5.12.5 \\nGeometric visibility \\nHorizontal angles: 45º outwards, forwards and rearwards. \\nHowever, for lamps are not more than 750mm ground clearance (see \\nmeasurement method as per 4.8.a), the angle of inner geometric visibility below \\nH plane can be reduced from 45º to 20º. \\nVertical angles: Vertical angle: 15º above and below the horizontal. \\nThe vertical angle below the horizontal may be reduced from 15º to 5º in the \\ncase of lamps less than 750mm ground clearance (see measurement method \\nas per 4.8.a). \\n5.12.6 \\nOrientation: Such that the lamps meet the requirements for visibility forwards \\nand rearwards. \\n5.12.7 \\nElectrical connections: The parking lamp(s) on the same side of the vehicle shall \\nbe lit independently of any other lamps. The parking lamp(s) and, if applicable, \\nthe front and rear position lamps according to 5.12.9 below, shall be able to \\noperate even if the device which starts the engine (propulsion system) is in a \\nposition which makes it impossible for the engine (propulsion system) to operate. \\nA device which automatically deactivates these lamps (e.g., as a function of time) \\nis prohibited. \\n5.12.8 \\nTell-tale: Circuit-closed Optional. If there is one, it shall not be possible to \\nconfuse it with the tell-tale for the front and rear position lamps. \\n5.12.9 \\nOther requirements: The functioning of this lamp may be performed by \\nsimultaneously switching on the front and rear position lamps on the same side \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n65 \\nFor Reference Purposes Only \\nof the vehicle. In this case, lamps that meet the requirements of front or rear \\nposition lamps are deemed to meet the requirements of parking lamps. \\n5.13 \\nEnd-outline marker lamp (GB 5920) \\n5.13.1 \\nPresence: Mandatory on vehicles more than 2.10m in width. Optional on \\nvehicles between 1.80m and 2.10m in width. On chassis with cab, the rear \\nend-outline marker lamps are optional. \\n5.13.2 \\nNumber: Two to the front and two to the rear. Two end-outline marker lamps \\nvisible from the front and two ones visible from the rear may be optionally fitted \\nagain. \\n5.13.3 \\nArrangement: No special requirements. \\n5.13.4 \\nInstallation position \\n5.13.4.1 \\nIn width \\nFront and rear: As close as possible to the extreme outer edge of the vehicle. \\nThis condition is deemed to have been met when the point on the apparent \\nsurface in the direction of the reference axis which is farthest from the vehicle's \\nmedian longitudinal plane is not more than 400mm from the extreme outer edge \\nof the vehicle. \\n5.13.4.2 \\nIn height \\nFront: For motor vehicles, the horizontal plane tangential to the upper edge of \\nthe apparent surface in the direction of the reference axis shall not be lower than \\nthe horizontal plane tangential to the upper edge of the transparent zone of the \\nwind-screen. \\nFor trailers and semi-trailers, at the maximum height compatible with the \\nrequirements relating to the width, design and operational requirements of the \\nvehicle and to the symmetry of the lamps. \\nRear: At the maximum height compatible with the requirements relating to the \\nwidth, design and operational requirements of the vehicle and to the symmetry \\nof the lamps. \\nBoth optional and mandatory (as applicable) lamps to be fitted at a proper height \\nand as far longitudinally separated as practicable and compatible with \\ndesign/operational requirements of the vehicle and symmetry of the lamps. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n66 \\nFor Reference Purposes Only \\n5.13.4.3 \\nln length: No special requirements. The optional front end-outline marker lamps \\nas specified in 5.13.4.2 shall be installed on vehicle as close as practicable to \\nrear. The distance between the additional lamps and rear of vehicle shall not \\nmore than 400mm. \\n5.13.5 \\nGeometric visibility \\nHorizontal angles: 80º outwards. \\nVertical angles: 5º above and 20º below the horizontal. \\n5.13.6 \\nOrientation: Such that the lamps meet the requirements for visibility forwards \\nand rearwards. \\n5.13.7 \\nElectrical connections: In accordance with 4.11. \\n5.13.8 \\nTell-tale: Optional. If it exists, its function shall be carried out by the tell-tale \\nrequired for the front and rear position lamps. \\n5.13.9 \\nOther requirements \\nProvided that all other requirements are met, the front end-outline marker lamps \\nand the (mandatory or optional) rear end-outline marker lamps on the same side \\nof the vehicle can be combined into one device. \\nTwo of the rear end-outline marker lamps can be grouped, combined or \\nreciprocally incorporated in accordance with 4.7. \\nThe position of an end-outline marker lamp in relation to corresponding posit ion \\nlamp shall be such that the distance between the projections on a transverse \\nvertical plane of the points nearest to one another on the apparent surfaces in \\nthe direction of the respective reference axes of the two lamps considered is not \\nless than 200mm. \\n5.14 \\nRear retro-reflector, non-triangular (GB 11564) \\n5.14.1 \\nPresence: Mandatory on motor vehicles. Provided that they are grouped \\ntogether with the other rear light-signalling devices, optional on trailers. \\n5.14.2 \\nNumber: Two. The performances of which shall conform to the requirements \\nconcerning Class IA or Class IB retro-reflectors. Additional retro-reflecting \\ndevices and materials are permitted provided they do not impair the \\neffectiveness of the mandatory lighting and light-signalling devices. \\n5.14.3 \\nArrangement: No special requirements. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n67 \\nFor Reference Purposes Only \\n5.14.4 \\nInstallation position \\n5.14.4.1 \\nIn width: That point on the illuminating surface which is farthest from the \\nvehicle's median longitudinal plane shall not be more than 400mm from the \\nextreme outer edge of the vehicle. \\nThe distance between the inner edges of the two apparent surfaces in the \\ndirection of the reference axes: \\nFor Categories M1 and N1 vehicles: No special requirement; \\nFor all other Categories of vehicles: Not less than 600mm. This distance may be \\nreduced to not less than 400mm where the overall width of the vehicle is less \\nthan 1,300mm. \\n5.14.4.2 \\nIn height: Above the ground, not less than 250mm not more than 900mm. It may \\nbe no more than 1,200mm if grouped with any rear lamp(s). It may be no more \\nthan to 1,500mm if the shape of the bodywork makes it impossible to keep \\nwithin 900mm or 1,200mm respectively. \\n5.14.4.3 \\nIn length: At the rear of the vehicle. \\n5.14.5 \\nGeometric visibility \\nHorizontal angles: 30º inwards and outwards. \\nVertical angles: 10º above and below the horizontal. The vertical angle below \\nthe horizontal may be reduced from 10º to 5º in the case of retro-reflectors less \\nthan 750mm ground clearance (see measurement method as per 4.8.a). \\n5.14.6 \\nOrientation: Rearwards. \\n5.14.7 \\nOther requirements: The illuminating surface of the retro-reflector may have \\nparts in common with the apparent surface of any other lamp situated at the \\nrear. \\n5.15 \\nRear retro-reflector, triangular (GB 11564) \\n5.15.1 \\nPresence: Mandatory on trailers. Prohibited on motor vehicles. \\n5.15.2 \\nNumber: Two. The performances of which shall conform to the requirements \\nconcerning Class IIIA or Class IIIB retro-reflectors. Additional retro-reflecting \\ndevices and materials (including two retro-reflectors not complying with 5.15.4 \\nbelow), are permitted provided they do not impair the effectiveness of the \\nmandatory lighting and light-signalling devices. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n68 \\nFor Reference Purposes Only \\n5.15.3 \\nArrangement: The apex of the triangle shall be directed upwards. \\n5.15.4 \\nInstallation position \\n5.15.4.1 \\nIn width: That point on the illuminating surface which is farthest from the \\nvehicle's median longitudinal plane shall not be more than 400mm from the \\nextreme outer edge of the vehicle. \\nThe inner edges of the retro-reflectors shall not be less than 600mm apart. This \\ndistance may be reduced to not less than 400mm if the overall width of the \\nvehicle is less than 1,300mm. \\n5.15.4.2 \\nIn height: Above the ground, not less than 250mm not more than 900mm. It may \\nbe no more than 1,200mm if grouped with any rear lamp(s). It may be no more \\nthan 1,500mm if the shape of the bodywork makes it impossible to keep within \\n900mm or 1,200mm respectively. \\n5.15.4.3 \\nIn length: At the rear of the vehicle. \\n5.15.5 \\nGeometric visibility \\nHorizontal angles: 30º inwards and outwards. \\nVertical angles: 15º above and below the horizontal. The vertical angle below \\nthe horizontal may be reduced from 15º to 5º in the case of retro-reflectors less \\nthan 750mm ground clearance (see measurement method as per 4.8.a). \\n5.15.6 \\nOrientation: Rearwards. \\n5.15.7 \\nOther requirements: The illuminating surface of the retro-reflector may have \\nparts in common with the apparent surface of any other lamp situated at the \\nrear. \\n5.16 \\nFront retro-reflector, non-triangular (GB 11564) \\n5.16.1 \\nPresence: Mandatory on trailers and on motor vehicles having all forward facing \\nlamps with concealable. Optional on other motor vehicles. \\n5.16.2 \\nNumber: Two. The performances of which shall conform to the requirements \\nconcerning Class IA or IB retro-reflectors. Additional retro-reflecting devices and \\nmaterials (including two retro-reflectors not complying with 5.16.4 below), are \\npermitted provided they do not impair the effectiveness of the mandatory lighting \\nand light-signalling devices. \\n5.16.3 \\nArrangement: No special requirements. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n69 \\nFor Reference Purposes Only \\n5.16.4 \\nInstallation position \\n5.16.4.1 \\nIn width: That point on the illuminating surface which is farthest from the \\nvehicle's median longitudinal plane shall not be more than 400mm from the \\nextreme outer edge of the vehicle. In the case of a trailer, the distance shall be \\nnot more than 150mm. \\nThe distance between the inner edges of the two apparent surfaces in the \\ndirection of the reference axes: \\n-- \\nFor Categories M1 and N1 vehicles: No special requirement; \\n-- \\nFor all other Categories of vehicles: be not less than 600mm. This distance \\nmay be reduced to 400mm where the overall width of the vehicle is less \\nthan 1,300mm. \\n5.16.4.2 \\nIn height: Above the ground, not less than 250mm not more than 900mm. It may \\nbe increased to 1,500mm if the shape of the bodywork makes it impossible to \\nkeep within 900mm. \\n5.16.4.3 \\nIn length: At the front of the vehicle. \\n5.16.5 \\nGeometric visibility \\nHorizontal angles: 30º inwards and outwards. In the case of trailers, the angle \\ninwards may be reduced to 10º. If, because of the construction of the trailers, \\nthis angle cannot be met by the mandatory retro-reflectors, then additional \\n(supplementary) retro-reflectors shall be fitted, without the width limitation \\n(paragraph 5.16.4.1 above), which shall, in conjunction with the mandatory \\nretro-reflectors, give the necessary visibility angle. \\nVertical angles: 10º above and below the horizontal. The vert ical angle below \\nthe horizontal may be reduced from 10º to 5º in the case of retro-reflectors less \\nthan 750mm ground clearance (see measurement method as per 4.8.a). \\n5.16.6 \\nOrientation: Towards the front. \\n5.16.7 \\nOther requirements: The illuminating surface of the retro-reflector may have \\nparts in common with the apparent surface of any other lamp situated at the \\nfront. \\n5.17 \\nSide retro-reflector, non-triangular (GB 11564) \\n5.17.1 \\nPresence: Mandatory on all motor vehicles with the length of which more than \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n70 \\nFor Reference Purposes Only \\n6m and on all trailers. Optional on motor vehicles with the length of which does \\nnot more than 6m. \\n5.17.2 \\nNumber: Such that the requirements for longitudinal positioning are complied \\nwith. The performances of these devices shall conform to the requirements \\nconcerning Class IA or IB retro-reflectors. Additional retro-reflecting devices and \\nmaterials (including two retro-reflectors not complying with 5.17.4 below), are \\npermitted provided they do not impair the effectiveness of the mandatory lighting \\nand light-signalling devices. \\n5.17.3 \\nArrangement: No special requirements. \\n5.17.4 \\nInstallation position \\n5.17.4.1 \\nIn width: No special requirements. \\n5.17.4.2 \\nIn height: Above the ground, not less than 250mm not more than 900mm. It may \\nbe increased to 1,200mm if grouped with any lamp(s). It may be increased to \\n1,500mm if the shape of the bodywork makes it impossible to keep within \\n900mm or 1,200mm respectively or if the presence of the device is not \\nmandatory according to 5.17.1. \\n5.17.4.3 \\nIn length: At least one side retro-reflector shall be fitted to the middle third of the \\nvehicle, the foremost side retro-reflector being not further than 3m from the front. \\nThe distance between two adjacent side retro-reflectors shall not exceed 3m. \\nThis does not apply to Categories M1 and N1 vehicles. \\nIf the structure, design or the operational use of the vehicle makes it impossible \\nto comply with such a requirement, this distance may be increased to 4m. The \\ndistance between the rearmost side retro-reflector and the rear of the vehicle \\nshall not exceed 1m. However, for motor vehicles the length of which does not \\nexceed 6m, it is sufficient to have one side retro-reflector fitted within the first \\nthird and/or one within the last third of the vehicle length. \\nFor M1 vehicles the length of which exceeds 6m but does not exceed 7m, it is \\nsufficient to have one side retro-reflector fitted not further than 3m from the front \\nand one within the last third of the vehicle length. \\n5.17.5 \\nGeometric visibility \\nHorizontal angles: 45º to the front and to the rear. \\nVertical angle: 10º above and below the horizontal plane. The vertical angle \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n71 \\nFor Reference Purposes Only \\nbelow the horizontal plane can be reduced to 5º in the case of a retro-reflector \\nless than 750mm ground clearance (see measurement method as per 4.8.a). \\n5.17.6 \\nOrientation: Towards the side. \\n5.17.7 \\nOther requirements: The illuminating surface of the side retro-reflector may have \\nparts in common with the apparent surface of any other side lamp. \\n5.18 \\nSide-marker lamps (GB 18099) \\n5.18.1 \\nPresence: Mandatory on vehicles with the length of which more than 6m, except \\nfor chassis with cab. \\nThe SM1 type of side-marker lamp shall be used on all Categories of vehicles; \\nhowever the SM2 type of side-marker lamps may be used on the Category M1 \\nvehicles. \\nIn addition, on Categories M1 and N1 vehicles less than 6m in length, \\nside-marker lamps shall be used, if they supplement the reduced geometric \\nvisibility requirements of front position lamps conforming to 5.9.5.2 and rear \\nposition lamps conforming to 5.10.5.2 respectively. \\nOn other categories of vehicles, the installation of side marker lamps of \\nCategories SM1 or SM2 is optional. \\n5.18.2 \\nMinimum number per side: Such that the rules for longitudinal positioning are \\ncomplied with. \\n5.18.3 \\nArrangement: No special requirements. \\n5.18.4 \\nInstallation position \\n5.18.4.1 \\nIn width: No special requirements. \\n5.18.4.2 \\nIn height: Above the ground, not less than 250mm not more than 1,500mm. It \\nmay be not more than 2,100mm if the shape of the bodywork makes it \\nimpossible to keep within 1,500mm. \\n5.18.4.3 \\nIn length: At least one side-marker lamp shall be fitted to the middle third of the \\nvehicle, the foremost side-marker lamp being not further than 3m from the front. \\nThe distance between two adjacent side-marker lamps shall not exceed 3m. If \\nthe structure, design or the operational use of the vehicle makes it impossible to \\ncomply with such a requirement, this distance may be increased to 4m. \\nThe distance between the rearmost side-marker lamp and the rear of the vehicle \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n72 \\nFor Reference Purposes Only \\nshall not exceed 1m. \\nHowever, for vehicles the length of which does not exceed 6m and for \\nchassis-cabs, it is sufficient to have one side-marker lamp fitted within the first \\nthird and/or within the last third of the vehicle length. For M1 vehicles the length \\nof which exceeds 6m but does not exceed 7m, it is sufficient to have one \\nside-marker lamp fitted not further than 3m from the front and one within the last \\nthird of the vehicle length. \\n5.18.5 \\nGeometric visibility \\nHorizontal angles: 45º to the front and to the rear; for vehicles on which the \\ninstallation of the side-marker lamps is optional, this value can be reduced to \\n30º. \\nIf the vehicle is equipped with side-marker lamps used to supplement the \\nreduced geometric visibility of front & rear direction indicator lamps and/or front \\n& rear position lamps conforming to respective provisions (paragraphs 5.5.5.2, \\n5.9.5.2 and 5.10.5.2), the angles are 45º towards the front and rear ends of the \\nvehicle and 30º towards the center of the vehicle. \\nVertical angles: 10º above and below the horizontal. The vertical angle below \\nthe horizontal may be reduced from 10º to 5º in the case of lamps less than \\n750mm ground clearance (see measurement method as per 4.8.a). \\n5.18.6 \\nOrientation: Towards the side. \\n5.18.7 \\nElectrical connections: On vehicles of Categories M1 and N1 less than 6m in \\nlength, amber side-marker lamps may be wired to flash, provided that this \\nflashing is in phase and at the same frequency with the direction-indicator lamps \\nat the same side of the vehicle. For vehicles of Categories M2, M3, N2, N3, O3 \\nand O4, mandatory amber side-marker lamps may be wired to flash, provided \\nthat this flashing is in phase and at the same frequency with the \\ndirection-indicator lamps at the same side of the vehicle. However, according to \\n5.5.3.3, if Category 5 side direction-indicator lamps are installed on the side of \\nthe vehicle, then these side-marker lamps shall not flash. For all other \\nCategories of vehicles: No special requirement. \\n5.18.8 \\nTell-tale: Optional. If it exists, its function shall be carried out by the tell-tale \\nrequired for the front and rear position lamps. \\n5.18.9 \\nOther requirements: When the rearmost side marker lamp is combined with the \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n73 \\nFor Reference Purposes Only \\nrear position lamp, reciprocally incorporated with the rear fog lamp or stop lamp, \\nthe photometric characteristics of the side marker lamp can be modified during \\nthe illumination of the rear fog lamp or stop lamp. \\nRear side-marker lamps shall be amber if they flash with the rear \\ndirection-indicator lamp. \\n5.19 \\nDaytime running lamp (GB 23255) \\n5.19.1 \\nPresence: Optional on motor vehicles, and and prohibited on trailers. \\n5.19.2 \\nNumber: Two. \\n5.19.3 \\nArrangement: No special requirements. \\n5.19.4 \\nInstallation position \\n5.19.4.1 \\nIn width: The distance between the inner edges of the apparent surfaces in the \\ndirection of the reference axes shall not be less than 600mm. This distance may \\nbe not less than 400mm where the overall width of the vehicle is less than \\n1,300mm. \\n5.19.4.2 \\nIn height: Above the ground not less than 250mm not more than 1,500mm. \\n5.19.4.3 \\nIn length: At the front of the vehicle. This requirement shall be deemed to be \\nsatisfied if the light emitted does not cause discomfort to the driver either directly \\nor indirectly through the rear-view mirrors (devices for indirect vision) and/or \\nother reflecting surfaces of the vehicle. \\n5.19.5 \\nGeometric visibility \\nHorizontal angles: Outwards 20º and inwards 20º. \\nVertical angles: Upwards 10º and downwards 10º. \\n5.19.6 \\nOrientation: Towards the front. \\n5.19.7 \\nElectrical connections \\n5.19.7.1 \\nThe daytime running lamps shall be switched ON automatically when the device \\nwhich starts and/or stops the engine (propulsion system) is set in a position \\nwhich makes it possible for the engine (propulsion system) to operate. However, \\nthe daytime running lamps shall be allowed to remain OFF while the following \\nconditions exist: \\n-- \\nThe automatic transmission control is in the park position; or \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n74 \\nFor Reference Purposes Only \\n-- \\nThe parking brake is in the applied position; or \\n-- \\nPrior to the vehicle being set in motion for the first time after each manual \\nactivation of the propulsion system. \\n5.19.7.2 \\nWhere vehicle speed is less than 10km/h, it is allowed to switch off daytime \\nrunning lamp manually, in this case, where vehicle speed is more than 10km/h \\nor vehicle has run for exceed 100m and maintains running condition, daytime \\nrunning lamp shall switch on automatically until switching off again. \\n5.19.7.3 \\nThe daytime running lamp shall switch OFF automatically when the device \\nwhich starts and/or stops the engine (propulsion system) is set in a position \\nwhich makes it impossible for the engine (propulsion system) to operate or the \\nfront fog lamps or headlamps are switched ON (except the case when it is used \\nto give intermittent warnings). \\n5.19.7.4 \\nThe lamps referred to in 4.11 may be switched ON when the daytime running \\nlamps are switched ON, except if daytime running lamps are operating \\naccording to 5.2.7.6.b, where at least the rear position lamps shall be activated. \\n5.19.7.5 \\nIf the distance between the front direction-indicator lamp and the daytime \\nrunning lamp is not more than 40mm, the daytime running lamp on the relevant \\nside of the vehicle may be such that either: \\n-- \\nIt is switched OFF; or \\n-- \\nDuring the entire period (both ON and OFF cycle) of activation of the \\ndirection-indicator lamp, its luminous intensity is reduced. \\n5.19.7.6 \\nIf a direction-indicator lamp is reciprocally incorporated with a daytime running \\nlamp, during the entire period (both ON and OFF cycle) of activation of the \\ndirection-indicator lamp, the daytime running lamp on the same side shall at \\nleast switch OFF the reciprocally incorporated part of the direction-indicator \\nlamp during the operation of the direction-indicator lamp. \\n5.19.8 \\nTell-tale: Closed-circuit Optional. \\n5.19.9 \\nOther requirements: None. \\n5.20 \\nCornering lamp (GB/T 30511) \\n5.20.1 \\nEquipment: Optional for motor vehicle. \\n5.20.2 \\nNumber: Two. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n75 \\nFor Reference Purposes Only \\n5.20.3 \\nArrangement: No special requirements. \\n5.20.4 \\nInstallation position \\n5.20.4.1 \\nIn width: Two cornering lamps are respectively installed on two sides of \\nlongitudinal symmetry plane of vehicle. \\n5.20.4.2 \\nIn length: Shall be not exceed 1,000mm from front part of vehicle. \\n5.20.4.3 \\nIn height \\nMinimum value: Not less than 250mm ground clearance. \\nMaximum value: Not more than 900mm ground clearance. \\nThe entire apparent surface shall be below the highest point on apparent \\nsurface of dipped-beam headlamp in the direction of reference axis. \\n5.20.5 \\nGeometric visibility \\nAngle α: 10º upwards and downwards; \\nAngle β: 30º to 60º outwards. \\n5.20.6 \\nDirection: Shall meet requirements on geometric visibility. \\n5.20.7 \\nElectrical connections:  \\n5.20.7.1 \\nCornering lamps can only be switched on if main-beam headlamp or \\ndipped-beam headlamp is switched on. \\n5.20.7.2 \\nCornering lamp on one side of vehicle can only automatically switch on if \\ndirection-indicator lamp on the same side of vehicle is switched on and/or \\nturning angle of steering wheel turns to the same side. After direction-indicator \\nlamp is switched off and/or turning angle resumes straight running, cornering \\nlamp shall switch off automatically. \\n5.20.7.3 \\nWhen the reversing lamp is switched on, the two cornering lamps can be \\nindependent from the steering wheel or the direction-indicator lamp, and \\nswitched on simultaneously, the cornering lamp shall be switched off when the \\nreversing lamp is switched off or when the vehicle moves forward faster than \\n10km/h. \\n5.20.8 \\nTell-tale: None. \\n5.20.9 \\nOther requirements: Where vehicle speed exceeds 40km/h, cornering lamp \\nshall not be switched on. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n76 \\nFor Reference Purposes Only \\n5.21 \\nConspicuity markings \\nInstallation of reflecting marking on motor vehicle and trailer body shall meet the \\nrelevant requirements of GB 23254. \\nInstallation of rear-marking plates for vehicles and their trailers shall meet the \\nrelevant requirements of GB 25990. \\n5.22 \\nAdaptive front lighting system (AFS) (GB/T 30036-2013) \\n5.22.1 \\nPresence: Optional for motor vehicle and prohibited for trailer. \\n5.22.2 \\nNumber: 1 set. \\n5.22.3 \\nArrangement: No special requirements. \\n5.22.4 \\nPosition: During the following test, AFS shall be set at neutral state. \\n5.22.4.1 \\nIn width and height: As per description by manufacturer, those lighting units that \\nare switched on simultaneously as per specific lighting function or function mode \\nrequirements shall be in compliance with below stipulations. All measurements \\nshall be determined as per the nearest edge of light ing unit apparent surface in \\nthe direction of reference axis. \\na) Height of two lighting units installed symmetrically shall meet requirements of \\n5.1.4 and 5.2.4. “Lighting units installed symmetrically” means two light ing units \\ninstalled respectively on each side of vehicle, (geometrical) centers of gravity or \\ncenters of their apparent surface shall be located at the same height, and \\ndistance from longitudinal symmetry plane of vehicle shall be identical, and error \\nat single side shall be within scope of 50mm. Its light emitting surface, \\nilluminating surface and beam can be different. \\nb) If additional lighting unit is configured, its maximum horizontal distance from \\nadjacent lighting unit shall not exceed 140mm, if the additional lighting unit is \\n“lighting unit installed symmetrically”, the distance shall not exceed 200mm (see \\nE in Figure3); its vertical distance from upper or lower adjacent lighting unit shall \\nnot exceed 400mm (see D in Figure 3). \\nc) For the additional light ing unit mentioned in 5.22.4.1.b, the installation height \\nshall be not less than 250mm (see F in Figure 3), and shall meet requirements \\n(see G in Figure 3) of 5.2.4.2 of this regulation on the maximum ground \\nclearance. \\nd) Transversely, the following requirements shall be met: For each mode of \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n77 \\nFor Reference Purposes Only \\npassing beam lighting, on each side of vehicle, there shall be at least one \\nlighting unit of which the distance between outer edge of apparent surface and \\nextreme outer edge of vehicle is not more than 400mm (see A in Figure 3). And, \\nthe distance between the inner edges of two apparent surfaces in the direction \\nof reference axis shall be not less than 600mm, the requirement does not apply \\nto Categories M1 and N1 vehicles, and the distance may be reduced to 400mm \\nfor other types of vehicle of which the width is less than 1,300mm. \\n \\nFor given lighting mode, lighting units are turned on simultaneously:  \\n3 and 9: Two symmetric lighting units; \\n1 and 11: Two symmetric lighting units; \\n4 and 8: Two additional lighting units. \\nFor given lighting mode, lighting units are not turned on:  \\n2 and 10: Two symmetric lighting units; \\n5: Additional lighting unit; \\n6 and 7: Two symmetric lighting units. \\nHorizontal distance (mm): \\nA≤400; \\nB≥600 or B≥400 as vehicle width <1,300mm, vehicles \\nof Categories M1 and N1 do not apply for; \\nC≤200; \\nE≤140. \\nVertical distance (mm): \\nD≤400; \\nF≥250; \\nG≤1,200. \\nFigure 3 AFS lighting unit \\n5.22.4.2 \\nIn length: All lighting units of AFS shall be installed at front part of vehicle. Where \\nthe emitted light does not directly or indirectly cause discomfort of driver through \\nrearview mirror (devices for indirect vision) and/or other reflection surface of \\nvehicle, it is deemed that requirements of this clause are met. \\n5.22.4.3 \\nIn tests of 5.22.4.1~5.22.4.2, AFS should be set in neutral state. \\n5.22.5 \\nGeometric visibility: For lighting funct ion and mode at each side of vehicle, at \\nleast one lighting unit of lighting units of which all functions and modes are \\nswitched on simultaneously as per stipulations of manufacturer shall meet \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n78 \\nFor Reference Purposes Only \\nrequirements of 5.1.5 and 5.2.5 on geometric visibility. Single light ing unit can \\nbe used to meet different requirements on geometric visibility. \\n5.22.6 \\nDirection:  \\nNote:The following requirements 5.22.6.1~5.22.6.4 apply to basic passing beam \\nunder neutral state. \\n5.22.6.1 \\nVertical orientation \\n5.22.6.1.1 \\nThe initial downward inclinat ion of the cut-off of the dipped-beam to be set in the \\nunladen state with one person in the driver's seat shall be specified within an \\naccuracy of 0.1% by the manufacturer and indicated in a clearly legible and \\nindelible manner on each vehicle close to either headlamp or the manufacturer's \\nplate by the symbol shown in Annex F. \\nWhere different lighting units use different init ial downward inclinat ions for joint \\ncomposition of basic passing beam cutoff line, manufacturer shall indicate the \\nvalues on relevant lighting unit or near manufacturer nameplate as per accuracy \\nof 0.1% and one to one correspondence. \\n5.22.6.1.2 \\nFor horizontal part of cutoff line of basic dipped-beam, it is necessary to ensure \\nthat under all loading conditions specified in Annex A, its downward inclination \\nshall be within relevant limit scope in 5.2.6.1.2 of this regulation, including that \\ninitial aiming shall meet relevant requirements. \\nWhere dipped-beam is constituted by different beams of different lighting units, it \\nis necessary to inspect the above mentioned requirements of 5.22.6.1.2 respect \\nively for each beam “cutoff line” by making reference to 8.3.1 b) 8) in GB/T \\n30036-2013. \\n5.22.6.2 \\nHeadlamp levelling device \\n5.22.6.2.1 \\nHeadlamp leveling device used for implementation of requirements of 5.22.6.1.2 \\nshall be automatic. \\n5.22.6.2.2 \\nIn case of failure of leveling device, the downward inclination position of \\ndipped-beam shall be no higher than the position where malfunction occurs. \\n5.22.6.3 \\nHorizontal orientation: Cutoff line (if any) elbow of each lighting unit projected on \\nmeasuring screen shall pass through vert ical line of reference axis of the \\nlighting unit. Deviation of 0.5 degree is allowed on right side. Adjustment of other \\nlighting units shall be in compliance with stipulations of manufacturer, and shall \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n79 \\nFor Reference Purposes Only \\nbe clarified in document. \\n5.22.6.4 \\nMeasurement program: After completion of initial adjustment of beam direction, \\ndownward inclination of dipped-beam or downward inclination of basic \\ndipped-beam of which cutoff line is formed jointly by different lighting units as \\nper 5.22.6.2.1 shall meet requirements of 5.2.6.3.1 and 5.2.6.3.2 of this \\nregulation under all loading conditions of vehicle. \\n5.22.6.5 \\nInstallation direction \\n \\n \\nForward.  \\n5.22.7 \\nElectrical connections \\n5.22.7.1 \\nMain-beam provided by AFS \\n5.22.7.1.1 \\nMain-beam lighting units can be switched on simultaneously or in pair. When \\nswitching from dipped-beam to main-beam, it is necessary to switch on at least \\none pair of main-beam lighting units. When switching from main-beam to \\ndipped-beam, it is necessary to switch off all main-beam lighting units \\nsimultaneously. \\n5.22.7.1.2 \\nAdaptive main-beam shall be in compliance with stipulations of 5.22.9.3, control \\nsignal shall be generated by sensor system that can detect following items and \\nresponse to the items: \\n-- \\nAmbient lighting conditions; \\n-- \\nThe light emitted by the front lighting devices and front light-signalling \\ndevices of oncoming vehicles; \\n-- \\nThe light emitted by the rear light-signalling devices of forward vehicles. \\nAdditional sensor functions to improve performance are allowed. \\n“vehicle” in this clause means Categories L, M, N and O, and it is assumed that \\nthese vehicles have been configured with retro-reflectors, and lighting and \\nlight-signalling devices have been switched on. \\n5.22.7.1.3 \\nIn any case, adaptive function of main-beam headlamp shall feature manual \\nswitch on/off, and automatic control function shall feature manual switch-off. \\nFurthermore, switch-off of main-beam headlamp and its automatic control \\nfunction shall be of simple and quick manual operation and can be completed in \\none time. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n80 \\nFor Reference Purposes Only \\n5.22.7.1.4 \\nThe dipped-beams may remain switched on at the same time as the \\nmain-beams. \\n5.22.7.1.5 \\nWhere four concealable lighting units are installed, its raised position shall \\nprevent additional headlamp which is only used for sending intermittent light \\nsignal during day time (4.12) from working at the same time. \\n5.22.7.2 \\nDipped-beam headlamp: \\nWhen switching dipped-beam headlamp, all main-beam headlamp functions or \\nall AFS lighting units of main-beam headlamp function shall be switched off; \\nIt is allowed to switch on dipped-beam together with main-beam at the same \\ntime; \\nDipped-beam lighting unit of gas-discharge light source shall maintain ON state \\nwhen main-beam headlamp is switched on. \\n5.22.7.3 \\nSwitch on/off of dipped-beam headlamp shall feature automatic control and shall \\nmeet requirements of “electrical connection” of 4.12 of this regulation. \\n5.22.7.4 \\nAutomatic actuation of AFS \\n5.22.7.4.1 \\nSwitching between levels or between modes of AFS function shall be automatic \\nand shall not cause discomfort, glare or distraction of attention to driver or other \\nroad users. Where dipped-beam of other levels/modes is not activated, \\ndipped-beam of level C mode shall be switched on. \\n5.22.7.4.2 \\nActivation condit ions of level V dipped-beam mode: one or more situations \\nmentioned below have been detected automatically, applies to signal V: \\n-- \\nRoad in area of dense buildings, and the vehicle speed shall not exceed \\n60km/h; \\n-- \\nRoad with fixed lighting, and the vehicle speed shall not exceed 60km/h; \\n-- \\nLuminance of road surface exceeds 1cd/m2 continuously, or/and luminance \\nof horizontal road surface exceeds 10 lx continuously; \\n-- \\nThe vehicle speed shall not exceed 50km/h. \\n5.22.7.4.3 \\nActivation conditions of level E dipped-beam mode: the vehicle speed is \\nexceeding 60km/h, and one or more situations mentioned below have been \\ndetected automatically: \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n81 \\nFor Reference Purposes Only \\n-- \\nVehicle is on high-speed road (means road featuring measure for reduction \\nof glare to vehicles passing each other, such as road median barrier belt or \\ncrosswise safety distance between vehicles passing each other) or vehicle \\noperates at speed 110km/h (applies to signal E); \\n-- \\nAs per description of applicant certification document, mode E of \\ndipped-beam is in compliance with data set in D.7 of GB/T 30036-2013: \\nData set E1: the vehicle speed is exceeding 100km/h (applies to signal E1); \\nData set E2: the vehicle speed is exceeding 90km/h (applies to signal E2); \\nData set E3: the vehicle speed is exceeding 80km/h (applies to signal E3). \\n5.22.7.4.4 \\nActivation conditions of level W dipped-beam mode: Front fog lamp is under \\nOFF state, and one or more situations mentioned below have been detected \\nautomatically (applies to signal W). \\n-- \\nWet road surface has been detected automatically; \\n-- \\nWiper of windshield has been switched on, and continuous or automatically \\ncontrolled operation has been continued for over 2min. \\n5.22.7.4.5 \\nActivation conditions of bend lighting function corresponding to modes C, V, E or \\nW: activation conditions of corresponding modes have been met and at least \\none characteristic (or equivalent condition) of the followings has been assessed \\n(combined use of signal T and corresponding mode signal). \\n-- \\nSteering lock angle; \\n-- \\nTrace of gravity center of vehicle. \\nMoreover, shall meet following requirements: \\n-- \\nOnly if vehicle runs forwards and the distance from the crossing point \\nbetween longitudinal vert ical plane of cutoff line elbow and trace of gravity \\ncenter of running vehicle to vehicle is not more than 100 times of \\ninstallation height of lighting unit, it is allowed to use bend lighting function \\nfeaturing horizontal motion of unsymmetrical cutoff line deviating from \\nlongitudinal axis of vehicle (this clause does not apply to bend lighting \\ngenerated by right turning of vehicle). \\n-- \\nOnly if running vehicle gravity center trace curvature horizontal radius is not \\nmore than 500m, it is allowed to use bend lighting function of addit ional \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n82 \\nFor Reference Purposes Only \\nlight source. \\n5.22.7.5 \\nSwitch to neutual state by the driver \\nIn any case, driver shall be capable of adjusting AFS to neutral state at any time, \\nor resuming back to automatic operation mode. \\n5.22.8 \\nTell-tale \\n5.22.8.1 \\nIt is necessary to comply with the requirements of main-beam headlamp (5.1.8) \\nand dipped-beam headlamp (5.2.8). \\n5.22.8.2 \\nInstallation of AFS failure tell-tale is compulsory. The tell-tale shall not flash. \\nWhere AFS control signal malfunct ion is detected or signal that is not in \\ncompliance with stipulations on AFS is received, failure tell-tale shall be \\nswitched on and shall maintain operation. Failure tell-tale can be switched off \\ntemporarily, but when device used for turning on/off engine is switched on or off, \\nit shall be switched on again. \\n5.22.8.3 \\nIf adaptive main-beam is used, a visual tell-tale shall be switched on to indicate \\nthat adaptive main-beam has been switched on, and tell-tale shall continue ON \\nstate during its operating period. \\n5.22.9 \\nOther requirements \\n5.22.9.1 \\nWhere sum of the total objective luminous flux at left and right sides of the light \\nsource of AFS lighting unit of basic principal dipped-beam provided at two sides \\nof vehicle (including all lighting unit providing basic principal dipped-beam) \\nexceeds 4,000lm in cutoff line region defined in 8) of 8.3.1 b) in GB/T \\n30036-2013, AFS shall be configured with headlamp washer meeting \\nrequirements of GB 21260. \\n5.22.9.2 \\nConformity inspection of automatic operation of AFS system \\n5.22.9.2.1 \\nManufacturer shall provide conformity inspection document, including at least \\nthe following contents: \\na) \\nAFS control signal document: \\n1) \\nLighting funct ion and mode of approved AFS system; \\n2) \\nType/mode of dipped-beam and relevant AFS control signal; \\n3) \\nCorresponding provisions of 5.22.7.4 apply to system function mode; \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n83 \\nFor Reference Purposes Only \\n4) \\nSpecial description of light source inspection and visual observation of \\nbeam (if any); \\n5) \\nLamp grouped, combined or reciprocally incorporated with AFS \\nsystem; \\n6) \\nLighting unit that is in compliance with geometric visibility in 5.22.5. \\nb) \\nRelevant documents that are in compliance with automatic operation \\nrequirements in 5.22.7.4.1 to 5.22.7.4.5. \\n5.22.9.2.2 \\nIn order to inspect whether automatic operation of dipped-beam funct ion AFS \\nwill cause discomfort and requirements of 5.22.7.4, it is necessary to perform \\nroad test regarding all described system control conditions as per \\nmanufacturer’s descript ion. Verify whether all modes are activated, operated or \\nstopped as per description of manufacturer, whether malfunction arousing \\ndispute occur in system (such as extreme angle motion or tremble, etc). \\n5.22.9.2.3 \\nDemonstrate the complete automatic operation process as per requirements of \\ninspect ion institutions or by using documentary evidence. Furthermore, it is \\nnecessary to at least provide document to indicate measures of “safety \\nphilosophy” of system. Here “safety philosophy” means the safety strategy \\nincorporated in system, such as adoption of emergency system, so that safety \\nmeasures are adopted where electronic or mechanical malfunction causes \\ndiscomfort, distraction of attention or glare to driver, vehicles passing each other \\nor forward vehicle. The description shall give brief interpretation of all control \\nfunctions of “system” and realization modes, including control/implementation \\ntheory. \\nProvide list of inputted and collected variants of system and indicate the \\nspecified operating range. And the safety philosophy to return to basic \\ndipped-beam function (level C) operation. \\nManufacturer shall explain the expression of system function and safety \\nphilosophy. Document shall be brief, and shall demonstrate its benefit for \\nrelevant design and development by using terminology in the field. \\nFor the sake of demand of cyclic technical verification, it is necessary to provide \\ndocument to describe how to inspect current operat ing status of “system”. \\nThis document is used as reference document for conformity inspection. \\n5.22.9.2.4 \\nIn order to inspect whether adaptive main-beam function will cause discomfort, \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n84 \\nFor Reference Purposes Only \\ndistraction of attention or glare to driver, vehicles passing each other or forward \\nvehicle, it is necessary to perform road test as per the requirements of E2 of \\nAnnex E. Road test shall include all system control conditions described by \\nmanufacturer. For all functions of adaptive main-beam, it is necessary to \\nperform verification as per manufacturer’s description, and determine whether \\nmalfunction arousing dispute occur in system (such as extreme angle motion or \\ntremble, etc). \\n5.22.9.3 \\nAdaptive main-beam \\nFor adaptive main-beam as per requirements of 5.22.7.1.2, the requirements of \\nits sensor system \\na)As per requirements of 5.22.7.1.2, the minimum scope boundary angle of \\nsensor for detect ion of light ray emitted from other vehicle shall meet \\nrequirements of 5.1.9.3.1.1 of this Standard. \\nb)Sensor accuracy shall meet requirements of 5.1.9.3.1.2 of this Standard. \\nc)Where environmental illumination is larger than 7,000lx, adaptive main-beam \\nheadlamp shall be switched off. \\nManufacturer shall demonstrate conformity of product with above clauses to \\ninspection institution by using simulation or other method. If necessary, use \\nilluminance meter featuring cosine correction and measure horizontal \\nilluminance at height identical with vehicle sensor. It is allowed to prove \\nconformity with this clause by using method approved by inspection institution or \\ndocument or other method. \\n5.22.9.4 \\nFor all light ing units that are switched on simultaneously in main-beam light ing \\nor main-beam mode (if any), sum of the maximum intensity shall not exceed \\n430,000cd. See measurement method as per requirements of 5.1.9.2. \\n5.22.9.5 \\nUnless otherwise stipulated, relevant device of AFS function shall also meet \\nrequirements of this regulation on main-beam headlamp (5.1) and dipped-beam \\nheadlamp (5.2). \\n \\n5.23 \\nEmergency stop signal \\n5.23.1 \\nPresence: Optional. \\nThe emergency stop signal shall be given by the simultaneous operation of all \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n85 \\nFor Reference Purposes Only \\nthe stop or direction-indicator lamps fitted as described in 5.23.7. \\n5.23.2 \\nNumber: As specified in 5.5.2 or 5.7.2. \\n5.23.3 \\nArrangement: As specified in 5.5.3 or 5.7.3. \\n5.23.4 \\nInstallation position: As specified in 5.5.4 or 5.7.4. \\n5.23.5 \\nGeometric visibility: As specified in 5.5.5 or 5.7.5. \\n5.23.6 \\nOrientation: As specified in 5.5.6 or 5.7.6. \\n5.23.7 \\nElectrical connections \\n5.23.7.1 \\nFor all the lamps giving the emergency stop signal, the requitements on flash \\nfrequency are as below: \\na) at a frequency of (4.0±1.0) Hz in phase. \\nb) However, if any of the lamps of the emergency stop signal to the rear of the \\nvehicle use filament light sources, the frequency shall be 4.0\\n0\\n0\\n.\\n1\\n\\uf02d\\nHz. \\n5.23.7.2 \\nThe emergency stop signal shall operate independently of other lamps. \\n5.23.7.3 \\nThe emergency stop signal shall be activated and deactivated automatically. \\na) The emergency stop signal shall be activated only when the vehicle speed is \\nabove 50km/h and the braking system is providing the emergency braking logic \\nsignal defined in GB 12676 or GB 21670. \\nb) The emergency stop signal shall be automatically deactivated if the \\nemergency braking logic signal as defined in GB 12676 or GB 21670 is no \\nlonger provided or if the hazard warning signal is activated. \\n5.23.8 \\nTell-tale:  \\nOptional. \\n5.23.9 \\nOther requirements \\n5.23.9.1 \\nExcept as provided in 5.23.9.2 below, if a motor vehicle is equipped to tow a \\ntrailer, the control of the emergency stop signal on the motor vehicle shall also \\nbe capable of operating the emergency stop signal on the trailer. \\nWhen the motor vehicle is electrically connected to a trailer, the operating \\nfrequency of the emergency stop signal for the combination shall be limited to \\nthe frequency specified in 5.23.7.1.b. However, if the motor vehicle can detect \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n86 \\nFor Reference Purposes Only \\nthat filament light sources are not being used on the trailer for the emergency \\nstop signal, the frequency may be that specified in 5.23.7.a. \\n5.23.9.2 \\nIf a motor vehicle is equipped to tow a trailer fitted with a service braking system \\nof either continuous or semi-continuous type as defined in GB 12676, it shall be \\nensured that a constant power supply is provided via the electrical connector for \\nthe stop lamps to such trailers while the service brake is applied. \\nThe emergency stop signal on any such trailer may operate independently of the \\ntowing vehicle and is not required to operate either at the same frequency as, or \\nin phase with that on the towing vehicle. \\n5.24 \\nMarker lamp for draw-bar-trailer(Figure 4) \\n5.24.1 \\nPresence: Mandatory on draw-bar-trailers. Prohibited on other vehicles. \\n5.24.2 \\nNumber: Two. \\n5.24.3 \\nArrangement: No special requirements. \\n5.24.4 \\nInstallation position \\n5.24.4.1 \\nIn width: That point on the apparent surface farthest from the vehicle's median \\nlongitudinal plane shall be less than 150mm from the extreme outer edge of the \\ntrailer. \\n5.24.4.2 \\nIn height: The height above the frontal fence board of trailer shall be between \\n300mm and 400mm. \\n5.24.4.3 \\nIn length: At the front of trailer. \\n5.24.5 \\nGeometric visibility: No special requirements. \\n5.24.6 \\nOrientation: White illuminating surface towards the front of vehicle, and red \\nilluminating surface towards the rear of vehicle. \\n5.24.7 \\nElectrical connections: As per the provisions of 4.11. \\n5.24.8 \\nTell-tale: Optional. If fitted, its function shall be completed by the tell-tale for the \\nfrontal and rear position lamps. \\n5.24.9 \\nOther requirements: The maximum luminous intensity in a corresponding \\ndirection of marker lamp for draw-bar-trailer shall meet the photometric \\nrequirements for front and rear end-outline indicator lamps provided in Table 1 \\nof GB 5920. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n87 \\nFor Reference Purposes Only \\n \\nFigure 4 Marker lamp for draw-bar-trailer \\n5.25 \\nManoeuvring lamp \\n5.25.1 \\nPresence: Optional. \\n5.25.2 \\nNumber: Number: one or two (one on each side). \\n5.25.3 \\nArrangement: No special requirements, as specified in 5.25.9. \\n5.25.4 \\nPosition: No special requirements. \\n5.25.5 \\nGeometric visibility: No special requirements. \\n5.25.6 \\nDirection: Downward, as specified in 5.25.9. \\n5.25.7 \\nElectrical connections \\nManoeuvring lamp shall be switched on when dipped-beam headlamp or \\nmain-beam headlamp is switched on. \\nWhere any one of the following conditions is met, manoeuvring lamp can switch \\non automatically during slow speed traveling of vehicle until vehicle speed \\nreaches 10km/h. \\n-- \\nAfter manual startup of engine (propulsion system), before initial startup of \\nvehicle; or \\n-- \\nWhen the reversing gear is in meshing state; or \\n-- \\nIs used for switching on camera of assistant parking operation system. \\nWhere vehicle forward running speed is over 10km/h, manoeuvring lamp shall \\nswitch off automatically until switch-on again after the above mentioned \\nconditions are met. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n88 \\nFor Reference Purposes Only \\n5.25.8 \\nTell-tale: No special requirements. \\n5.25.9 \\nOther requirements \\n5.25.9.1 \\nDuring visual inspection in which observer moves within boundary scope of area \\nspecified in Annex I (the area is formed by transverse plane that is 10m in front \\nof vehicle, transverse plane that is 10m behind vehicle and two longitudinal \\nplanes that are respectively 10m away from two sides of vehicle, the height is \\n1m to 3m), it shall be impossible to directly see apparent surface of lamp. \\n5.25.9.2 \\nIf lamp meets photometric requirements of GB 15235 on manoeuvring lamp, \\nthen it is allowed to verify whether requirements of 5.25.9.1 are met as per \\ndrawing, simulation or equivalent method. \\n5.26 \\nRear-end collision alert signal \\n5.26.1 \\nPresence: Optional. Rear-end collision alert signal is realized by all the \\ndirection-indicator lamps in 5.26.7 lit simultaneously. \\n5.26.2 \\nNumber: As specified in 5.5.2. \\n5.26.3 \\nArrangement: As specified in 5.5.3. \\n5.26.4 \\nPosition: As specified in 5.5.4. \\n5.26.5 \\nGeometric visibility: As specified in 5.5.5. \\n5.26.6 \\nOrientation: As specified in 5.5.6. \\n5.26.7 \\nElectrical connections:  \\n5.26.7.1 \\nRear-end collision alert signal shall be flash simultaneously with the frequency \\nof (4.0±1.0) Hz. However, if any of the lamps of the rear-end collision alert signal \\nemitted from the rear of the vehicle use filament light sources, the flash \\nfrequency shall be within 4.0\\n0\\n0\\n.\\n1\\n\\uf02d\\nHz. \\n5.26.7.2 \\nRear-end collision alert signal shall operate independent of other lamps. \\n5.26.7.3 \\nRear-end collision alert signal shall be turned on and off automatically. \\n5.26.7.4 \\nIn case that direction-indicator lamp function, hazard warning signal or the \\nemergency stop signal function turned on, rear-end collision alert signal shall \\nnot be turned on. \\n5.26.7.5 \\nUnder the circumstances in Table 7, rear-end collision alert signal can be turned \\non only: \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n89 \\nFor Reference Purposes Only \\nTable 7 The conditions for activating rear-end collision alert signal \\nVr \\nActivation conditions \\nVr>30km/h \\nTTC≤1.4s \\nVr≤30km/h \\nTTC≤1.4s×Vr /30km/h \\nNote 1: “Vr (Relative Speed)”: Means speed difference between vehicle emitting rear-end collision alert \\nsignal and following vehicle of the same lane. \\nNote 2: “TTC (Time to collision)”: Means estimated time to collision of vehicle emitting rear-end collision alert \\nsignal and following vehicle of the same lane under the assumption that the Relative Speed (Vr) remains \\nunchanged. \\n5.26.7.6 \\nAction time of rear-end collision alert signal shall not exceed 3s. \\n5.26.8 \\nTell-tale:  \\nOptional. \\n6 \\nInspection Rules \\n6.1 \\nType approval verification and inspection \\n6.1.1 \\nStipulations on the same type with regard to the installation of lighting and \\nlight-signalling devices shall be in compliance with the definition of 3.2 of this \\nStandard. \\n6.1.2 \\nType inspection or conformity inspection for certain vehicle type via installation \\nway and quantity of external lighting and lighting-signal devices is deemed as  \\nsatisfatction if 6.2 or 6.3 is met. \\n6.2 \\nType inspection \\n6.2.1 \\nFor application of type inspection of lighting and light-signalling devices of a \\ncertain vehicle type, manufacturer of the vehicle type shall submit and attach the \\nfollowing documents: \\na)One copy of instruction manual regarding exterior shape and dimension of \\nrelevant vehicle type, number and position of various devices installed, \\nheadlamp leveling system and suspension system, and description of limited \\nload capacity especially the maximum load capacity of the boot. \\nb)One copy of lighting and light-signalling devices form specified by the \\nmanufacturer. In the form, several types of devices can be listed for each \\nfunction; and appropriate marking shall be given for each type (where type \\napproval has been granted, then national or international certification mark and \\nmanufacturer’s name shall be indicated). Furthermore, remarks can be made for \\neach type of function and its equivalent device shall be indicated. \\nc) One copy of overall installation drawing of lighting and light-signalling devices, \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n90 \\nFor Reference Purposes Only \\nwhich shall indicate the installation position of devices on vehicle, electric \\nperformance parameters and relative position between movable components \\nand relevant lamps. \\nd) One set of outline drawings that show the illuminating surface, light emitting \\nsurface, reference axis and centre of reference of each type of lamps, and one \\ncopy of description related to determination of apparent surface, with the \\nexception of registration plate lamp. \\ne) Documentary evidence required to be provided by manufacturer as per \\nrequirements of this Standard (for example, documents related to automatic \\non/off of headlamp and AFS function). \\n6.2.2 \\nOne unit of vehicle under no load, which is installed with full set of lighting and \\nlight-signalling devices and is of the vehicle type subject to type inspection, shall \\nbe submitted. Inspection shall be performed as per Chapter 4 and Chapter 5, \\nand relevant requirements shall be met. \\n6.3 \\nInspection of COP \\n6.3.1 \\nFor each unit of vehicle passed type inspection, the installation and \\ncharacteristics of its lighting and light-signalling devices shall be inspected as \\nper Chapter 4 and Chapter 5, and shall be identical with the vehicle type passed \\ntype inspection. \\n6.3.2 \\nFor vehicles that are manufactured continuously and have passed type \\ninspection of this Standard shall be subjected to random inspection. \\n6.4 \\nChange and expansion of vehicle lighting and light-signalling devices \\n \\nAfter type inspection, change and expansion of vehicle type or lighting and \\nlight-signalling devices shall be subject to confirmation by authority that has \\ngranted the type approval. \\n7 \\nImplementation date \\n7.1 \\nFrom the effective date of this Standard, vehicle type applying for new type \\napproval shall comply with this Standard. \\n7.2 \\nFor vehicle type granted with type approval, if there is no change with regard to \\nthe installation of lighting and light-signalling devices, transition period until stop \\nof production shall be granted. \\n7.3 \\nRequirements of 4.17 of this Standard on vehicle newly applying for type \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n91 \\nFor Reference Purposes Only \\napproval should can be implemented as per the requirements of 4.17.a) and/or \\n4.17.b within 24 months after implementation date, and shall be implemented as \\nper the requirements of 4.17.a) after 24 month of implementation date. \\n7.4 \\nRequirements of 5.2.7.6 of this Standard on vehicle newly applying for type \\napproval should can be implemented as per the requirements of 5.2.7.6.a and/or \\n5.2.7.6.b and/or 5.2.7.6.c within 36 months after implementation date, and shall \\nbe implemented as per the requirements of 5.2.7.6.a after 36 months of \\nimplementation date. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n92 \\nFor Reference Purposes Only \\nAnnex A \\n(Normative) \\nStates of Loading in Determining Variations in the Vertical Orientation of \\nthe Dipped-beam Headlamps \\nA1 \\nFor the following tests, the mass of the passengers shall be calculated on the \\nbasis of 75kg per person. \\nA2 \\nLoading conditions for different types of vehicles \\nA2.1 \\nVehicles of Category M1 \\nA2.1.1 \\nThe angle of the light beam of the dipped-beam headlamps shall be determined \\nunder the following load conditions: \\n-- \\nOne driver; \\n-- \\nThe driver, plus one passenger in the front seat farthest from the driver; \\n-- \\nThe driver, one passenger in the front seat farthest from the driver, all the \\nseats farthest to the rear occupied; \\n-- \\nAll the seats occupied; \\n-- \\nAll the seats occupied, plus an evenly distributed load in the boot, in order \\nto obtain the permissible load on the rear axle or on the front axle if the boot \\nis at the front. If the vehicle has a front and a rear boot, the additional load \\nmust be appropriately distributed in order to obtain the permissible axle \\nloads. However, if the maximum permissible laden mass is obtained before \\nthe permissible load on one of the axles, the loading of the boot(s) shall be \\nlimited to the figure which enables that mass to be reached; \\n-- \\nDriver, plus an evenly distributed load in the boot, in order to obtain the \\npermissible load on the corresponding axle.If the maximum permissible \\nladen mass is obtained before the permissible load on the axle, the loading \\nof the boot(s) shall be limited to the figure which enables that mass to be \\nreached \\nA2.1.2 \\nIn determining the above loading conditions, account shall be taken of any \\nloading restrictions laid down by the manufacturer. \\nA2.2 \\nVehicles of Categories M2 and M3 \\nThe angle of the light beam from the dipped-beam headlamps must be \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n93 \\nFor Reference Purposes Only \\ndetermined under the following loading conditions: \\n-- \\nVehicle unladen and one person in the driver’s seat; \\n-- \\nVehicles laden such that each axle carries its maximum technically \\npermissible load or until the maximum permissible mass of the vehicle is \\nattained by loading the front and rear axles proportionally to their maximum \\ntechnically permissible loads, whichever occurs first. \\nA2.3 \\nVehicles in Category N with load surfaces \\nThe angle of the light beam from the dipped-beam headlamps must be \\ndetermined under the following loading conditions: \\n-- \\nVehicle unladen and one driver; \\n-- \\nDriver, plus a load so distributed as to give the maximum technically \\npermissible load on the rear axle or axles, or the maximum permissible \\nmass of the vehicle, whichever occurs first, without exceeding a front axle \\nload calculated as the sum of the front axle load of the unladen vehicle plus \\n25% of the maximum permissible payload on the front axle. The front axle \\nis so considered when the load platform is at the front. \\nA2.4 \\nVehicles in Category N without a load surface \\nA2.4.1 \\nDrawing vehicles for semi-trailers \\nThe angle of the light beam from the dipped-beam headlamps must be \\ndetermined under the following loading conditions: \\n-- \\nUnladen vehicle is not connected to the trailer and one person in the \\ndriver’s seat; \\n-- \\nOne person in the driver’s seat: technically permissible load on the coupling \\nattachment in the position of the attachment corresponding to the highest \\nload on the rear axle. \\nA2.4.2 \\nDraw-bar-trailer \\n-- \\nVehicle unladen and one person in the driver’s seat; \\n-- \\nOne person in the driver’s seat, all the other places in the driving cabin \\nbeing occupied. \\nA.3  \\nChange of dipped-beam headlamp on vertical direction \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n94 \\nFor Reference Purposes Only \\nAs per 5.2.6.1 and 5.2.6.3.1. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n95 \\nFor Reference Purposes Only \\nAnnex B \\n(Informative) \\nExamples of Lamp Surfaces, Axes & Centers of Reference, and Angles of \\nGeometric Visibility \\nB1 \\nThese examples show some arrangements to aid the understanding of the \\nrelated provisions of this Standard and are not intended to be design restrictive. \\nB2 \\nKey words in this Annex \\n \\nSee Figure B.1 \\nTable B1 Key words in this Annex and the corresponding number in the \\nfigure \\nNumber \\nKey words \\n1 \\nIlluminating surface \\n2 \\nAxis of reference \\n3 \\nCentre of reference \\n4 \\nAngle of geometric visibility \\n5 \\nLight emitting surface \\n6 \\nApparent surface based on the illuminating surface \\n7a \\nApparent surface based on the light emitting surface according to 3.10 a) (Considering textured outer lens) \\n7b \\nApparent surface based on the light emitting surface according to 3.10 b) (Without considering non-textured outer lens) \\n8 \\nDirection of observation \\nB3 \\nExamples of lamp surfaces, reference axes & centers, and geometric visibility \\nB3.1 \\nExamples of light emitting surface of a light-signalling device (other than a \\nretro-reflector). \\nExample : \\n \\nApparent surface based on \\nlight emitting surface \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n96 \\nFor Reference Purposes Only \\nB3.2 \\nExamples of illuminating surface of a light-signalling device (other than a \\nretro-reflector). \\nExample : \\n \\n \\nResulting illuminating surface over all possible \\nscreen positions, e.g. for the determination of \\nmaximum or minimum area specification. \\nIlluminating surface \\nScreen, the position is not unique \\n \\nB3.3 \\nExamples of apparent surface based on illuminating surface in different \\ndirections of geometric visibility. \\nExample : \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n97 \\nFor Reference Purposes Only \\n \\nB3.4 \\nExamples of apparent surface based on light emitting surface in different \\ndirections of geometric visibility. \\nExample : \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n98 \\nFor Reference Purposes Only \\n \\nB3.5 \\nExamples of illuminating surface and light emitting surface of a single function \\nlamp (see paragraphs 3.10 to 3.11 of this Standard) \\nB3.5.1 \\nExamples of a light source with a reflector and an outer lens. \\nExample 1: Outer lens is textured  \\nExample 2: Without considering non-textured outer lens \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n99 \\nFor Reference Purposes Only \\n \\nOuter lens \\nLight source \\nReflector \\nReflector \\nLight source \\nOuter lens \\n \\nB3.5.2 \\nExamples of a light source with a reflector as well as an inner lens & an outer \\nlens. \\nExample 1: Outer lens is textured  \\nExample 2: Without considering non-textured outer lens \\n \\nOuter lens \\nLight source \\nReflector \\nReflector \\nLight source \\nOuter lens \\nInternal optical module \\nInternal optical module \\n \\nB3.5.3 \\nExamples of a light source with a reflector as well as a partial inner lens and an \\nouter lens. \\nExample 1: Outer lens is textured  \\nExample 2: Without considering non-textured outer lens \\n \\nOuter lens \\nLight source \\nReflector \\nReflector \\nLight source \\nOuter lens \\nInternal optical module \\nInternal optical module \\n \\nB3.5.4 \\nExample of a light guide behind an outer lens. \\nExample 11: \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n100 \\nFor Reference Purposes Only \\n \\nWithout considering non-textured outer lens, “7b” is the apparent surface according to \\n3.9 b) \\nSection AA \\nLight guide \\nOuter lens \\n \\nB3.5.5 \\nExample of a light guide or a reflector behind an outer lens. \\nExample : \\n \\nFunction 1: Light guide, reflector \\nFunction 2 \\nSection AA \\nWithout considering non-textured outer lens, “7b)” is the apparent surface according to 3.9 b), light of Function \\n2 shall not be transparent to Function 1 \\nOuter lens \\n \\nB3.5.6 \\nExamples of a light source with a reflector in combination with an area which is \\nnot part of this function, behind an outer lens. \\nExample : \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n101 \\nFor Reference Purposes Only \\n \\nReflector \\nLight source \\nOuter lens \\nWithout considering non-textured outer lens, “7b” is the apparent \\nsurface according to 3.9 b), and “X” area is not part of the function. \\n \\nB3.6 \\nExamples of light emitting surface and illuminating surface \\nB3.6.1 \\nExamples of light emitting surface and illuminating surface. \\nExample 1: \\n \\nDeclared axis of reference \\nSurface of the lens \\nProjected \\nview \\n \\n \\nIlluminating surface \\nLight emitting surface according to 3.9 a) \\nEdges \\na-b \\nc-d \\nExample 2: \\n \\nDeclared axis of reference \\nSurface of the lens \\nProjected \\nview \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n102 \\nFor Reference Purposes Only \\n \\nIlluminating surface \\nLight emitting surface according to 3.9 a) \\nEdges \\na-b \\nc-d \\nB3.6.2 \\nThe illuminating surface in combination with an area which is not part of the \\nfunction \\nExample : \\n \\nDeclared axis of reference \\nX is not part of this function \\nSurface of the lens \\nProjected view \\n \\n \\nIlluminating surface \\nEdges \\na-b \\nB3.6.3 \\nExample of a light emitting surface according to 3.10 a) in combination with an \\narea which is not part of the function. \\nExample : \\n \\nDeclared axis of reference \\nX is not part of this function \\nSurface of the lens \\nProjected view \\n \\n \\nLight emitting surface according to 3.10 a) \\nEdges \\nc-d and e-f \\nB3.6.4 \\nExample of the apparent surface in combination with an area which is not part of \\nthe function and a non-textured lens according to 3.10 b). \\nExample : \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n103 \\nFor Reference Purposes Only \\n \\nDeclared axis of reference \\nX is not part of this function \\nSurface of the \\nlens \\nProjected view \\n \\n \\nLight emitting surface according to 3.9 b) \\nEdges \\nc’-d’ and e’-f’ \\nB3.7 \\nExample for determining whether these two functions are reciprocally \\nincorporated \\nB3.7.1 \\nLens is textured and there is isolator between functions. \\nExample : \\n \\nNot reciprocally \\nincorporated between \\nFunction 1 and Function 2 \\nFunction 1 \\n7a for Function 1 \\nOuter lens \\nFunction 2 \\n7a for Function 2 \\n \\nB3.7.2 \\nIn the case where lens is textured \\nExample : \\n \\n \\nReciprocally incorporated between \\nFunction 1 and Function 2 \\n \\nFunction 1 \\n7a for Function 1 \\nOuter lens \\nFunction 2 \\n7a for Function 2 \\n \\nB3.7.3 \\nWithout considering non-textured lens. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n104 \\nFor Reference Purposes Only \\nExample : \\n \\n \\nFunction 1 \\nOuter lens \\nFunction 2 \\nOuter lens \\nOuter lens \\nFunction 2 \\nFunction 2 \\nFunction 1: Light guide \\nNot reciprocally incorporated between \\nFunction 1 and Function 2 \\n \\nNot reciprocally incorporated between \\nFunction 1 and Function 2 \\n \\nNot reciprocally incorporated between \\nFunction 1 and Function 2 \\n \\nFunction 1: Light guide \\n \\nB3.7.4 \\nConsidering outer lens (textured or non-textured). \\nExample : \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n105 \\nFor Reference Purposes Only \\n \\nOuter lens \\nFunction 2 \\nOuter lens \\nOuter lens \\nFunction 2 \\nFunction 2 \\nFunction 1: Light guide \\nReciprocally incorporated between \\nFunction 1 and Function 2 \\n \\nReciprocally incorporated between \\nFunction 1 and Function 2 \\n \\nReciprocally incorporated between \\nFunction 1 and Function 2 \\n \\nFunction 1: Light guide and reflector \\nFunction 1: Light guide \\n \\nB3.7.5 \\nWithout considering non-textured outer lens, “7b” is the apparent surface \\naccording to 3.10 and Function 2 shall not be transparent to Function 1. \\nExample : \\n \\nFunction 1 & Function 2 not \\nreciprocally incorporated \\nFunction 1: Light guide and reflector \\nOuter lens \\nFunction 2 \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n106 \\nFor Reference Purposes Only \\nB3.7.6 \\nIn any case, even if the non-textured outer lens. \\nExample : \\n \\nFunction 1 & Function 2 \\nreciprocally incorporated \\nFunction 1: Light guide \\nOuter lens \\nFunction 2 \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n107 \\nFor Reference Purposes Only \\nAnnex C \\n(Normative) \\nInvisibility of a Red Lamp to the Front and Invisibility of a White Lamp to \\nthe Rear Note \\nRange of Invisibility of a Red Lamp to the Front and Invisibility of a White Lamp to the Rear is \\nshown in Figure C.1 \\n \\n \\nInvisibility of a red lamp to the front \\nZone 1 \\n \\n \\nInvisibility of a white lamp to the rear \\nZone 2 \\n \\nFigure C1 Range of Invisibility of a Red Lamp to the Front and Invisibility of a White \\nLamp to the Rear \\n \\n \\n \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n108 \\nFor Reference Purposes Only \\nAnnex D \\n(Normative) \\nMeasurement of the Variation of Dipped-beam Inclination as a Function \\nof Load \\nD1 \\nScope \\nThis Annex specifies a method for measuring variations in motor vehicle \\ndipped-beam inclination (in relation to its initial inclination) caused by changes in \\nvehicle attitude due to loading. \\nD2 \\nDefinitions \\nD2.1 \\nInitial inclination \\nD2.1.1 \\nStated initial inclination \\nThe value of the dipped-beam initial inclination specified by the motor vehicle \\nmanufacturer serving as a reference value for the calculation of permissible \\nvariations. \\nD2.1.2 \\nMeasured initial inclination \\nThe mean value of dipped-beam inclination or vehicle inclination measured with \\nthe vehicle in condition No. 1, as defined in Annex A, for the Category of vehicle \\nunder test, namely, one driver (category M1); vehicle unladen with one driver \\n(other categories). It serves as a reference value for the assessment of \\nvariations in beam inclination as the load varies. \\nD2.2 \\nDipped-beam inclination \\nIt may be defined as either as the angle, expressed in milliradians (mrad), \\nbetween the direction of the beam towards a characteristic point on the \\nhorizontal part of the cut-off in the luminous distribution of the headlamp and the \\nhorizontal plane; or by the tangent of that angle, expressed in percentage \\ninclination. Since the angles are small, 1% is equal to 10 mrad. \\nIf the inclination is expressed in percentage, it can be calculated by means of \\nthe following formula: \\n100\\n)\\n(\\n2\\n1\\n\\uf0b4\\n\\uf02d\\nL\\nh\\nh\\n…… (1) \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n109 \\nFor Reference Purposes Only \\nWhere: \\nh1 -- The height above the ground (in mm) of the above-mentioned characteristic point, measured \\non a vertical screen perpendicular to the vehicle longitudinal median plane, placed at a horizontal \\ndistance L. \\nh2 -- The height above the ground (in mm) of the center of reference, which is taken to be the \\nnominal origin of the characteristic point chosen in h1. \\nL -- The distance (in mm) from the screen to the center of reference. \\nAs shown in Figure D1, negative values denote downward inclination, while \\npositive values denote upward inclination. \\n \\nDescription: \\n1 \\nThis drawing represents a Category M1 vehicle, but the principle shown applies equally to \\nvehicles of other categories. \\n2 \\nWhere the vehicle does not incorporate a headlamp levelling system, the variation in \\ndipped-beam inclination is identical with the variation in the inclination of the vehicle itself. \\nFigure D1 Dipped-beam downward inclination of a Category M1 vehicle \\nD3 \\nMeasurement conditions \\nD3.1 \\nIf a visual inspection of the dipped-beam pattern on the screen or a photometric \\nmethod is used, measurement shall be carried out in a dark environment (for \\nexample, a dark room) of sufficient area to allow the vehicle and the screen to \\nbe placed as shown in the figure. Headlamp centers of reference shall be at a \\ndistance from the screen of at least 10m. \\nD3.2 \\nThe ground on which measurements are made shall be as flat and horizontal as \\npossible, so that the reproducibility of measurements of dipped-beam inclination \\ncan be assured with an accuracy of ±0.5mrad (±0.05% inclination). \\nD3.3 \\nIf a screen is used, its marking, position and orientation in relation to the ground \\nand to the median longitudinal plane of the vehicle, shall be such that the \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n110 \\nFor Reference Purposes Only \\nreproducibility of the measurement of the dipped-beam inclination can be \\nassured with an accuracy of ±0.5mrad (±0.05% inclination). \\nD3.4 \\nDuring measurements, the ambient temperature shall fall within 10ºC to 30ºC. \\nD4 \\nVehicle preparation \\nD4.1 \\nMeasurements shall be carried out on a vehicle which has travelled a distance \\nof between 1,000km and 10,000km, preferably 5,000km. \\nD4.2 \\nTyres shall be inflated to the full-load pressure specified by the vehicle \\nmanufacturer. The vehicle shall be fully replenished (fuel, water, oil) and \\nequipped with all the accessories and tools specified by the manufacturer. Full \\nfuel replenishment means that the fuel tank must be filled to not less than 90% \\nof its capacity. \\nD4.3 \\nThe vehicle shall have the parking brake released and the gearbox in neutral. \\nD4.4 \\nThe vehicle shall be conditioned for at least 8h at the temperature specified in \\nD.3.4 above. \\nD4.5 \\nIf a photometric or visual method is used, headlamps with a well-defined \\ndipped-beam cut-off shall preferably be installed on the vehicle under test in \\norder to facilitate the measurements. Other means are allowed to obtain a more \\nprecise reading (for example, removal of the headlamp lens). \\nD5 \\nTest procedures \\nD5.1 \\nGeneral \\nThe variations in either dipped-beam or vehicle inclination, depending on the \\nmethod chosen, shall be measured separately for each side of the vehicle. The \\nresults obtained from both left and right headlamps under all the load conditions \\nspecified in Annex A, shall be within the limits set out in D5.5 below. The load \\nshall be applied gradually without subjecting the vehicle to excessive shocks. \\nD5.2 \\nDetermination of the measured initial inclination \\nThe vehicle shall be prepared as specified in D4 above and laden as specified in \\nAnnex A (first loading condition of the respective vehicle category). Before each \\nmeasurement, the vehicle shall be rocked as specified in D5.4 below. \\nMeasurements shall be made three times. \\n \\nIf none of the three measured results differ by more than 2mrad (0.2% \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n111 \\nFor Reference Purposes Only \\ninclination) from the arithmetic mean of the results, that mean shall constitute \\nthe final result. \\n \\nIf any measurement differs from the arithmetic mean of the results by more than \\n2mrad (0.2% inclination), a further series of 10 times measurements shall be \\nmade, the arithmetic mean of which shall constitute the final result. \\nD5.3 \\nMeasurement method \\nAny method may be used to measure variations of inclination provided that the \\nreadings are accurate to within ±0.2mrad (±0.02% inclination). \\nD5.4 \\nTreatment of vehicle in each loading condition \\nThe vehicle suspension and any other part likely to affect dipped-beam \\ninclination shall be activated according to the methods described below. \\nNOTE:However, the technical authorities and manufacturers may jointly \\npropose other methods (either experimental or based upon calculations), \\nespecially when the test poses particular problems, provided such calculations \\nare clearly valid. \\na)Category M1 vehicles with conventional suspension \\nWith the vehicle standing on the measuring site and, if necessary, with the \\nwheels resting on floating platforms (which shall be used if their absence would \\nlead to restriction of the suspension movement likely to affect the results of \\nmeasurements), rock the vehicle continuously for at least three complete cycles, \\nfor each cycle, first the rear and then the front end of the vehicle is pushed down. \\nThe rocking sequence shall end with the completion of a cycle. Before making \\nthe measurements, the vehicle shall be allowed to come to rest spontaneously. \\nInstead of using floating platforms, the same effect can be achieved by moving \\nthe vehicle backwards and forwards for at least a complete wheel revolution. \\nb)Categories M2, M3 and N vehicles with conventional suspension \\n1)If the treatment method for Category M1 vehicles described in D5.4.a \\nabove is not possible, the method described in D5.4.b.2 or B5.4.b.3 below \\nmay be used. \\n2)With the vehicle standing on the measuring site and the wheels on the \\nground, rock the vehicle by temporarily varying the load. \\n3)With the vehicle standing on the measuring site and the wheels on the \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n112 \\nFor Reference Purposes Only \\nground, activate the vehicle suspension and all other parts which may \\naffect the dipped-beam inclination by using a vibration rig. This can be a \\nvibrating platform on which the wheels rest. \\nc)Vehicles with non-conventional suspension, where the engine shall be running. \\nBefore making any measurement wait until the vehicle has assumed its final \\nattitude. \\nD5.5 \\nMeasurements: The variation of the inclination of the dipped-beam shall be \\nassessed for each of the different loading conditions in relation to the measured \\ninitial inclination determined in accordance with B5.2 above. If the vehicle is \\nfitted with a manual headlamp-levelling system, the latter shall be adjusted to \\nthe positions specified by the manufacturer for given loading conditions. As \\nbelow method: \\na)To begin with, a single measurement shall be made in each loading condition. \\nRequirements have been met if, for all the loading conditions, the variation in \\ninclination is within the calculated limits (for example, within the difference \\nbetween the stated initial inclination and the lower and upper limits specified for \\napproval) with a safety margin of 4mrad (0.4% inclination). \\nb)If the result(s) of any measurement(s) does (do) not lie within the safety \\nmargin indicated in D5.5.a or exceed(s) the limit values, a further three \\nmeasurements shall be made in the loading conditions corresponding to this \\n(these) result(s) as specified in D5.5.c. \\nc)Determination of measurement results \\n1)If none of the three measured results differs by more than 2mrad (0.2% \\ninclination) from the arithmetic mean of the results, that mean shall \\nconstitute the final result. \\n2)If any measurement differs from the arithmetic mean of the results by \\nmore than 2mrad (0.2% inclination), a further series of 10 times \\nmeasurements shall be made, the arithmetic mean of which shall constitute \\nthe final result. \\n3) All these measurements shall be made in accordance with paragraphs \\nD5.5.c.1 and D5.5.c.2. \\nd)Requirements have been met, if, under all loading conditions, the variation \\nbetween the measured initial inclination determined in accordance with D.5.2 \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n113 \\nFor Reference Purposes Only \\nand the inclination measured under each loading condition is less than the \\nvalues calculated in D.5.5.a (if without safety margin). \\ne)If only one of the calculated upper or lower limits of variation is exceeded, the \\nmanufacturer shall be permitted to choose a different value for the stated initial \\ninclination, within the limits specified for type test. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n114 \\nFor Reference Purposes Only \\n Annex E \\n(Normative) \\nRoad Test \\nE1 \\nRoad test shall be performed to the main-beam headlamps having automatic \\ncontrol. \\nE1.1 \\nRoad test shall be carried out in clear atmosphere and with clean head-lamps. \\nE1.2 \\nThe test course shall comprise test sections with traffic conditions, at speed \\ncorresponding to the relevant type of road, as described in Table E1 below: \\nTable E1 \\nTest \\nitems \\nTraffic conditions \\nRoad conditions \\nUrban areas \\nRoad with median \\nisolation belt, such as: \\nexpressway \\nCountry \\nroad \\nSpeed \\n(50±10) \\nkm/h \\n(100±20) km/h \\n(80±20) \\nkm/h \\nPercentage of test road to entire road section. \\n10% \\n20% \\n70% \\nA \\nSingle oncoming vehicle or single forward vehicle \\nin a frequency so that the main-beam will switch \\nON and OFF automatically. \\n \\n√ \\n√ \\nB \\nCombined oncoming or forward vehicles in a \\nfrequency so that the main-beam will switch ON \\nand OFF automatically. \\n \\n√ \\n√ \\nC \\nActive and passive overtaking maneuvers in a \\nfrequency so that the main-beam will switch ON \\nand OFF automatically. \\n \\n√ \\n√ \\nD \\nCombined oncoming and forward vehicles in a \\nfrequency \\n√ \\n \\n \\nE1.3 \\nUrban areas shall comprise roads with and without illumination. \\nE1.4 \\nCountry roads shall comprise sections having two lanes and sections having \\nfour or more lanes and shall include junctions, hills and/or slopes, dips and \\nwinding roads. \\nE1.5 \\nMulti-lane roads (e.g. motorways) and country roads shall comprise sections \\nhaving straight level parts with a length of more than 600m. Additionally they \\nshall comprise sections having curves to the left and to the right. \\nE1.6 \\nDense traffic situations shall be taken into account. \\nE2 \\nRoad test shall be performed for adaptive main-beam headlamp. \\nE2.1 \\nRoad test shall be performed under clean atmosphere condit ion and provided \\nthat clean headlamp is configured. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n115 \\nFor Reference Purposes Only \\nE2.2 \\nTest items shall be all traffic condit ions and speeds of various types of road \\nsection described in Table E2. \\nE2.3 \\nUrban road shall include the circumstances with lighting and without lighting. \\nE2.4 \\nCountry road shall include 2-lane road section, 4-lane road section and \\nmulti-lane road section, and shall include intersect ion road, hill and/or slope, \\ndownhill and bend road. \\nE2.5 \\nMulti-lane road (such as expressway) and country road shall include straight \\nroad section exceed 600m in length. Furthermore, left-turn and right-turn bend \\nroad shall be included. \\nE2.6 \\nIt is necessary to take account of busy traffic situations. \\nE2.7 \\nRegarding item A and item B in Table E2, testing staffs shall assess and record \\nadapt ive effect from passing vehicle and forward vehicle, this means that it is \\nnecessary to configure testing staffs in test vehicle, passing vehicle and forward \\nvehicle. \\nTable E2 \\nTest \\nitems \\nTraffic conditions \\nRoad conditions \\nUrban areas \\nRoad with median \\nisolation belt, such as: \\nexpressway \\nCountry \\nroad \\nSpeed \\n(50±10) km/h \\n(100±20) km/h \\n(80±20) \\nkm/h \\nPercentage of test road to entire road section. \\n10% \\n20% \\n70% \\nA \\nSingle oncoming vehicle or single forward \\nvehicle in a frequency, adaptive main-beam \\nheadlamp shall be able to run automatically. \\n \\n√ \\n√ \\nB \\nCombined oncoming or forward vehicles in a \\nfrequency, adaptive main-beam headlamp shall \\nbe able to run automatically. \\n \\n√ \\n√ \\nC \\nActive and passive overtaking maneuvers in a \\nfrequency, adaptive main-beam headlamp shall \\nbe able to run automatically. \\n \\n√ \\n√ \\nD \\nCombined oncoming and forward vehicles in a \\nfrequency \\n√ \\n \\n \\n \\n \\n \\n \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n116 \\nFor Reference Purposes Only \\nAnnex F \\n(Normative) \\nIndication of the Downward Inclination of the Dipped-beam Headlamps \\nCut-off and Downward Inclination of the Front Fog Lamp Cut-off  \\nIndication of the Downward Inclination of the Dipped-beam Headlamps Cut-off Referred to in \\n5.2.6.1.1 and Downward Inclination of the Front Fog Lamp Cut-off Referred to in 5.3.6.1.2 of \\nthis Standard \\n \\nExample 1: Standard symbol for dipped-beam headlamp \\n \\nDescription: The size of the symbol and characters is left to the discretion of the manufacturer, and value of the stated \\ninitial adjustment. \\nExample 2: Standard symbol for front fog lamp \\n \\nDescription: The size of the symbol and characters is left to the discretion of the manufacturer, and value of the stated \\ninitial adjustment. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n117 \\nFor Reference Purposes Only \\nAnnex G \\n(Normative) \\nThe Controls for the Headlamp-levelling Devices \\nG.1 \\nDownward inclination of the dipped-beam shall in all cases be produced in one \\nof the following ways: \\na) \\nBy moving a control downwards or to the left; \\nb) \\nBy rotating a control in a counter clockwise direction; \\nc) \\nBy depressing a button (push-pull control). \\nIf several buttons are used to adjust the beam, the button which gives the \\ngreatest downward inclination shall be installed to the left or below the button(s) \\nfor other dipped-beam positions. \\nA rotary control which is installed edge-on, or with only the edge visible, shall \\nfollow the operating principles of control of types a) or b). \\nThis control shall carry symbols indicating clearly the movements corresponding \\nto the downward and upward inclination of the dipped-beam. \\nG.2 \\nThe “0” position corresponds to the initial inclination according to 5.2.6.1.1. \\nG.3 \\nThe “0” position which, according to 5.2.6.2.2 has to be a “stop position”, need \\nnot necessarily be at the end of the scale. \\nG.4 \\nThe marks used on control shall be explained in the owner's handbook. \\nG.5 \\nThe following symbols in Figure G1 or combination of symbols in Figure G2 and \\nFigure G3 shall be used to identify the controls, symbols employing five lines \\ninstead of four lines may also be used (See example for details). \\n \\nFigure G1 \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n118 \\nFor Reference Purposes Only \\nFigure FG \\n \\nFigure G3 \\nExample 1: \\n \\nExample 2: \\n \\nExample 3: \\n \\n \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n119 \\nFor Reference Purposes Only \\n \\nAnnex H \\n(Normative) \\nAutomatic Switching of Dipped-beam Headlamps \\nConditions of automatic switching of dipped-beam headlamps are shown in Table H.1 \\nTable H1 \\nConditions of automatic switching of dipped-beam headlamps \\nAmbient light outside the vehicle Note \\nDipped-beam headlamps \\nResponse time \\nLess than 1,000lux \\nON \\nNot more than 2s \\n1,000lux to 7,000lux \\nAt manufacturer’s discretion \\nAt manufacturer’s discretion \\nMore than 7,000lux \\nOFF \\nMore than 5s, not more than 300s \\nNote: The luminance shall be measured on a horizontal surface, with a cosine corrected sensor on the same height \\nas the mounting position of the sensor on the vehicle. \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n120 \\nFor Reference Purposes Only \\nAnnex I \\n(Normative) \\nObservation Areas of Apparent Surface of Manoeuvring Lamp \\nObservation Areas of Apparent Surface of Manoeuvring Lamp are shown in Figure I.1 \\na)zone of observation \\n \\nb) Boundaries of the zones \\n \\nFigure I1 Observation Areas of Apparent Surface of Manoeuvring Lamp \\n \\n \\n\\n \\n \\n  \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\nJanuary / 2020 \\n \\nACEA Translation  \\n121 \\nFor Reference Purposes Only \\n \\nBibliography \\n[1] ECE R99 Uniformprovisions concerning the approval of gas-discharge light sources for use \\nin approved gas-discharge lamp units of power-driven vehicles \\n[2] ECE R128 Uniform provisions concerning the approval of light emitting diode(LED) light \\nsources for use in approved lamp units of poer-driven vehicles and their trailers. \\n \\n\", metadata={'source': 'Chinese Documents/GB 4785-2019 Lighting installation -EN.pdf'})]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "documents"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "zI5QaEbBL7Yd"
   },
   "source": [
    "## Parent Document Retriever\n",
    "Version 1 - Smaller chunks"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "id": "1p7-H3CBL7Yd"
   },
   "outputs": [],
   "source": [
    "from langchain.storage import InMemoryStore\n",
    "from langchain.retrievers import ParentDocumentRetriever"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "id": "1p7-H3CBL7Yd"
   },
   "outputs": [],
   "source": [
    "def documents_to_retriever(documents):\n",
    "    child_splitter = RecursiveCharacterTextSplitter(chunk_size=200, chunk_overlap=100)\n",
    "    parent_splitter = RecursiveCharacterTextSplitter(chunk_size=600, chunk_overlap=100)\n",
    "    \n",
    "    vectorstore = Chroma(collection_name=\"full_documents\", \n",
    "                         embedding_function=hf)\n",
    "    store = InMemoryStore()\n",
    "    retriever = ParentDocumentRetriever(\n",
    "        vectorstore=vectorstore,\n",
    "        docstore=store,\n",
    "        child_splitter=child_splitter,\n",
    "        parent_splitter=parent_splitter)\n",
    "    \n",
    "    s = time.time()\n",
    "    retriever.add_documents(documents, ids=None)\n",
    "    print(\"Document splitted in\", time.time()-s, \"seconds\")\n",
    "\n",
    "    return retriever"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Document splitted in 1797.8550481796265 seconds\n"
     ]
    }
   ],
   "source": [
    "retriever = documents_to_retriever(documents)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Above is time taken in child chunking, parent chunking and creation of vectorstore"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "colab": {
     "referenced_widgets": [
      "3fb2b3e0cf5e405ca1c36dfd5c51afc2"
     ]
    },
    "id": "LXVA5Mn8L7Ye",
    "outputId": "5b5a71e1-8cf7-4461-9a9c-53cd3c07c45c"
   },
   "outputs": [],
   "source": [
    "query = \"The color of the light emitted by LED headlamps shall be?\"  \n",
    "# sub_docs = vectorstore.similarity_search(query)\n",
    "# sub_docs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "colab": {
     "referenced_widgets": [
      "0fb8578b76e941efa07fea6333619e2a"
     ]
    },
    "id": "hBQk75vpL7Yf",
    "outputId": "a7ba4529-7513-4f64-989d-d3a60193cfd0"
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\VISHAL MAURYA\\Desktop\\Document Comparision\\pdr_venv\\Lib\\site-packages\\langchain_core\\_api\\deprecation.py:119: LangChainDeprecationWarning: The method `BaseRetriever.get_relevant_documents` was deprecated in langchain-core 0.1.46 and will be removed in 0.3.0. Use invoke instead.\n",
      "  warn_deprecated(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[Document(page_content='It shall remain activated while the failure is present. It may be cancelled \\ntemporarily, but shall be repeated whenever the device, which starts and stops \\nthe engine, is switched on and off. \\n5.2.9 \\nOther requirements \\nThe requirements of 4.5.b of this Standard shall not apply to dipped-beam \\nheadlamps. \\nUnilateral dipped-beam headlamps with a light source or LED module(s) \\nproducing the principal dipped-beam and having a total luminous flux which \\nexceeds 2,000 lm, shall be installed with a headlamp cleaner in compliance with \\nGB 21260.', metadata={'source': 'Chinese Documents/GB 4785-2019 Lighting installation -EN.pdf'}),\n",
       " Document(page_content='January / 2020 \\n \\nACEA Translation  \\n40 \\nFor Reference Purposes Only \\nremain switched on during the main-beam operation. \\n5.2.7.4 \\nOne additional light source or one or more LED module(s), located inside the \\ndipped-beam headlamps or in a lamp (except the main-beam headlamp) \\ngrouped or reciprocally incorporated with the respective dipped-beam \\nheadlamps, can be activated to produce bend lighting, provided that the \\nhorizontal radius of curvature of the trajectory of the center of gravity of the', metadata={'source': 'Chinese Documents/GB 4785-2019 Lighting installation -EN.pdf'}),\n",
       " Document(page_content='FR34 yellow boundary y=0.315+0.047x \\nFR41 spectral locus \\nx     y \\nFR1 0.690 0.310 \\nFR2 0.595 0.315 \\nFR3 0.569 0.341 \\nFR4 0.655 0.345 \\nTable 5 Light colors \\nDescription of lamp \\nLight color \\nMain-beam headlamp \\nWhite \\nDipped-beam headlamp \\nWhite \\nFront fog lamp \\nWhite or selective yellow \\nReversing lamp \\nWhite \\nDirection-indicator lamp \\nAmber \\nHazard warning signal \\nAmber \\nStop lamp \\nRed \\nEmergency stop signal \\nAmber or red \\nRear registration plate lamp \\nWhite \\nFront position lamp \\nWhite \\nRear position lamp \\nRed \\nRear fog lamp \\nRed \\nParking lamp', metadata={'source': 'Chinese Documents/GB 4785-2019 Lighting installation -EN.pdf'})]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "retrieved_docs = retriever.get_relevant_documents(query)\n",
    "retrieved_docs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "def query_to_context(query, retriever):\n",
    "    context = \"\"\n",
    "    retrieved_docs = retriever.get_relevant_documents(query)\n",
    "    for i in range(len(retrieved_docs)):\n",
    "      # print(\"----------------------------------------- parent\",i+1)\n",
    "        # print(retrieved_docs[i].page_content)\n",
    "        context += retrieved_docs[i].page_content\n",
    "    return context"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'headlamp shall be switched off. \\nManufacturer shall demonstrate conformity of product with above clauses to \\ninspection institution by using simulation or other method. If necessary, use \\nilluminance meter featuring cosine correction and measure horizontal \\nilluminance at height identical with vehicle sensor. It is allowed to prove \\nconformity with this clause by using method approved by inspection institution or \\ndocument or other method. \\n5.22.9.4 \\nFor all light ing units that are switched on simultaneously in main-beam light ingJanuary / 2020 \\n \\nACEA Translation  \\n119 \\nFor Reference Purposes Only \\n \\nAnnex H \\n(Normative) \\nAutomatic Switching of Dipped-beam Headlamps \\nConditions of automatic switching of dipped-beam headlamps are shown in Table H.1 \\nTable H1 \\nConditions of automatic switching of dipped-beam headlamps \\nAmbient light outside the vehicle Note \\nDipped-beam headlamps \\nResponse time \\nLess than 1,000lux \\nON \\nNot more than 2s \\n1,000lux to 7,000lux \\nAt manufacturer’s discretion \\nAt manufacturer’s discretion \\nMore than 7,000lux \\nOFF \\nMore than 5s, not more than 300sJanuary / 2020 \\n \\nACEA Translation  \\n40 \\nFor Reference Purposes Only \\nremain switched on during the main-beam operation. \\n5.2.7.4 \\nOne additional light source or one or more LED module(s), located inside the \\ndipped-beam headlamps or in a lamp (except the main-beam headlamp) \\ngrouped or reciprocally incorporated with the respective dipped-beam \\nheadlamps, can be activated to produce bend lighting, provided that the \\nhorizontal radius of curvature of the trajectory of the center of gravity of the'"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query1 = \"The LED module of headlamp shall be operated for how many hours before cooled down toambient temperature before starting the tests?\"\n",
    "context = query_to_context(query1, retriever)\n",
    "context"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'January / 2020 \\n \\nACEA Translation  \\n42 \\nFor Reference Purposes Only \\nThe above-mentioned “objective luminous flux” is subject to test voltage. \\nFor filament bulb allowing usage of multiple test voltages, the above-mentioned \\n“objective luminous flux” producing principal dipped-beam is subject to product \\ntest voltage used for type test of light sources. \\nOnly the dipped-beam lamps in compliance with GB 4599 or GB 21259 or GB \\n25991 may be used for realizing the bend lighting. \\nFor a left turn, if bend lighting is produced by a horizontal movement of thelamps complying with 5.18.7 below, and the emergency stop signal may be \\nflashing lamps. \\nb)The photometric characteristics of any lamp may vary: \\n-- \\nIn relation to the ambient light; \\n-- \\nAs a consequence of the activation of other lamps; or \\n-- \\nWhen the lamps is being used to provide another lighting function. \\nProvided that any variation in the photometric characteristics above is in \\ncompliance with the related technical provisions for the lamp concerned. \\nc)Under the precondition that photometric characteristics of direct ion-indicator'"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query2 = \"Tell me about Test of stability of photometric performance.\"\n",
    "context = query_to_context(query2, retriever)\n",
    "context"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\"the front fog beam in relation to the prevailing ambient conditions, provided that \\nthe limits for the vertical inclination specified in 5.3.6.1.2.b.1 are not exceeded. \\n5.3.6.2.4 \\nIn the case of a failure of the levelling device, the front fog beam shall not \\nassume a position in which the cut off is less inclined than it was at the time \\nwhen the failure of the device occurred. \\n5.3.6.2.5 \\nIf the vehicle structure can ensure that under all loading conditions specified in \\nAnnex A, can meet the requirements of 5.3.6.1.2.b.1, allowing not install levelingof 0.1% and one to one correspondence. \\n5.22.6.1.2 \\nFor horizontal part of cutoff line of basic dipped-beam, it is necessary to ensure \\nthat under all loading conditions specified in Annex A, its downward inclination \\nshall be within relevant limit scope in 5.2.6.1.2 of this regulation, including that \\ninitial aiming shall meet relevant requirements. \\nWhere dipped-beam is constituted by different beams of different lighting units, it \\nis necessary to inspect the above mentioned requirements of 5.22.6.1.2 respect \\nively for each beam “cutoff line” by making reference to 8.3.1 b) 8) in GB/Tively for each beam “cutoff line” by making reference to 8.3.1 b) 8) in GB/T \\n30036-2013. \\n5.22.6.2 \\nHeadlamp levelling device \\n5.22.6.2.1 \\nHeadlamp leveling device used for implementation of requirements of 5.22.6.1.2 \\nshall be automatic. \\n5.22.6.2.2 \\nIn case of failure of leveling device, the downward inclination position of \\ndipped-beam shall be no higher than the position where malfunction occurs. \\n5.22.6.3 \\nHorizontal orientation: Cutoff line (if any) elbow of each lighting unit projected on \\nmeasuring screen shall pass through vert ical line of reference axis of theJanuary / 2020 \\n \\nACEA Translation  \\n78 \\nFor Reference Purposes Only \\nrequirements of 5.1.5 and 5.2.5 on geometric visibility. Single light ing unit can \\nbe used to meet different requirements on geometric visibility. \\n5.22.6 \\nDirection:  \\nNote:The following requirements 5.22.6.1~5.22.6.4 apply to basic passing beam \\nunder neutral state. \\n5.22.6.1 \\nVertical orientation \\n5.22.6.1.1 \\nThe initial downward inclinat ion of the cut-off of the dipped-beam to be set in the \\nunladen state with one person in the driver's seat shall be specified within an\""
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query3 = \"What are environmental conditions for test for change in vertical position of the cut-off line under the influence ofheat?\"\n",
    "context = query_to_context(query3, retriever)\n",
    "context"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Note: lamps with illuminating surface of a lighting device include: Main-beam headlamp, \\ndipped-beam headlamp, front fog lamp, reversing lamp, cornering lamp and AFS. \\n3.11.2 \\nIlluminating surface of a light-signalling device other than a retro-reflector  \\nThe orthogonal projection of the lamp in a plane perpendicular to its axis of \\nreference and in contact with the exterior light emitting surface of the lamp, thisIt shall remain activated while the failure is present. It may be cancelled \\ntemporarily, but shall be repeated whenever the device, which starts and stops \\nthe engine, is switched on and off. \\n5.2.9 \\nOther requirements \\nThe requirements of 4.5.b of this Standard shall not apply to dipped-beam \\nheadlamps. \\nUnilateral dipped-beam headlamps with a light source or LED module(s) \\nproducing the principal dipped-beam and having a total luminous flux which \\nexceeds 2,000 lm, shall be installed with a headlamp cleaner in compliance with \\nGB 21260.January / 2020 \\n \\nACEA Translation  \\n40 \\nFor Reference Purposes Only \\nremain switched on during the main-beam operation. \\n5.2.7.4 \\nOne additional light source or one or more LED module(s), located inside the \\ndipped-beam headlamps or in a lamp (except the main-beam headlamp) \\ngrouped or reciprocally incorporated with the respective dipped-beam \\nheadlamps, can be activated to produce bend lighting, provided that the \\nhorizontal radius of curvature of the trajectory of the center of gravity of theShall be obtained through calculation of main-beam Emax value in type test \\nreport. \\n5.1.9.3 \\nFor the main-beam headlamps capable of automatic activation and deactivation \\n5.1.9.3.1 \\nThe requirements of automatic control function of the main-beam headlamps \\ndescribed in 5.1.7.1 above \\n5.1.9.3.1.1 \\nLight ray emitted by other vehicle that can be detected by sensor (as described \\nin 5.1.7.1), and the minimum scope boundary is determined by the following \\nangle. \\n- Horizontal angles: 15 to the left and 15 to the right. \\n- Vertical angles: See Table 6.'"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query4 = \"For headlamp with the outside lens in glass, a mixture to be applied to the headlamp lens shall consist of which elements\"\n",
    "context = query_to_context(query4, retriever)\n",
    "context"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Generation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain_community.llms import Ollama\n",
    "from langchain_community.embeddings import OllamaEmbeddings\n",
    "import time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "model = Ollama(model=\"llama2\")\n",
    "# embeddings = OllamaEmbeddings(model=\"llama2\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain.prompts import PromptTemplate\n",
    "\n",
    "def query_to_prompt(query):\n",
    "    context = query_to_context(query, retriever)\n",
    "    template = \"\"\"\n",
    "    Answer the question based on the context below. \n",
    "    Don't start the response from \"Based on the context provided, the answer to the question is:\" or something like that, just given the answer.\n",
    "    If you can't answer the question, reply \"I don't know\". \n",
    "    This is very important for my life, be serious and precise.\n",
    "    \n",
    "    Context: {context}\n",
    "    \n",
    "    Question: {question}\n",
    "    \"\"\"\n",
    "    prompttemplate = PromptTemplate.from_template(template)\n",
    "    prompt = prompttemplate.format(context = context, question = query)\n",
    "    return prompt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "# def query_to_prompt(query):\n",
    "#     context = query_to_context(query)\n",
    "#     prompt = f\"Answer the question based on the context below. Don't start the response from 'Based on the context provided, the answer to the question is:' or something like that, just given the answer.If you can't answer the question, reply 'I don't know'. \n",
    "#     This is very important for my life, be serious and precise. CONTEXT: {context} QUESTION: {query}\"\n",
    "#     return prompt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "queries = [query, query1, query2, query3, query4] # For Automotive Headlamps"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "for query in queries:\n",
    "    st = time.time()\n",
    "    print(\"QUERY:\", query)\n",
    "    prompt = query_to_prompt(query)\n",
    "    print(\"RESPONSE:\", model.invoke(prompt))\n",
    "    print(\"GENERATION TIME:\", (time.time() - st)/60, \"minutes\")\n",
    "    print(\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "new_queries = [\"Whats the difference between Grouped and Combined lamps?\", \"Can  dipped-beam headlamp and main-beam headlamp for front lighting system?\", \"what is color of End Outline marker lamp?\", \"Can yellow lamp used as front fog lamp?\", \"Can red color light placed in the front of the vechiile?\", \"Can white light can be placed at the back of the vechile?\", \"What are 1,1,a,1b,2a,2b,5,6 in direction indicator lamps?\", \"is cornering lamp mandatory?\", \"does reflective tape come under light and light signalling?\", \"standard weight of a person for testing?\",\"can dipped beam uses as a main beam?\", \"what are the light functions to be kept rear of the vechile?\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "QUERY: Whats the difference between Grouped and Combined lamps?\n",
      "RESPONSE: Grouped and combined lamps differ in their design and purpose. Here's the difference between them based on the given context:\n",
      "\n",
      "Grouped lamps:\n",
      "\n",
      "* Have separate apparent surfaces but share a common lamp body.\n",
      "* Are positioned in the same direction as the reference axis.\n",
      "* Do not overlap based on the areas bounded by the outline of their light emitting surfaces.\n",
      "\n",
      "Combined lamps:\n",
      "\n",
      "* Have separate apparent surfaces but share a common light source and lamp body.\n",
      "* Are positioned in the same direction as the reference axis.\n",
      "* Do not overlap based on the areas bounded by the outline of their light emitting surfaces, unlike grouped lamps.\n",
      "\n",
      "In summary, grouped lamps are designed to provide multiple light sources from different parts of the same lamp body, while combined lamps share a common light source and lamp body but have separate apparent surfaces.\n",
      "GENERATION TIME: 8.348908106486002 minutes\n",
      "\n",
      "QUERY: Can  dipped-beam headlamp and main-beam headlamp for front lighting system?\n",
      "RESPONSE: Yes, a dipped-beam headlamp can substitute the function of the front position lamps when certain conditions are met. According to the context provided, if any lamp of the dipped-beam headlamps fails, the front position lamps will automatically turn on. Additionally, the substituting lamp/function must meet certain requirements, including remaining activated while the failure is present and being repeated whenever the device that starts and stops the engine is switched on and off.\n",
      "GENERATION TIME: 7.282247678438822 minutes\n",
      "\n",
      "QUERY: what is color of End Outline marker lamp?\n",
      "RESPONSE: The color of an end-outline marker lamp is green.\n",
      "GENERATION TIME: 5.192182032267253 minutes\n",
      "\n",
      "QUERY: Can yellow lamp used as front fog lamp?\n",
      "RESPONSE: No, a yellow lamp cannot be used as a front fog lamp. According to the regulations, a front fog lamp must have a white or selective yellow light color.\n",
      "GENERATION TIME: 6.8734079281489056 minutes\n",
      "\n",
      "QUERY: Can red color light placed in the front of the vechiile?\n",
      "RESPONSE: No, according to the regulations stated in the context, red color light cannot be placed in the front of a vehicle. The regulations state that no red light shall be visible from the front (except for the interior lighting of the vehicle). Therefore, it is not permissible to place a red lamp in the front of a vehicle.\n",
      "GENERATION TIME: 5.849553573131561 minutes\n",
      "\n",
      "QUERY: Can white light can be placed at the back of the vechile?\n",
      "RESPONSE: No, according to the provided text, white light cannot be placed at the rear of the vehicle. The text states that \"there must be no direct visibility of a apparent surface of a white lamp if viewed by an observer moving within Zone 2 in a transverse plane situated 25m behind the vehicle.\" This means that white light is not visible to the rear, and therefore cannot be placed at the back of the vehicle.\n",
      "GENERATION TIME: 5.303685343265533 minutes\n",
      "\n",
      "QUERY: What are 1,1,a,1b,2a,2b,5,6 in direction indicator lamps?\n",
      "RESPONSE: The answer to the question is:\n",
      "\n",
      "1, 1a, 1b, 2a, 2b, 5, and 6 are categories of direction-indicator lamps.\n",
      "GENERATION TIME: 7.380967164039612 minutes\n",
      "\n",
      "QUERY: is cornering lamp mandatory?\n",
      "RESPONSE: Yes, according to the standard, the cornering lamp is optional for motor vehicles.\n",
      "GENERATION TIME: 3.686551793416341 minutes\n",
      "\n",
      "QUERY: does reflective tape come under light and light signalling?\n",
      "RESPONSE: Yes, reflective tape is considered a form of light signalling under the provisions of GB/T 4785-2019. The standard specifically includes reflective tape as a type of light-signaling device that is mounted on vehicles to improve visibility and safety during nighttime operation.\n",
      "GENERATION TIME: 7.665265822410584 minutes\n",
      "\n",
      "QUERY: standard weight of a person for testing?\n",
      "RESPONSE: The standard weight of a person for testing purposes is not explicitly mentioned in the provided context. However, it is mentioned that the height above the ground of the characteristic point is measured in millimeters, and the distance from the screen to the center of reference is also measured in millimeters. Therefore, I assume that the standard weight of a person for testing purposes would also be in units of milligrams or some other small unit of measurement.\n",
      "\n",
      "Therefore, the answer to your question is:\n",
      "\n",
      "Standard weight of a person for testing purposes: Not explicitly mentioned in the context provided, but likely to be in units of milligrams or similar small units of measurement.\n",
      "GENERATION TIME: 8.590403433640798 minutes\n",
      "\n",
      "QUERY: can dipped beam uses as a main beam?\n",
      "RESPONSE: No, according to the regulations provided, dipped beam cannot be used as a main beam. The regulations state that when switching from dipped beam to main beam, it is necessary to switch off all main-beam lighting units simultaneously. Additionally, the adaptive main-beam shall be in compliance with the stipulations of 5.22.9.3, which prohibits using dipped beam as a main beam.\n",
      "GENERATION TIME: 6.090609840552012 minutes\n",
      "\n",
      "QUERY: what are the light functions to be kept rear of the vechile?\n",
      "RESPONSE: The light functions to be kept rear of the vehicle are:\n",
      "\n",
      "* Light guide\n",
      "* Reflector\n",
      "GENERATION TIME: 5.1104709029197695 minutes\n",
      "\n"
     ]
    }
   ],
   "source": [
    "for query in new_queries:\n",
    "    st = time.time()\n",
    "    print(\"QUERY:\", query)\n",
    "    prompt = query_to_prompt(query)\n",
    "    print(\"RESPONSE:\", model.invoke(prompt))\n",
    "    print(\"GENERATION TIME:\", (time.time() - st)/60, \"minutes\")\n",
    "    print(\"\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# from transformers import GPT2LMHeadModel, GPT2Tokenizer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# model_name = \"EleutherAI/gpt-neo-2.7B\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# tokenizer = GPT2Tokenizer.from_pretrained(model_name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# model = GPT2LMHeadModel.from_pretrained(model_name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# input_text = \"Your input text here\"\n",
    "# input_ids = tokenizer.encode(input_text, return_tensors=\"pt\")\n",
    "\n",
    "# # Generate response\n",
    "# output = model.generate(input_ids, max_length=150, num_return_sequences=1, no_repeat_ngram_size=2)\n",
    "# generated_text = tokenizer.decode(output[0], skip_special_tokens=True)\n",
    "# print(generated_text)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Reranking"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "RU3auoHYL7Yh",
    "outputId": "aaecad31-a616-45b5-d100-f4773ca2f820"
   },
   "outputs": [],
   "source": [
    "pip install cohere"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "NPAwX35sL7Yh"
   },
   "outputs": [],
   "source": [
    "import cohere\n",
    "co = cohere.Client('w8CnnlzVol2aZEiirZNLUs0onAqXUUYBZCw2Oj7g')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "jukaV60YL7Yh"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query1=[]\n",
    "for i in range(len(retrieved_docs_1)):\n",
    "  retrieved_docs_query1.append(retrieved_docs_1[i].page_content)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "dkE78buML7Yo"
   },
   "outputs": [],
   "source": [
    "results = co.rerank(query=query_1, documents=retrieved_docs_query1, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "vCc8AxBGL7Yo",
    "outputId": "c1a6e081-8d4b-466d-fbf3-9755a50af531"
   },
   "outputs": [],
   "source": [
    "results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "-8vcZKJjL7Yp",
    "outputId": "986afcc0-ad24-4c11-d0d8-744dc518a528"
   },
   "outputs": [],
   "source": [
    "print(query_1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "CWIzNGsvL7Yp",
    "outputId": "3c424528-4829-48f4-823e-d573a272ed14"
   },
   "outputs": [],
   "source": [
    "results = co.rerank(query=query_1, documents=retrieved_docs_query1, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "    print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "    print(f\"Source Document: {retrieved_docs_1[r.index].metadata}\")\n",
    "    print(f\"Document: {retrieved_docs_query1[r.index]}\")\n",
    "    print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "    print(\"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "bXCvbwAAL7Yp"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query2=[]\n",
    "for i in range(len(retrieved_docs_2)):\n",
    "  retrieved_docs_query2.append(retrieved_docs_2[i].page_content)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "9F5k1xHjL7Yp",
    "outputId": "827f733b-6ae3-4a2d-d09a-77e98aa426f4"
   },
   "outputs": [],
   "source": [
    "print(query_2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "GBSuKGMKL7Yp",
    "outputId": "63ff8573-b494-486a-d93b-1b142811f71e"
   },
   "outputs": [],
   "source": [
    "results = co.rerank(query=query_2, documents=retrieved_docs_query2, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_2[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query2[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "PseqspuhL7Yq",
    "outputId": "7e5975ec-92b7-4f0c-94f8-b1318dc9d579"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query3=[]\n",
    "for i in range(len(retrieved_docs_3)):\n",
    "  retrieved_docs_query3.append(retrieved_docs_3[i].page_content)\n",
    "\n",
    "print(query_3,\"\\n\")\n",
    "results = co.rerank(query=query_3, documents=retrieved_docs_query3, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_3[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query3[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "Wj2agSdiL7Yq",
    "outputId": "4cec0692-0370-43fd-cca6-2003f0f0d16f"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query4=[]\n",
    "for i in range(len(retrieved_docs_4)):\n",
    "  retrieved_docs_query4.append(retrieved_docs_4[i].page_content)\n",
    "\n",
    "print(query_4,\"\\n\")\n",
    "results = co.rerank(query=query_4, documents=retrieved_docs_query4, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_4[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query4[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "SHHhMN5lL7Yq",
    "outputId": "dd60b6c8-c313-4d5d-ec45-7f147c155cef"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query5=[]\n",
    "for i in range(len(retrieved_docs_5)):\n",
    "  retrieved_docs_query5.append(retrieved_docs_5[i].page_content)\n",
    "\n",
    "print(query_5,\"\\n\")\n",
    "results = co.rerank(query=query_5, documents=retrieved_docs_query5, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_5[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query5[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "jJ1wjLRDL7Yr"
   },
   "source": [
    "# Parent Document Retriever\n",
    "Version 2 - Larger chunks"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "FJWaVW_GL7Yr"
   },
   "outputs": [],
   "source": [
    "from langchain.storage import InMemoryStore\n",
    "from langchain.retrievers import ParentDocumentRetriever\n",
    "\n",
    "child_splitter = RecursiveCharacterTextSplitter(chunk_size=700, chunk_overlap=50)\n",
    "parent_splitter = RecursiveCharacterTextSplitter(chunk_size=2000, chunk_overlap=200)\n",
    "vectorstore = Chroma(\n",
    "    collection_name=\"full_documents\", embedding_function=hf\n",
    ")\n",
    "store = InMemoryStore()\n",
    "retriever = ParentDocumentRetriever(\n",
    "    vectorstore=vectorstore,\n",
    "    docstore=store,\n",
    "    child_splitter=child_splitter,\n",
    "    parent_splitter=parent_splitter\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "mdXssW4lL7Yr"
   },
   "outputs": [],
   "source": [
    "# adding original documents before splitting or chunking as the retriever already does these\n",
    "retriever.add_documents(documents, ids=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "-wrGMOd5L7Yr",
    "outputId": "04230ec1-f8e9-4fd4-bf45-f9f749ea639f",
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "list(store.yield_keys())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "jLNgcjFMYFTo"
   },
   "source": [
    "## Query 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "CAck-DYnL7Ys"
   },
   "outputs": [],
   "source": [
    "query_1=\" What are some challenges associated with data collection?\"\n",
    "sub_docs_1 = vectorstore.similarity_search(query_1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "udWLdebML7Ys",
    "outputId": "642b5b85-d8b1-44d4-889a-907c6398d306"
   },
   "outputs": [],
   "source": [
    "print(sub_docs_1[0].page_content)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "jScYTbOhL7Yt",
    "outputId": "fcdde94d-6950-4764-b9f7-78553f8f836a"
   },
   "outputs": [],
   "source": [
    "sub_docs_1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "Q-yenRdOL7Yt"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_1 = retriever.get_relevant_documents(query_1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "5N3ujf_pL7Yt",
    "outputId": "21d32dc9-b234-4552-ab24-3cfb977388da"
   },
   "outputs": [],
   "source": [
    "len(retrieved_docs_1[0].page_content)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "ihfwSuJXL7Yt",
    "outputId": "3bef9c23-bc14-4250-cb0a-ffd1a5eee5ee"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "tKYFDtpAYKdd"
   },
   "source": [
    "## Query 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "mqLlRo3cL7Yu",
    "outputId": "c24f23eb-544d-43e7-df15-fae4269885b2"
   },
   "outputs": [],
   "source": [
    "#query_1=\" What are some challenges associated with data collection?\"\n",
    "query_2=\" What are the advantages of the Apriori algorithm?\"\n",
    "\n",
    "sub_docs_2 = vectorstore.similarity_search(query_2)\n",
    "retrieved_docs_2 = retriever.get_relevant_documents(query_2)\n",
    "retrieved_docs_2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "-mVfsk6zL7Yu",
    "outputId": "9dccf338-ab66-4915-cbea-b99736193aff"
   },
   "outputs": [],
   "source": [
    "sub_docs_2"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "_d7zKFnOYzAr"
   },
   "source": [
    "## Query 3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "GxGuL1RkL7Yu",
    "outputId": "8bcc6a13-dbff-43f8-fcf2-2638bd0187b2"
   },
   "outputs": [],
   "source": [
    "#query_1=\" What are some challenges associated with data collection?\"\n",
    "#query_2=\" What are the advantages of the Apriori algorithm?\"\n",
    "query_3=\" What distinguishes training data in supervised learning, and what is its purpose? \"\n",
    "\n",
    "sub_docs_3 = vectorstore.similarity_search(query_3)\n",
    "retrieved_docs_3 = retriever.get_relevant_documents(query_3)\n",
    "retrieved_docs_3"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "DBuRkJ1QY7D_"
   },
   "source": [
    "## Query 4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "TPHtVrgaL7Yu",
    "outputId": "fff0beec-03ab-4257-ed2f-222ddcb7b32a"
   },
   "outputs": [],
   "source": [
    "#query_1=\" What are some challenges associated with data collection?\"\n",
    "#query_2=\" What are the advantages of the Apriori algorithm?\"\n",
    "#query_3=\" What distinguishes training data in supervised learning, and what is its purpose? \"\n",
    "query_4=\" What is cross-validation?\"\n",
    "\n",
    "sub_docs_4 = vectorstore.similarity_search(query_4)\n",
    "retrieved_docs_4 = retriever.get_relevant_documents(query_4)\n",
    "retrieved_docs_4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "MuixB7BtL7Yv",
    "outputId": "9347d52d-5dac-439e-fb77-cb0272747717"
   },
   "outputs": [],
   "source": [
    "sub_docs_4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "-svmIHR_Y9bi"
   },
   "source": [
    "## Query 5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "wTasMU4WL7Yv",
    "outputId": "b0ce8312-1b50-4fad-d074-d01a826abc52"
   },
   "outputs": [],
   "source": [
    "#query_1=\" What are some challenges associated with data collection?\"\n",
    "#query_2=\" What are the advantages of the Apriori algorithm?\"\n",
    "#query_3=\" What distinguishes training data in supervised learning, and what is its purpose? \"\n",
    "#query_4=\" What is cross-validation?\"\n",
    "query_5=\"What is the process of building the decision tree classifier, and how is it trained on the dataset?\"\n",
    "\n",
    "sub_docs_5 = vectorstore.similarity_search(query_5)\n",
    "retrieved_docs_5 = retriever.get_relevant_documents(query_5)\n",
    "retrieved_docs_5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "3oqeSnpiL7Yw",
    "outputId": "93b56d11-4b7b-450f-e856-327aa4341776"
   },
   "outputs": [],
   "source": [
    "sub_docs_5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "XK5dZy6MjeI7"
   },
   "source": [
    "## Query 6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "ZjX_lVTqjdZV",
    "outputId": "5a01ae6f-dbc2-44cf-8f1e-ae674d18dd1b"
   },
   "outputs": [],
   "source": [
    "query_6=\"What is the challenge associated with supervised learning?\"\n",
    "\n",
    "sub_docs_6 = vectorstore.similarity_search(query_6)\n",
    "retrieved_docs_6 = retriever.get_relevant_documents(query_6)\n",
    "retrieved_docs_6"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "WrWR6zzGjjS2"
   },
   "source": [
    "## Query 7"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "pfLs--TtjjTA",
    "outputId": "8af7a48f-b1df-42ff-822b-3d13f73f06c0"
   },
   "outputs": [],
   "source": [
    "query_7=\"What considerations should businesses keep in mind when applying market basket analysis to understand customer behavior?\"\n",
    "\n",
    "sub_docs_7 = vectorstore.similarity_search(query_7)\n",
    "retrieved_docs_7 = retriever.get_relevant_documents(query_7)\n",
    "retrieved_docs_7"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "bfnVogJJjlwP"
   },
   "source": [
    "## Query 8"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "bfoMCTdZjlwX",
    "outputId": "5181c36d-f647-46c1-bf98-773483a00853"
   },
   "outputs": [],
   "source": [
    "query_8=\"How does the genie index contribute to decision tree construction, and why is it favored in practice, particularly in Python libraries?\"\n",
    "\n",
    "sub_docs_8 = vectorstore.similarity_search(query_8)\n",
    "retrieved_docs_8 = retriever.get_relevant_documents(query_8)\n",
    "retrieved_docs_8"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "DYYd0a-LjoJK"
   },
   "source": [
    "## Query 9"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "8wuU5NmMjoJa",
    "outputId": "2daca168-d7d6-4ed7-c63a-6af6f7e49b15"
   },
   "outputs": [],
   "source": [
    "query_9=\"What is the harmonic mean, and how does it enable the combination of precision and recall into a single metric?\"\n",
    "\n",
    "sub_docs_9 = vectorstore.similarity_search(query_9)\n",
    "retrieved_docs_9 = retriever.get_relevant_documents(query_9)\n",
    "retrieved_docs_9"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "X_1vrGm9jrJl"
   },
   "source": [
    "## Query 10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "j855JPegjrJu",
    "outputId": "c9ae53ea-8f4a-4d48-d04b-ca063c760dcc"
   },
   "outputs": [],
   "source": [
    "query_10=\"What are the implications of choosing a large or small learning rate?\"\n",
    "\n",
    "sub_docs_10 = vectorstore.similarity_search(query_10)\n",
    "retrieved_docs_10 = retriever.get_relevant_documents(query_10)\n",
    "retrieved_docs_10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "sF4HW1f1L7Yw",
    "outputId": "ea846203-a145-440a-e699-dcb219635464"
   },
   "outputs": [],
   "source": [
    "pip install cohere"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "Xand7DRVcgX9"
   },
   "source": [
    "# Co-here Re-ranking"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "fCgmNQTGL7Yx"
   },
   "outputs": [],
   "source": [
    "import cohere\n",
    "co = cohere.Client('w8CnnlzVol2aZEiirZNLUs0onAqXUUYBZCw2Oj7g')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "Ety4_Dgfktc_"
   },
   "source": [
    "## Query 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "Oj5eGFxVL7Yx"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query1=[]\n",
    "for i in range(len(retrieved_docs_1)):\n",
    "  retrieved_docs_query1.append(retrieved_docs_1[i].page_content)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "GFrqPbGFL7Yx"
   },
   "outputs": [],
   "source": [
    "results = co.rerank(query=query_1, documents=retrieved_docs_query1, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "laY6TA7ML7Yy",
    "outputId": "1e25bd01-bf8f-40a9-8543-3852b243ec61"
   },
   "outputs": [],
   "source": [
    "results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "n0g82kFKL7Yy",
    "outputId": "99f34086-d432-4197-d0c7-e7e696b54740"
   },
   "outputs": [],
   "source": [
    "print(query_1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "VEaO16UdL7Yz",
    "outputId": "55a9d004-7f24-4240-cc3b-2cf82e6dcf5c"
   },
   "outputs": [],
   "source": [
    "#results = co.rerank(query=query_1, documents=retrieved_docs_query1, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "print(query_1,\"\\n\")\n",
    "for idx, r in enumerate(results.results):\n",
    "    print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "    print(f\"Source Document: {retrieved_docs_1[r.index].metadata}\")\n",
    "    print(f\"Document: {retrieved_docs_query1[r.index]}\")\n",
    "    print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "    print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "NpvCAW1bk0Ay"
   },
   "source": [
    "## Query 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "oVI5i5C2L7Yz"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query2=[]\n",
    "for i in range(len(retrieved_docs_2)):\n",
    "  retrieved_docs_query2.append(retrieved_docs_2[i].page_content)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "9Ck7LvhLL7Y0",
    "outputId": "b8a5fda4-80d2-4e40-dae9-9f66bab9d76f"
   },
   "outputs": [],
   "source": [
    "print(query_2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "YO-yBxajL7Y0",
    "outputId": "b9c6dec9-c13f-4356-aca8-286933ca2144"
   },
   "outputs": [],
   "source": [
    "results = co.rerank(query=query_2, documents=retrieved_docs_query2, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "print(query_2,\"\\n\")\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_2[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query2[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "uNICmSrkk5gB"
   },
   "source": [
    "## Query 3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "muzHnafgL7Y0",
    "outputId": "1c333185-69ef-46b4-ad3f-3671fdeddb3f"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query3=[]\n",
    "for i in range(len(retrieved_docs_3)):\n",
    "  retrieved_docs_query3.append(retrieved_docs_3[i].page_content)\n",
    "\n",
    "print(query_3,\"\\n\")\n",
    "results = co.rerank(query=query_3, documents=retrieved_docs_query3, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_3[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query3[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "y6ngiuAKk-L1"
   },
   "source": [
    "## Query 4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "edbCuQieL7Y1",
    "outputId": "5fc55749-860f-4f5b-ed56-9196c474fb19"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query4=[]\n",
    "for i in range(len(retrieved_docs_4)):\n",
    "  retrieved_docs_query4.append(retrieved_docs_4[i].page_content)\n",
    "\n",
    "print(query_4,\"\\n\")\n",
    "results = co.rerank(query=query_4, documents=retrieved_docs_query4, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_4[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query4[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "hdxOk36plB3D"
   },
   "source": [
    "## Query 5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "7-sHgtpoL7Y2",
    "outputId": "28e67859-641a-4a22-af8b-885864d8cbe0"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query5=[]\n",
    "for i in range(len(retrieved_docs_5)):\n",
    "  retrieved_docs_query5.append(retrieved_docs_5[i].page_content)\n",
    "\n",
    "print(query_5,\"\\n\")\n",
    "results = co.rerank(query=query_5, documents=retrieved_docs_query5, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_5[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query5[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "nfXPH-yulIWU"
   },
   "source": [
    "## Query 6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "whnTycKtlIWb",
    "outputId": "06f52e10-c6f4-4246-b5bf-59aa8cc1ba0c"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query6=[]\n",
    "for i in range(len(retrieved_docs_6)):\n",
    "  retrieved_docs_query6.append(retrieved_docs_6[i].page_content)\n",
    "\n",
    "print(query_6,\"\\n\")\n",
    "results = co.rerank(query=query_6, documents=retrieved_docs_query6, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_6[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query6[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "In7tbtVOlQin"
   },
   "source": [
    "## Query 7"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "5qH14OaclQin",
    "outputId": "1e01083b-9fb0-4bb6-ee55-6d236044dee9"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query7=[]\n",
    "for i in range(len(retrieved_docs_7)):\n",
    "  retrieved_docs_query7.append(retrieved_docs_7[i].page_content)\n",
    "\n",
    "print(query_7,\"\\n\")\n",
    "results = co.rerank(query=query_7, documents=retrieved_docs_query7, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_7[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query7[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "BLxdsJe_lX5L"
   },
   "source": [
    "## Query 8"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "-3Jjw5rClX5L",
    "outputId": "6e94026c-9ce0-4404-ed64-16668cbaacf6"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query8=[]\n",
    "for i in range(len(retrieved_docs_8)):\n",
    "  retrieved_docs_query8.append(retrieved_docs_8[i].page_content)\n",
    "\n",
    "print(query_8,\"\\n\")\n",
    "results = co.rerank(query=query_8, documents=retrieved_docs_query8, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_8[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query8[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "hv1pxXaala3i"
   },
   "source": [
    "## Query 9"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "huhaQQ_Ula3y",
    "outputId": "694f8676-07e6-4bc0-f550-a57715f8d54a"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query9=[]\n",
    "for i in range(len(retrieved_docs_9)):\n",
    "  retrieved_docs_query9.append(retrieved_docs_9[i].page_content)\n",
    "\n",
    "print(query_9,\"\\n\")\n",
    "results = co.rerank(query=query_9, documents=retrieved_docs_query9, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_9[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query9[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "3a48V3jildv9"
   },
   "source": [
    "## Query 10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "gpPdKdQnldwO",
    "outputId": "3a471558-fa28-4932-c708-ba3cd443cda7"
   },
   "outputs": [],
   "source": [
    "retrieved_docs_query10=[]\n",
    "for i in range(len(retrieved_docs_10)):\n",
    "  retrieved_docs_query10.append(retrieved_docs_10[i].page_content)\n",
    "\n",
    "print(query_10,\"\\n\")\n",
    "results = co.rerank(query=query_10, documents=retrieved_docs_query10, top_n=3, model='rerank-english-v2.0') # Change top_n to change the number of results returned. If top_n is not passed, all results will be returned.\n",
    "for idx, r in enumerate(results.results):\n",
    "  print(f\"Document Rank: {idx + 1}, Document Index: {r.index}\")\n",
    "  print(f\"Source Document: {retrieved_docs_10[r.index].metadata}\")\n",
    "  print(f\"Document: {retrieved_docs_query10[r.index]}\")\n",
    "  print(f\"Relevance Score: {r.relevance_score:.2f}\")\n",
    "  print(\"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# list(store.yield_keys())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# from langchain_community.document_loaders import TextLoader\n",
    "# from langchain_community.document_loaders import DirectoryLoader\n",
    "# # Load and process the text files\n",
    "# loader = DirectoryLoader('data/', glob=\"./*.txt\", loader_cls=TextLoader)\n",
    "# documents = loader.load()  # text file to [document]\n",
    "\n",
    "# loader = PyPDFLoader(path)\n",
    "# documents = loader.load()\n",
    "# len(documents)  # List of documents for each page"
   ]
  }
 ],
 "metadata": {
  "colab": {
   "provenance": [],
   "toc_visible": true
  },
  "kaggle": {
   "accelerator": "nvidiaTeslaT4",
   "dataSources": [
    {
     "datasetId": 4711455,
     "sourceId": 8000798,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30674,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python (pdr_venv)",
   "language": "python",
   "name": "pdr_venv"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {},
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
